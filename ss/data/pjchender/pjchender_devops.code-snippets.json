{
  "hdevops [Deploy] All Contributors 筆記 pjchender.dev": {
    "prefix": "hdevops [Deploy] All Contributors 筆記 pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Deploy] All Contributors 筆記</h1></header><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"keywords-deploy-publish-release-ci-持續整合\">keywords: <code>deploy</code>, <code>publish</code>, <code>release</code>, <code>CI</code>, <code>持續整合</code><a href=\"#keywords-deploy-publish-release-ci-持續整合\" class=\"hash-link\" aria-label=\"keywords-deploy-publish-release-ci-持續整合的直接連結\" title=\"keywords-deploy-publish-release-ci-持續整合的直接連結\">​</a></h5><blockquote><p><a href=\"https://github.com/all-contributors/all-contributors-bot\" target=\"_blank\" rel=\"noopener noreferrer\">All Contributors</a> @ Github</p></blockquote><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># Comment on an issue or pull request with:</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">@all-contributors please add @jakebolam for infrastructure, tests and code</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Deploy] coveralls 筆記 pjchender.dev": {
    "prefix": "hdevops [Deploy] coveralls 筆記 pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Deploy] coveralls 筆記</h1></header><blockquote><ul><li><a href=\"https://www.coveralls.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Coveralls</a> @ official website ✨</li><li><a href=\"https://docs.travis-ci.com/user/coveralls/\" target=\"_blank\" rel=\"noopener noreferrer\">Coveralls</a> @ Travis CI &gt; Integrations and Notifications</li><li><a href=\"https://github.com/nickmerwin/node-coveralls\" target=\"_blank\" rel=\"noopener noreferrer\">node-coveralls</a> @ Github</li></ul></blockquote><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"steps\">Steps<a href=\"#steps\" class=\"hash-link\" aria-label=\"Steps的直接連結\" title=\"Steps的直接連結\">​</a></h2><ol><li><p>進到 coveralls 的官網</p></li><li><p>連結 Github</p></li><li><p>在 coveralls 中 add repository（轉到 <code>ON</code>）</p></li><li><p>點選 <code>details</code> 可以看到對應的 <code>repo_token</code></p></li><li><p>到 Travis CI 上對應 repository 的環境變數：</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">COVERALLS_REPO_TOKEN=&lt;repo-token&gt; # 從 coveralls 上取得</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">COVERALLS_SERVICE_NAME=travis-pro # 可不填</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">COVERALLS_GIT_BRANCH (the branch name) # 可不填</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div></li><li><p>在專案中安裝 <code>coveralls</code></p></li></ol><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">install</span><span class=\"token plain\"> coveralls --save-dev</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ol start=\"7\"><li>在專案的 <code>package.json</code> 中加入指令：</li></ol><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// package.json</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;scripts&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;coveralls&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;jest --coverage &amp;&amp; cat ./coverage/lcov.info | coveralls&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ol start=\"8\"><li>在專案的 <code>.travis.yml</code> 中加入下述設定（可參考此<a href=\"https://github.com/Ethan-Arrowood/harperdb-connect/blob/master/.travis.yml\" target=\"_blank\" rel=\"noopener noreferrer\">設定檔</a>）：</li></ol><div class=\"language-yml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># .travis.yml</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">language</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> node_js</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">node_js</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">12</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">include</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">stage</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Produce Coverage</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">node_js</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> node</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">script</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm run coveralls</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ol start=\"9\"><li><p>push 專案到 github 上觸發 Travis CI 執行</p></li><li><p>正確的話回到 coveralls 即可看到結果，並可把測試覆蓋率嵌入 <code>README</code> 中</p></li></ol><div class=\"language-markdown codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-markdown codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">[</span><span class=\"token url content\" style=\"color:rgb(221, 221, 221)\">![Coverage Status</span><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">](</span><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">https://coveralls.io/repos/github/&lt;user-name&gt;/&lt;repo-name&gt;/badge.svg?branch=master</span><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">)</span><span class=\"token plain\">](https://coveralls.io/github/</span><span class=\"token tag punctuation\" style=\"color:rgb(199, 146, 234)\">&lt;</span><span class=\"token tag\" style=\"color:rgb(255, 85, 114)\">user-name</span><span class=\"token tag punctuation\" style=\"color:rgb(199, 146, 234)\">&gt;</span><span class=\"token plain\">/</span><span class=\"token tag punctuation\" style=\"color:rgb(199, 146, 234)\">&lt;</span><span class=\"token tag\" style=\"color:rgb(255, 85, 114)\">repo-name</span><span class=\"token tag punctuation\" style=\"color:rgb(199, 146, 234)\">&gt;</span><span class=\"token plain\">?branch=master)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"錯誤處理\">錯誤處理<a href=\"#錯誤處理\" class=\"hash-link\" aria-label=\"錯誤處理的直接連結\" title=\"錯誤處理的直接連結\">​</a></h2><blockquote><p><a href=\"https://github.com/lemurheavy/coveralls-public/issues/632\" target=\"_blank\" rel=\"noopener noreferrer\">Coveralls returns 422 error: Couldn&#x27;t find a repository matching this job</a> @ Github Issues</p></blockquote></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [DevOps] GitHub Actions 筆記 pjchender.dev": {
    "prefix": "hdevops [DevOps] GitHub Actions 筆記 pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[DevOps] GitHub Actions 筆記</h1></header><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"keywords-deploy-publish-release-github-ci-cd\">keywords: <code>deploy</code>, <code>publish</code>, <code>release</code>, <code>github</code>, <code>CI</code>, <code>CD</code><a href=\"#keywords-deploy-publish-release-github-ci-cd\" class=\"hash-link\" aria-label=\"keywords-deploy-publish-release-github-ci-cd的直接連結\" title=\"keywords-deploy-publish-release-github-ci-cd的直接連結\">​</a></h5><div class=\"theme-admonition theme-admonition-info alert alert--info admonition_LlT9\"><div class=\"admonitionHeading_tbUL\"><span class=\"admonitionIcon_kALy\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg></span>官方文件</div><div class=\"admonitionContent_S0QG\"><p><a href=\"https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions\" target=\"_blank\" rel=\"noopener noreferrer\">Workflow syntax for GitHub Actions</a> @ GitHub</p></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"notes\">Notes<a href=\"#notes\" class=\"hash-link\" aria-label=\"Notes的直接連結\" title=\"Notes的直接連結\">​</a></h2><ul><li>建立或修改 Github Actions 的時候，該 PR 就已經會用最新的 workflows 執行。</li><li>workflow 是放在 <code>.github/workflows/</code> 資料夾內的 YAML 檔</li><li>一個 Workflow 裡可以定義多個 <code>jobs</code>，每個 jobs 會平行（parallel）執行</li><li>Job 裡面可以定義多個 <code>steps</code>，每個 steps 會依序（sequential）執行</li></ul><p><img loading=\"lazy\" alt=\"image-20230608212121617\" src=\"../../assets/images/image-20230608212121617-a5b97f16a24fca5d93d5482ed705e0c7.png\" width=\"2216\" height=\"936\" class=\"img_ev3q\"></p><p><img loading=\"lazy\" alt=\"image-20230608212323285\" src=\"../../assets/images/image-20230608212323285-84a2e3443c02e589e1c96ab864526360.png\" width=\"2300\" height=\"1242\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"github-actions\">GitHub Actions<a href=\"#github-actions\" class=\"hash-link\" aria-label=\"GitHub Actions的直接連結\" title=\"GitHub Actions的直接連結\">​</a></h2><blockquote><p><a href=\"https://help.github.com/en/actions/automating-your-workflow-with-github-actions/about-github-actions\" target=\"_blank\" rel=\"noopener noreferrer\">About GitHub Actions</a> @ Github</p></blockquote><p>Github Actions 讓你可以在存放程式碼的地方自動化程式碼部署的工作流程（workflow），同時整合協作中的 pull requests 和 issues。你可以撰寫「個別的任務（individual task）」，也就是 <strong>Actions</strong>，並將這些 Actions 統整在一起變成「<strong>工作流程（workflow）</strong>」，<strong>工作流程就是在 repository 上進行設定後，可以透過自動化的方式打包（build）、測試、發佈、部署專案程式碼</strong>。</p><p>透過 GitHub Actions 將可以針對 repository 執行 end-to-end 的 CI（continuous integration）和 CD（continuous deployment）。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"workflows工作流程\">Workflows（工作流程）<a href=\"#workflows工作流程\" class=\"hash-link\" aria-label=\"Workflows（工作流程）的直接連結\" title=\"Workflows（工作流程）的直接連結\">​</a></h2><blockquote><p><a href=\"https://help.github.com/en/actions/automating-your-workflow-with-github-actions/configuring-a-workflow\" target=\"_blank\" rel=\"noopener noreferrer\">Configuring a workflow</a> @ Github</p></blockquote><p>工作流程（Workflows）是針對 repository 進行設定，以此進行自動化的打包（build）、測試、發佈、部署專案程式碼。工作流程中至少需要包含一個工作項目（job），而工作項目中會包含一系列的步驟（step）來執行各別任務（tasks），這些個別的步驟（step）可以是執行指令或是 actions。</p><p>你需要透過 YAML 語法來設定工作流程，一個 repository 可以有一個以上的工作流程，你需要在專案根目錄中建立 <code>.github/workflows</code> 的資料夾，在這個資料夾中建立 <code>.yaml</code> 的檔案來儲存這些 workflows，一旦你成功觸發工作流程，將可以看到打包時的紀錄（build logs）、測試結果（tests results）、打包結果（artifacts）和執行工作流程時每一步驟的狀態（statuses）。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"觸發-workflow\">觸發 workflow<a href=\"#觸發-workflow\" class=\"hash-link\" aria-label=\"觸發 workflow的直接連結\" title=\"觸發 workflow的直接連結\">​</a></h3><p>你可以設定在什麼情況下要<a href=\"https://help.github.com/en/actions/automating-your-workflow-with-github-actions/configuring-a-workflow#triggering-a-workflow-with-events\" target=\"_blank\" rel=\"noopener noreferrer\">觸發工作流程（workflow）</a>：</p><ul><li>Github 上的事件，例如有人發送 commit、發佈 issue 或建立 pull request</li><li>定期的排程</li><li>外部事件</li></ul><p>你也可以設定<a href=\"https://help.github.com/en/actions/automating-your-workflow-with-github-actions/configuring-a-workflow#filtering-for-specific-branches-tags-and-paths\" target=\"_blank\" rel=\"noopener noreferrer\">只有當某些分支、tag、路徑被觸發時</a>才執行工作流程。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"矩陣建置build-matrix\">矩陣建置（build matrix）<a href=\"#矩陣建置build-matrix\" class=\"hash-link\" aria-label=\"矩陣建置（build matrix）的直接連結\" title=\"矩陣建置（build matrix）的直接連結\">​</a></h3><p>透過<a href=\"https://help.github.com/en/actions/automating-your-workflow-with-github-actions/configuring-a-workflow#configuring-a-build-matrix\" target=\"_blank\" rel=\"noopener noreferrer\">設定矩陣建置（build matrix）</a>可以在不同的作業系統、平台和語系環境下同時進行測試。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"checkout-action\">Checkout Action<a href=\"#checkout-action\" class=\"hash-link\" aria-label=\"Checkout Action的直接連結\" title=\"Checkout Action的直接連結\">​</a></h3><p><a href=\"https://help.github.com/en/actions/automating-your-workflow-with-github-actions/configuring-a-workflow#using-the-checkout-action\" target=\"_blank\" rel=\"noopener noreferrer\">checkout action</a> 是一個標準化的 action，如果你的工作流程中有下列 actions 的話，則需要先執行 checkout action：</p><ul><li>你的工作流程需要先複製出一份專案程式碼，例如針對專案進行打包、測試，或者使用 CI 時。</li><li>在你的工作流程中，至少有一個 action 是定義在同一個 repository 內（而非引用自外部公開的 repository），參考 <a href=\"https://help.github.com/en/actions/automating-your-workflow-with-github-actions/configuring-a-workflow#referencing-actions-in-your-workflow\" target=\"_blank\" rel=\"noopener noreferrer\">Referencing actions in your workflow</a>。</li></ul><p>要使用標準的 checkout action 只需要在步驟中加入：</p><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/checkout@v1</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><blockquote><p><a href=\"https://github.com/actions/checkout\" target=\"_blank\" rel=\"noopener noreferrer\">checkout</a> @ Github Actions</p></blockquote><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"workflow-設定檔範例\">workflow 設定檔範例<a href=\"#workflow-設定檔範例\" class=\"hash-link\" aria-label=\"workflow 設定檔範例的直接連結\" title=\"workflow 設定檔範例的直接連結\">​</a></h3><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"run-unit-tests-example\">Run Unit Tests example<a href=\"#run-unit-tests-example\" class=\"hash-link\" aria-label=\"Run Unit Tests example的直接連結\" title=\"Run Unit Tests example的直接連結\">​</a></h4><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># .github/workflows/continuous-integration-workflow.yml</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># The name of the workflow which you can see when the action runs</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Run unit tests</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># This workflow is triggered on pushes to the repository.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">on</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">push</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">branches</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\">main</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">pull_request</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">branches</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\">main</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># Jobs will run in parallel</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">run-unit-tests</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># This job runs on Linux</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> ubuntu</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">latest</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># Steps run synchronously (one after the other)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">steps</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># Retrieve the codebase on the ubuntu machine.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># if the codebase isn&#x27;t required, this step can be skipped.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/checkout@v3</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Setup Node</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/setup</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">node@v3</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">with</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token key atrule\">node-version</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">16</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token key atrule\">cache</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;npm&#x27;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">run</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm ci</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Run unit tests</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">run</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm test</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>Greet Example</p><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># .github/workflows/continuous-integration-workflow.yml</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Greet Everyone</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># This workflow is triggered on pushes to the repository.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">on</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\">push</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">build</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># Job name is Greeting</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Greeting</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># This job runs on Linux</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> ubuntu</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">latest</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">steps</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># This step uses GitHub&#x27;s hello-world-javascript-action: https://github.com/actions/hello-world-javascript-action</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Hello world</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/hello</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">world</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">javascript</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">action@v1</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">with</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token key atrule\">who-to-greet</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;Mona the Octocat&#x27;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">id</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> hello</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># This step prints an output (time) from the previous step&#x27;s action.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Echo the greeting&#x27;s time</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">run</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> echo &#x27;The time was $</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"> steps.hello.outputs.time </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\">.&#x27;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"設定環境變數\">設定環境變數<a href=\"#設定環境變數\" class=\"hash-link\" aria-label=\"設定環境變數的直接連結\" title=\"設定環境變數的直接連結\">​</a></h2><blockquote><ul><li><a href=\"https://docs.github.com/en/actions/reference/environments\" target=\"_blank\" rel=\"noopener noreferrer\">Environments</a> @ Github Docs</li><li><a href=\"https://docs.github.com/en/actions/reference/workflow-syntax-for-github-actions#jobsjob_idenvironment\" target=\"_blank\" rel=\"noopener noreferrer\">Workflow syntax</a> @ Github Docs</li></ul></blockquote><p>在 GitHub Action 的 workflow 中使用環境變數（environment variable）的方式可以參考：</p><ul><li>建立環境名稱（environment name）：在 Github Repository 的 Settings 頁籤可以找到 <code>Environments</code> 的選項，可以在這裡新增環境名稱</li><li>接著可以在此環境名稱中新增環境變數（environment variable）</li><li>最後，要記得<strong>在 workflow 的設定檔中指定使用的環境名稱（environment name）</strong>：</li></ul><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># .github/workflows/release.yml</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">release</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Release</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">environment</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> release </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 指定套用的「環境名稱」</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"cache\">Cache<a href=\"#cache\" class=\"hash-link\" aria-label=\"Cache的直接連結\" title=\"Cache的直接連結\">​</a></h2><div class=\"theme-admonition theme-admonition-info alert alert--info admonition_LlT9\"><div class=\"admonitionHeading_tbUL\"><span class=\"admonitionIcon_kALy\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg></span>官方文章</div><div class=\"admonitionContent_S0QG\"><p><a href=\"https://docs.github.com/en/actions/using-workflows/caching-dependencies-to-speed-up-workflows\" target=\"_blank\" rel=\"noopener noreferrer\">Caching dependencies to speed up workflows</a> @ GitHub</p></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"dependency-cache-和-artifacts-的差別\">Dependency cache 和 Artifacts 的差別<a href=\"#dependency-cache-和-artifacts-的差別\" class=\"hash-link\" aria-label=\"Dependency cache 和 Artifacts 的差別的直接連結\" title=\"Dependency cache 和 Artifacts 的差別的直接連結\">​</a></h3><ul><li>cache：在不同 jobs 或 workflows 執行時可以被重複使用的檔案，例如 npm 的 dependencies</li><li>artifacts：重複使用 jobs 或 workflows 執行後產生的檔案，例如 build 好的檔案</li></ul><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"cache-action-的使用\">Cache Action 的使用<a href=\"#cache-action-的使用\" class=\"hash-link\" aria-label=\"Cache Action 的使用的直接連結\" title=\"Cache Action 的使用的直接連結\">​</a></h3><ul><li>當 <code>key</code> 相同的時候，稱作 <code>cache hit</code>，GitHub Action 就會把 cache 放回定義好的 <code>path</code> 資料夾中</li><li>當 <code>key</code> 不相同時，稱作 <code>cache miss</code>，如果 job 成功執行，會自動建立新的 cache</li></ul><div class=\"language-yml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Caching with npm</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">on</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> push</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">build</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> ubuntu</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">latest</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">steps</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/checkout@v3</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Cache node modules</span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">id</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> cache</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">npm</span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/cache@v3</span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">env</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token key atrule\">cache-name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> cache</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">node</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">modules</span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">with</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># npm cache files are stored in `~/.npm` on Linux/macOS</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token key atrule\">path</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> ~/.npm</span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">#</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token key atrule\">key</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">$</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"> hashFiles(&#x27;package</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">lock.json&#x27;) </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">if</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> $</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"> steps.cache</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">npm.outputs.cache</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">hit </span><span class=\"token tag\" style=\"color:rgb(255, 85, 114)\">!=</span><span class=\"token plain\"> &#x27;true&#x27; </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> List the state of node modules</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">continue-on-error</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token boolean important\" style=\"color:rgb(255, 88, 116)\">true</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">run</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm list</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"直接使用-setup-node-actions\">直接使用 setup-node actions<a href=\"#直接使用-setup-node-actions\" class=\"hash-link\" aria-label=\"直接使用 setup-node actions的直接連結\" title=\"直接使用 setup-node actions的直接連結\">​</a></h3><p>實際上，使用 <code>actions/setup-node@v3</code> 就能做到類似的事。預設情況下，<code>actions/setup-node</code> 不會啟用 cache，可以透過定義 <code>cache</code> 來啟用。它底層一樣是使用 <code>actions/cache</code>：</p><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token key atrule\">steps</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/checkout@v3</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/setup</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">node@v3</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">with</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">node-version</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">16</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">cache</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;npm&#x27;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">run</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm ci</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">run</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm test</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>在 Actions 中即可看到被保存的 cache：</p><p><img loading=\"lazy\" alt=\"image-20230608221749359\" src=\"../../assets/images/image-20230608221749359-b507c52375c167cecb140a8205e5d0f5.png\" width=\"3500\" height=\"1192\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"artifacts\">Artifacts<a href=\"#artifacts\" class=\"hash-link\" aria-label=\"Artifacts的直接連結\" title=\"Artifacts的直接連結\">​</a></h2><p>執行完 Actions 後，如果希望產生的檔案可以下載或給其他 API 使用的話，可以使用 <code>actions/upload-artifact@v3</code> 這個 Actions：</p><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">coverage</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> ubuntu</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">latest</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">steps</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/checkout@v3</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> ./.github/actions/setup</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">node</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">run</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm test </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">coverage</span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Archive coverage results</span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/upload</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">artifact@v3</span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">with</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> coverage</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">report</span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token key atrule\">path</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> coverage</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>如此，在 Action Summary 的頁面，就可以看到一個可以被下載的檔案，這就是執行 test coverage 後產生的檔案：</p><p><img loading=\"lazy\" alt=\"image-20230616233218337\" src=\"../../assets/images/image-20230616233218337-18160dab1be22fa3791b70ae4bd901ec.png\" width=\"1924\" height=\"912\" class=\"img_ev3q\"></p><p>同樣的，你也可以在 <code>npm run build</code> 之後產生 artifacts 檔案（如果需要的話）。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"reusable-github-actions\">Reusable Github Actions<a href=\"#reusable-github-actions\" class=\"hash-link\" aria-label=\"Reusable Github Actions的直接連結\" title=\"Reusable Github Actions的直接連結\">​</a></h2><div class=\"theme-admonition theme-admonition-info alert alert--info admonition_LlT9\"><div class=\"admonitionHeading_tbUL\"><span class=\"admonitionIcon_kALy\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg></span>官方文件</div><div class=\"admonitionContent_S0QG\"><p><a href=\"https://docs.github.com/en/actions/creating-actions/creating-a-composite-action\" target=\"_blank\" rel=\"noopener noreferrer\">Creating a composite action</a> @ Github Actions</p></div></div><p>如果有些 Actions 會經常需要重複執行，可以考慮把它們包成一個 action：</p><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># .github/actions/setup-node/action.yml</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;Setup Node and Install Dependencies&#x27;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">description</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;Install dependencies&#x27;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">runs</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">using</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;composite&#x27;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">steps</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Setup Node</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/setup</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">node@v3</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">with</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">node-version</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">18</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">cache</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;npm&#x27;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">run</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm ci</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">shell</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> bash</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>接著可以在原本的 workflow 中直接使用這個自己定義的 action：</p><ul><li>記得要先使用 <code>actions/checkout</code> 才能使用自己定義的 action（因為這個 action，是在自己的 codebase 中）</li></ul><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Run Unit Tests</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># This workflow is triggered on pushes to the repository.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># on: [push]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">on</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">push</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">branches</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\">main</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">pull_request</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">branches</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\">main</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">build</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> ubuntu</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">latest</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">steps</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/checkout@v3</span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> ./.github/actions/setup</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">node</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">run</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm run build</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">test</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> ubuntu</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">latest</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">steps</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/checkout@v3</span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> ./.github/actions/setup</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">node</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">run</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm test</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">coverage</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> ubuntu</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">latest</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">steps</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/checkout@v3</span><br></span><span class=\"token-line theme-code-block-highlighted-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> ./.github/actions/setup</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">node</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">run</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm test </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">coverage</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Archive coverage results</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/upload</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">artifact@v2</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">with</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> coverage</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">report</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token key atrule\">path</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> coverage</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"建立自己的-actioncustom-action\">建立自己的 Action（Custom Action）<a href=\"#建立自己的-actioncustom-action\" class=\"hash-link\" aria-label=\"建立自己的 Action（Custom Action）的直接連結\" title=\"建立自己的 Action（Custom Action）的直接連結\">​</a></h2><div class=\"theme-admonition theme-admonition-info alert alert--info admonition_LlT9\"><div class=\"admonitionHeading_tbUL\"><span class=\"admonitionIcon_kALy\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg></span>官方文件</div><div class=\"admonitionContent_S0QG\"><p>除了照著<a href=\"https://docs.github.com/en/actions/creating-actions/creating-a-javascript-action\" target=\"_blank\" rel=\"noopener noreferrer\">官方文件</a>的說明外，官方有提供 <a href=\"https://github.com/actions/typescript-action\" target=\"_blank\" rel=\"noopener noreferrer\">typescript-action</a> 和 <a href=\"https://github.com/actions/javascript-action\" target=\"_blank\" rel=\"noopener noreferrer\">javascript-action</a> 這兩個 template repository。</p></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"打包\">打包<a href=\"#打包\" class=\"hash-link\" aria-label=\"打包的直接連結\" title=\"打包的直接連結\">​</a></h3><p>建立自己的 Action 時，比較需要留意的是在把 actions 推上 Github 時，需要把 node_modules 中的 package 也放上去，其中包含兩種方式：</p><ol><li><code>node_modules</code> 一起推上 GitHub</li><li>或者使用 <a href=\"https://github.com/vercel/ncc\" target=\"_blank\" rel=\"noopener noreferrer\">@vercel/ncc</a> 將專案打包後，要把 <code>dist</code> 一起推上 GitHub</li></ol><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"測試\">測試<a href=\"#測試\" class=\"hash-link\" aria-label=\"測試的直接連結\" title=\"測試的直接連結\">​</a></h3><ul><li>要測試自己寫的 Actions 時，記得一樣要建立 workflow，然後在 <code>use</code> 的地方引用這個 action</li><li>比較簡單的作法是參考 <a href=\"https://docs.github.com/en/actions/creating-actions/creating-a-javascript-action#example-using-a-private-action\" target=\"_blank\" rel=\"noopener noreferrer\">Example using a private action</a>，在自己的 workflow 中使用根目錄的 action 檔</li></ul><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Workflow Name</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">on</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\">push</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">hello_world_job</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> ubuntu</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">latest</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> A job to say hello</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">steps</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 如果要使用專案中的 action，記得要先 checkout</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Checkout</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/checkout@v3</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> My Custom Action</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> ./ </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 直接使用根目錄的 action.yml</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">with</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">     </span><span class=\"token key atrule\">GITHUB_TOKEN</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> $</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"> secrets.GITHUB_TOKEN </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">     </span><span class=\"token key atrule\">configuration_path</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> .github/some</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">config.json</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"參考資料\">參考資料<a href=\"#參考資料\" class=\"hash-link\" aria-label=\"參考資料的直接連結\" title=\"參考資料的直接連結\">​</a></h2><ul><li><a href=\"https://github.com/stevekinney/enterprise-ui-dev/blob/main/content/Getting Started with Github Actions.md\" target=\"_blank\" rel=\"noopener noreferrer\">Getting Started with Github Actions</a> @ FEM</li><li><a href=\"https://docs.github.com/en/actions/creating-actions/creating-a-javascript-action\" target=\"_blank\" rel=\"noopener noreferrer\">Creating a JavaScript action</a> @ GitHub</li></ul></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Heroku] Heroku 指令 CLI pjchender.dev": {
    "prefix": "hdevops [Heroku] Heroku 指令 CLI pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Heroku] Heroku 指令 CLI</h1></header><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"heroku-指令\">Heroku 指令<a href=\"#heroku-指令\" class=\"hash-link\" aria-label=\"Heroku 指令的直接連結\" title=\"Heroku 指令的直接連結\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"常用指令\">常用指令<a href=\"#常用指令\" class=\"hash-link\" aria-label=\"常用指令的直接連結\" title=\"常用指令的直接連結\">​</a></h3><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku create                           </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 建立一個 app（可以先切換到 app 的目錄下）</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">open</span><span class=\"token plain\">                             </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 打開所建立的 app</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku logs --tail                      </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 檢視 log 檔</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku run </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\">some_command</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\">               </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 在 heroku 上執行指令</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ps</span><span class=\"token plain\">                               </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 檢視目前有幾個 dyno 在運作</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">local</span><span class=\"token plain\">                            </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 在本機執行 app，並模擬在 heroku 上的狀況</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"插件安裝\">插件安裝<a href=\"#插件安裝\" class=\"hash-link\" aria-label=\"插件安裝的直接連結\" title=\"插件安裝的直接連結\">​</a></h3><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku addons                           </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 列出所有 app 安裝的 heroku addons</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku addons:create heroku-postgresql  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 新增 postgreSql 的 addons</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku addons:create heroku-postgresql:hobby-dev</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"將-app-發佈到-heroku\">將 app 發佈到 heroku<a href=\"#將-app-發佈到-heroku\" class=\"hash-link\" aria-label=\"將 app 發佈到 heroku的直接連結\" title=\"將 app 發佈到 heroku的直接連結\">​</a></h3><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku login                            </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 登入 heroku</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku git:remote -a simple-app-life    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 將 heroku 新增到 git remote 當中</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">git</span><span class=\"token plain\"> push heroku master                  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 利用 git 將 app 推上 heroku</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"設定環境變數\">設定環境變數<a href=\"#設定環境變數\" class=\"hash-link\" aria-label=\"設定環境變數的直接連結\" title=\"設定環境變數的直接連結\">​</a></h3><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ heroku config:set </span><span class=\"token assign-left variable\" style=\"color:rgb(191, 199, 213)\">KEY</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\">value              </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 設定 heroku 上的環境變數</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ heroku config                            </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 檢視 heroku 上的環境變數</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"其他\">其他<a href=\"#其他\" class=\"hash-link\" aria-label=\"其他的直接連結\" title=\"其他的直接連結\">​</a></h3><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ heroku apps:rename </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\">new-name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\">             </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 修改 app 的名稱</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安裝-heroku-cli\">安裝 Heroku cli<a href=\"#安裝-heroku-cli\" class=\"hash-link\" aria-label=\"安裝 Heroku cli的直接連結\" title=\"安裝 Heroku cli的直接連結\">​</a></h2><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ brew </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">install</span><span class=\"token plain\"> heroku/brew/heroku                    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 安裝 heroku CLI</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"node-相關\">Node 相關<a href=\"#node-相關\" class=\"hash-link\" aria-label=\"Node 相關的直接連結\" title=\"Node 相關的直接連結\">​</a></h2><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ heroku run </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">node</span><span class=\"token plain\"> -v -a APP_NAME          </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 檢視 Node 版本</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"參考\">參考<a href=\"#參考\" class=\"hash-link\" aria-label=\"參考的直接連結\" title=\"參考的直接連結\">​</a></h2><ul><li><a href=\"https://devcenter.heroku.com/articles/heroku-cli\" target=\"_blank\" rel=\"noopener noreferrer\">The Heroku CLI</a> @ Heroku</li></ul></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Heroku] Heroku 筆記 pjchender.dev": {
    "prefix": "hdevops [Heroku] Heroku 筆記 pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Heroku] Heroku 筆記</h1></header><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"定義-procfile-檔\">定義 Procfile 檔<a href=\"#定義-procfile-檔\" class=\"hash-link\" aria-label=\"定義 Procfile 檔的直接連結\" title=\"定義 Procfile 檔的直接連結\">​</a></h2><p>再執行 app 的時候，Heroku 會先去根目錄找 Procfile 檔案，如果不存在的話，預設會執行 <code>package.json</code> 中的 start script，因此我們最好要定義 Procfile 檔案。</p><p>將 Procfile 檔案放在根目錄，告訴 heroku 要如何啟動你的 app：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># Procfile</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">web: </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">node</span><span class=\"token plain\"> index.js                            </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># web 是關鍵字</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"設定環境變數\">設定環境變數<a href=\"#設定環境變數\" class=\"hash-link\" aria-label=\"設定環境變數的直接連結\" title=\"設定環境變數的直接連結\">​</a></h2><p>我們可以將環境變數定義在 <code>.env</code> 這個檔案中， 當執行 <code>heroku local</code> 的時候，heroku 會自動去抓取這個環境變數</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># .env</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">process.env.TIMES</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"設定-packagejson\">設定 package.json<a href=\"#設定-packagejson\" class=\"hash-link\" aria-label=\"設定 package.json的直接連結\" title=\"設定 package.json的直接連結\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"設定-node-版本engines\">設定 node 版本：engines<a href=\"#設定-node-版本engines\" class=\"hash-link\" aria-label=\"設定 node 版本：engines的直接連結\" title=\"設定 node 版本：engines的直接連結\">​</a></h3><p>在 package.json 這個檔案中定義 <code>engines</code> ，來讓 heroku 知道要 run 哪個 node 版本：</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// package.json</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token string-property property\">&quot;engines&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token string-property property\">&quot;node&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;4.1.1&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token string-property property\">&quot;npm&quot;</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;5.0.2&quot;</span><span class=\"token plain\">            </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 也可以定義 npm 的版本，但一般來說不用設定</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"設定要執行的指令scripts\">設定要執行的指令：scripts<a href=\"#設定要執行的指令scripts\" class=\"hash-link\" aria-label=\"設定要執行的指令：scripts的直接連結\" title=\"設定要執行的指令：scripts的直接連結\">​</a></h3><p>heroku 提供一些 hook 可以在特定的時候執行特定的 scripts：</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// package.json</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token string-property property\">&quot;scripts&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token string-property property\">&quot;start&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;node index.js&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token string-property property\">&quot;test&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;mocha&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token string-property property\">&quot;preinstall&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token string-property property\">&quot;postinstall&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;bower install &amp;&amp; grunt build&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token string-property property\">&quot;heroku-prebuild&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token string-property property\">&quot;heroku-postbuild&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"設定-heroku-上的變數\">設定 heroku 上的變數<a href=\"#設定-heroku-上的變數\" class=\"hash-link\" aria-label=\"設定 heroku 上的變數的直接連結\" title=\"設定 heroku 上的變數的直接連結\">​</a></h2><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku config:set </span><span class=\"token assign-left variable\" style=\"color:rgb(191, 199, 213)\">MY_CUSTOM_VALUE</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\">foobar</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># Change Default Setting</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku config:set </span><span class=\"token assign-left variable\" style=\"color:rgb(191, 199, 213)\">NPM_CONFIG_PRODUCTION</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\">false</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku config:set </span><span class=\"token assign-left variable\" style=\"color:rgb(191, 199, 213)\">YARN_PRODUCTION</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\">false</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku config:set </span><span class=\"token assign-left variable\" style=\"color:rgb(191, 199, 213)\">NODE_MODULES_CACHE</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\">false</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">heroku config:set </span><span class=\"token assign-left variable\" style=\"color:rgb(191, 199, 213)\">NODE_ENV</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\">staging                </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># default is &quot;production&quot;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"參考資料\">參考資料<a href=\"#參考資料\" class=\"hash-link\" aria-label=\"參考資料的直接連結\" title=\"參考資料的直接連結\">​</a></h2><ul><li><a href=\"https://devcenter.heroku.com/categories/nodejs-support\" target=\"_blank\" rel=\"noopener noreferrer\">NodeJS Support</a> @ Heroku</li><li><a href=\"https://devcenter.heroku.com/articles/how-heroku-works\" target=\"_blank\" rel=\"noopener noreferrer\">How Heroku Works</a> @ Heroku</li></ul></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Heroku] Heroku PostgreSQL 帳號密碼的位置 pjchender.dev": {
    "prefix": "hdevops [Heroku] Heroku PostgreSQL 帳號密碼的位置 pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Heroku] Heroku PostgreSQL 帳號密碼的位置</h1></header><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"overview--installed-add-ons--heroku-postgres\">Overview &gt; Installed add-ons &gt; Heroku Postgres<a href=\"#overview--installed-add-ons--heroku-postgres\" class=\"hash-link\" aria-label=\"Overview &gt; Installed add-ons &gt; Heroku Postgres的直接連結\" title=\"Overview &gt; Installed add-ons &gt; Heroku Postgres的直接連結\">​</a></h4><p><img loading=\"lazy\" src=\"../../../3.bp.blogspot.com/-gSarp3ny6kc/WW1rHnjgO8I/AAAAAAAA0Yc/F2OwTHb93VgSw8kh2-Wrd0Qo9IGjDX0_gCLcBGAs/s1600/1.png\" alt=\"img\" class=\"img_ev3q\"></p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"administration--view-credentials\">Administration &gt; View Credentials<a href=\"#administration--view-credentials\" class=\"hash-link\" aria-label=\"Administration &gt; View Credentials的直接連結\" title=\"Administration &gt; View Credentials的直接連結\">​</a></h4><p><img loading=\"lazy\" src=\"../../../3.bp.blogspot.com/-cxQBhzPv4yg/WW10BS4Ov2I/AAAAAAAA0Yw/1L-79Hfvz-ozQQ6covvg8esD8ZcMLt2-wCLcBGAs/s1600/2.png\" alt=\"img\" class=\"img_ev3q\"></p></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Note] JMeter 筆記 pjchender.dev": {
    "prefix": "hdevops [Note] JMeter 筆記 pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Note] JMeter 筆記</h1></header><blockquote><p><a href=\"https://jmeter.apache.org/usermanual/get-started.html\" target=\"_blank\" rel=\"noopener noreferrer\">user manual</a> @ jmeter</p></blockquote><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"使用-function\">使用 function<a href=\"#使用-function\" class=\"hash-link\" aria-label=\"使用 function的直接連結\" title=\"使用 function的直接連結\">​</a></h2><blockquote><p><a href=\"https://jmeter.apache.org/usermanual/functions.html\" target=\"_blank\" rel=\"noopener noreferrer\">Functions and Variables</a> @ jmeter</p></blockquote><p>在 request 中可以透過 <code>${}</code> 來帶入 JMeter 中提供的 <a href=\"https://jmeter.apache.org/usermanual/functions.html\" target=\"_blank\" rel=\"noopener noreferrer\">function</a> 或帶入自訂的變數。例如使用內建的 <code>__counter()</code> 函式：</p><div class=\"language-http codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-http codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># request</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">http://localhost:8080/ping?id=${__counter(false)}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><img loading=\"lazy\" src=\"../../../i.imgur.com/Bphopuk.png\" alt=\"Screen Shot 2020-11-12 at 2.22.31 PM\" class=\"img_ev3q\"></p></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（0）：專案與套件建置篇 pjchender.dev": {
    "prefix": "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（0）：專案與套件建置篇 pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Guide] 發佈 npm 套件 - 從手動到自動（0）：專案與套件建置篇</h1></header><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"keywords-deploy-publish-release-cli-npm\">keywords: <code>deploy</code>, <code>publish</code>, <code>release</code>, <code>CLI</code>, <code>npm</code><a href=\"#keywords-deploy-publish-release-cli-npm\" class=\"hash-link\" aria-label=\"keywords-deploy-publish-release-cli-npm的直接連結\" title=\"keywords-deploy-publish-release-cli-npm的直接連結\">​</a></h5><p><img loading=\"lazy\" src=\"../../../i.imgur.com/OfN4knZ.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>對於 JavaScript 的開發者來說要發布 JavaScript 套件到 <a href=\"https://www.npmjs.com/\" target=\"_blank\" rel=\"noopener noreferrer\">npm</a> 上面，只要對於 npm 的專案架構本身已經有基本的理解，並不是太困難的事。在這一系列的文章中，會說明如何從專案開發到發佈 npm 套件的這個流程，從手動透過 npm 的指令發佈到自動化持續整合（Continuous Integration, CI）的過程做一個整理。</p><p>這裡，就讓我們先從手動開始。在這篇文章中會談到：</p><ul><li>建立隸屬於某 scope 底下的 npm 套件</li><li>撰寫一個範例套件</li><li>透過 rollup 打包範例套件</li><li>透過 Jest 測試範例套件</li></ul><p><strong>這篇文章主要是建立一個範例的 npm 套件，以供後續說明發佈使用，並且說明套件中通常會包含打包和測試的流程，若想要直接看最後套件完整的程式碼，可以看此 Github 上的 <a href=\"https://github.com/pjchender/function-benchmarker/commit/2c29917f740f6c5e9d3bf09d6764004fc3eaac11\" target=\"_blank\" rel=\"noopener noreferrer\">Commit</a>。</strong></p><blockquote><p>⚠️ 撰寫文章時使用的 npm 版本為 6.13.7。</p></blockquote><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"註冊-npm-帳號\">註冊 npm 帳號<a href=\"#註冊-npm-帳號\" class=\"hash-link\" aria-label=\"註冊 npm 帳號的直接連結\" title=\"註冊 npm 帳號的直接連結\">​</a></h2><p>首先要請你到 <a href=\"https://www.npmjs.com/\" target=\"_blank\" rel=\"noopener noreferrer\">npm</a> 的官網上註冊自己的帳號。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"建立-npm-scoped-專案\">建立 npm (scoped) 專案<a href=\"#建立-npm-scoped-專案\" class=\"hash-link\" aria-label=\"建立 npm (scoped) 專案的直接連結\" title=\"建立 npm (scoped) 專案的直接連結\">​</a></h2><p>一般的情況下，會習慣直接使用 <code>npm init</code> 這樣的指令來啟動 npm 的專案，但如果你是要發佈到 <a href=\"https://www.npmjs.com/\" target=\"_blank\" rel=\"noopener noreferrer\">npm</a> 上的話，就需要留意<strong>專案的名稱在 npm 上是不能夠重複的</strong>，為了避免專案重複的問題，在 npm v2 以後開始支援 <a href=\"https://docs.npmjs.com/about-scopes\" target=\"_blank\" rel=\"noopener noreferrer\"><strong>scopes</strong></a> 的用法，也就是讓專案在名稱上就可以看出是隸屬於某個使用者或某個組織底下，特色是專案名稱會用 <code>@</code> 開頭，如此避免專案名稱經常重複的問題。</p><p>舉例來說，JavaScrip 中經常用來支援語法相容性的 Babel 工具，現在就會隸屬於 <code>@babel</code> 下：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/2UqCWiZ.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>在建立專案時，你也可以考慮是否要讓它隸屬於個人或組織底下（scope）。在這裡因為只是示範用的專案，因此我就把這個專案直接隸屬於個人帳號底下，如此避免和他人的名稱相碰。</p><p>要建立 scope 的專案，只需在該專案資料夾中，初始化專案時加上 <code>--scope=@&lt;username&gt;</code> 的語法。例如：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">mkdir</span><span class=\"token plain\"> function-benchmarker     </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 建立一個名為 function-benchmarker 的專案資料夾</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">cd</span><span class=\"token plain\"> function-benchmarker        </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 進入該資料夾中</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> init --scope</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\">@pjchender    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 建立隸屬於個人帳號底下的 npm 套件</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>執行後 npm cli 會問你一些專案設定的問題，這裡我們先直接使用預設值就好，所以就一路 enter 到底即可。如果想要直接全部採用預設值，不要一一按下 enter 的話，可以直接在 <code>npm init</code> 的最後加上 <code>-y</code> 即可，像是這樣：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> init --scope</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\">@pjchender -y</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>如此就初始化好一個 npm 的專案：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/7fHzKns.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><blockquote><p>⚠️ 注意：scoped 的套件預設會是私人的（private），後續會再說明如何<a href=\"https://docs.npmjs.com/creating-and-publishing-scoped-public-packages\" target=\"_blank\" rel=\"noopener noreferrer\">透過 npm 指令</a>將其設為公開的套件。</p></blockquote><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"撰寫套件\">撰寫套件<a href=\"#撰寫套件\" class=\"hash-link\" aria-label=\"撰寫套件的直接連結\" title=\"撰寫套件的直接連結\">​</a></h2><p>這裡主要是用來示範套件的發佈，就來寫一個簡單可以用來檢測函式效能方法。在根目錄新增一個 <code>src</code> 目錄，並在裡面新增一支 <code>index.js</code>：</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// ./src/index.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> </span><span class=\"token function-variable function\" style=\"color:rgb(130, 170, 255)\">benchmarker</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token parameter\">testFunction</span><span class=\"token parameter punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token parameter\"> times </span><span class=\"token parameter operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token parameter\"> </span><span class=\"token parameter number\" style=\"color:rgb(247, 140, 108)\">1000000</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:rgb(137, 221, 255)\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"font-style:italic\">if</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token keyword\" style=\"font-style:italic\">typeof</span><span class=\"token plain\"> testFunction </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">!==</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;function&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token keyword control-flow\" style=\"font-style:italic\">throw</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"font-style:italic\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:rgb(255, 203, 107)\">Error</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;Did not provide a valid function for test.&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> startTime </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"font-style:italic\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:rgb(255, 203, 107)\">Date</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">getTime</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"font-style:italic\">let</span><span class=\"token plain\"> i </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">0</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"font-style:italic\">while</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token plain\">i </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\"> times</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    i</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">++</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">testFunction</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> endTime </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"font-style:italic\">new</span><span class=\"token plain\"> </span><span class=\"token class-name\" style=\"color:rgb(255, 203, 107)\">Date</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">getTime</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token keyword control-flow\" style=\"font-style:italic\">return</span><span class=\"token plain\"> endTime </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">-</span><span class=\"token plain\"> startTime</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 匯出函式</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">module</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token property-access\">exports</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> benchmarker</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>這裡的 <code>benchmarker</code> 方法，主要是把傳入的函式（<code>testFunction</code>）預設執行一百萬次（<code>times</code>）後，最後回傳所花的時間（ms）。</p><p>這裡因為是要開放給其他開發者可以使用的套件，所以最後會把 <code>benchmarker</code> 這個方法透過 CommonJS 的語法匯出（<code>module.exports</code>）。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"打包套件可略過\">打包套件（可略過）<a href=\"#打包套件可略過\" class=\"hash-link\" aria-label=\"打包套件（可略過）的直接連結\" title=\"打包套件（可略過）的直接連結\">​</a></h2><blockquote><p>💡 提醒：多數套件都會經過打包的動作，以縮小檔案體積、增加語法相容性等等，但如何打包並不是這篇文章的重點，因此<strong>你只需要知道有打包這個動作，並且打包後的檔案會被放到 dist 資料夾中</strong> 。</p></blockquote><p>npm 套件再發布前通常會經過「打包（bundle）」的動作，除了縮小檔案體積外，也可以讓套件同時支援在 CommonJS 或 ESModules 下使用，或者透過 Babel 等工具讓套件支援較舊的 JS 語法。打包的工具有許多，像是最常聽到的 <a href=\"https://webpack.js.org/\" target=\"_blank\" rel=\"noopener noreferrer\">webpack</a>、<a href=\"https://rollupjs.org/guide/en/\" target=\"_blank\" rel=\"noopener noreferrer\">rollupjs</a>、<a href=\"https://parceljs.org/\" target=\"_blank\" rel=\"noopener noreferrer\">Parcel</a>、或過去常使用的 <a href=\"https://gulpjs.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Gulp</a> 等等，你可以選擇自己習慣的。</p><p><strong>打包套件的過程不是這系列文章的重點，所以不會詳細說明設定檔中各欄位的意思，你只需要知道打包後會把原本放在 <code>src</code> 資料夾中原始碼，進行打包的動作後放到 <code>dist</code> 資料夾中。</strong></p><p>這裡我們選擇使用 <a href=\"https://rollupjs.org/guide/en/\" target=\"_blank\" rel=\"noopener noreferrer\">rollupjs</a> 進行打包，首先先安裝 rollup 和相關 plugin 到專案中：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">install</span><span class=\"token plain\"> rollup rollup-plugin-terser -D</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>接著在專案根目錄新增一支名為 <code>rollup.config.js</code> 的設定檔：</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// rollup.config.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"font-style:italic\">import</span><span class=\"token plain\"> </span><span class=\"token imports punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token imports\"> terser </span><span class=\"token imports punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"font-style:italic\">from</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;rollup-plugin-terser&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token keyword module\" style=\"font-style:italic\">export</span><span class=\"token plain\"> </span><span class=\"token keyword module\" style=\"font-style:italic\">default</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token literal-property property\">input</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;src/index.js&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token literal-property property\">output</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token literal-property property\">file</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;dist/index.min.js&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token literal-property property\">format</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;cjs&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token literal-property property\">sourcemap</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:rgb(255, 88, 116)\">true</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token literal-property property\">plugins</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">terser</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>這個設定檔簡單來說，就是把 <code>src/index.js</code> 的檔案打包後匯出到 <code>dist/index.min.js</code>，而 <code>terser</code> 這個外掛是用來壓縮（minify）打包後的檔案。</p><p>回到 <code>package.json</code> 中：</p><ul><li>把 <code>main</code> 欄位改成 <code>dist/index.js</code> ，這是他人在使用我們套件時的載入點</li><li>在 <code>scripts</code> 欄位中加入指令來執行 rollup</li></ul><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// package.json</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;main&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;dist/index.min.js&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;scripts&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;dev&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;rollup -c -w&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;build&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;rm -rf dist/ &amp;&amp; rollup -c&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;test&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;echo \\&quot;Error: no test specified\\&quot; &amp;&amp; exit 1&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>現在當我們執行 <code>npm run build</code> 時，<code>dist</code> 資料夾中就會產生打包並壓縮好的套件：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/FW280l1.gif\" alt=\"Imgur\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"測試撰寫的套件可略過\">測試撰寫的套件（可略過）<a href=\"#測試撰寫的套件可略過\" class=\"hash-link\" aria-label=\"測試撰寫的套件（可略過）的直接連結\" title=\"測試撰寫的套件（可略過）的直接連結\">​</a></h2><blockquote><p>💡 提醒：多數套件都會經過測試（test）的動作，以確認每次程式碼修改後並不會破壞原有的功能，但如何測試並不是這篇文章的重點，因此<strong>你只需要知道有測試這個動作，測試完成後可以得到測試覆蓋率</strong> 。</p></blockquote><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"以肉眼檢查程式\">以肉眼檢查程式<a href=\"#以肉眼檢查程式\" class=\"hash-link\" aria-label=\"以肉眼檢查程式的直接連結\" title=\"以肉眼檢查程式的直接連結\">​</a></h3><p>在還沒有安裝其他專門用來執行套件的工具前，我們先來手動執行看看套件運作是否正常。首先在 <code>src</code> 資料夾中建立一支名為 <code>index.test.js</code> 的檔案，這裡我們就寫一個名為 <code>jsonStringify</code> 的函式，看看當這個函式跑一百萬次需要多少時間：</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// ./src/index.test.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 匯入剛剛寫的套件</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> benchmarker </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">require</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;./index&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 定義一個想要檢驗花費時間的函式</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"font-style:italic\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">jsonStringify</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token known-class-name class-name\" style=\"color:rgb(255, 203, 107)\">JSON</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">stringify</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token literal-property property\">foo</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;bar&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 執行 benchMarker 這個方法，並把想檢驗的函式放進去</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> costTime </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">benchmarker</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token plain\">jsonStringify</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token console class-name\" style=\"color:rgb(255, 203, 107)\">console</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">log</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;costTime&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> costTime</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>撰寫好後，可以透過 <code>node</code> 指令執行該程式，看看是否能正常運作：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/aKvF4bf.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>從上圖中可以看到，執行 <code>jsonStringify</code> 一百萬次會需要耗費 264ms 的時間。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"使用-jest-讓程式檢查程式\">使用 Jest 讓程式檢查程式<a href=\"#使用-jest-讓程式檢查程式\" class=\"hash-link\" aria-label=\"使用 Jest 讓程式檢查程式的直接連結\" title=\"使用 Jest 讓程式檢查程式的直接連結\">​</a></h3><p>上面這裡是用「肉眼」來進行測試，但實際上的測試很少會用「肉眼」，而是會用程式來檢查程式，這裡我們使用 <a href=\"https://jestjs.io/en/\" target=\"_blank\" rel=\"noopener noreferrer\">Jest</a> 進行比較正式測試。</p><p>首先安裝 Jest：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">install</span><span class=\"token plain\"> jest -D</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>預設情況下，<code>__tests__</code> 資料夾內的 <code>.js</code>, <code>.jsx</code>, <code>.ts</code>, <code>.tsx</code>以 <code>.test</code> 或 <code>.spec</code> 結尾的檔案，例如，因此這裡的 <code>index.test.js</code> 也會被 Jest 解析到。</p><p>修改一下 <code>index.test.js</code> 的內容，變成不用使用肉眼檢查，而是讓程式碼自己檢查執行結果：</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// ./src/index.test.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> benchmarker </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">require</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;./index&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">describe</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;test function-benchmarker&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:rgb(137, 221, 255)\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 檢驗函式執行了 100 萬次（預設），而且回傳的 costTime 是數值格式</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">it</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;run default times (1000000)&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:rgb(137, 221, 255)\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> mockFn </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> jest</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">fn</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> costTime </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">benchmarker</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token plain\">mockFn</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">expect</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token plain\">mockFn</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">toHaveBeenCalledTimes</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">1000000</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">expect</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token plain\">costTime</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">toEqual</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token plain\">expect</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">any</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token known-class-name class-name\" style=\"color:rgb(255, 203, 107)\">Number</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 檢驗函式執行了 1000 次，而且回傳的 costTime 是數值格式</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">it</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;run with 1000 times&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:rgb(137, 221, 255)\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> mockFn </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> jest</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">fn</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> costTime </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">benchmarker</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token plain\">mockFn</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">1000</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 設定執行的次數</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">expect</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token plain\">mockFn</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">toHaveBeenCalledTimes</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">1000</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">expect</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token plain\">costTime</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">toEqual</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token plain\">expect</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">any</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token known-class-name class-name\" style=\"color:rgb(255, 203, 107)\">Number</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 回傳的 costTime 會是數字</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 檢驗當參數不是函數時會拋出錯誤</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">it</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;throw error when not provide a function&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:rgb(137, 221, 255)\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> mockFn </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;THIS_IS_NOT_A_FUNCTION&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">expect</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:rgb(137, 221, 255)\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">benchmarker</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token plain\">mockFn</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">toThrow</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>接著一樣修改 <code>package.json</code> 中的 <code>scripts</code> 欄位，方便我們執行 Jest 進行測試：</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// package.json</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;scripts&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;dev&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;rollup -c -w&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;build&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;rm -rf dist/ &amp;&amp; rollup -c&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;test&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;jest&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>執行 <code>npm test</code>，就可以看到測試的結果，若想要看到測試的覆蓋率，則可以輸入 <code>npm test -- --coverage</code>：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/SQ9hroC.gif\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>可以看到所有測試的項目都有通過，而且覆蓋率達 100%。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"發佈上-github\">發佈上 Github<a href=\"#發佈上-github\" class=\"hash-link\" aria-label=\"發佈上 Github的直接連結\" title=\"發佈上 Github的直接連結\">​</a></h2><p>到這裡就把專案大致建置起來了，透過 git 把它推上 <a href=\"https://github.com/pjchender/function-benchmarker\" target=\"_blank\" rel=\"noopener noreferrer\">github</a>，後續的幾篇都會根據這個專案架構進行調整，從手動到自動。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"範例程式碼\">範例程式碼<a href=\"#範例程式碼\" class=\"hash-link\" aria-label=\"範例程式碼的直接連結\" title=\"範例程式碼的直接連結\">​</a></h2><p>本篇完整的範例程式碼放到 Github 可供參考：</p><ul><li><a href=\"https://github.com/pjchender/function-benchmarker/commit/808d1c6b194f86d006018079900de86b954d97a1\" target=\"_blank\" rel=\"noopener noreferrer\">撰寫套件</a></li><li><a href=\"https://github.com/pjchender/function-benchmarker/commit/1dabe57de90673b694c89c267e90cbd2a5b9c751\" target=\"_blank\" rel=\"noopener noreferrer\">打包套件</a></li><li><a href=\"https://github.com/pjchender/function-benchmarker/commit/2c29917f740f6c5e9d3bf09d6764004fc3eaac11\" target=\"_blank\" rel=\"noopener noreferrer\">測試套件</a></li></ul><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"參考\">參考<a href=\"#參考\" class=\"hash-link\" aria-label=\"參考的直接連結\" title=\"參考的直接連結\">​</a></h2><ul><li><a href=\"https://docs.npmjs.com/about-scopes\" target=\"_blank\" rel=\"noopener noreferrer\">About scopes</a> @ npmjs</li><li><a href=\"https://docs.npmjs.com/using-npm/scope.html\" target=\"_blank\" rel=\"noopener noreferrer\">npm-scope</a> @ npmjs</li><li><a href=\"https://docs.npmjs.com/creating-and-publishing-scoped-public-packages\" target=\"_blank\" rel=\"noopener noreferrer\">Creating and publishing scoped public packages</a> @ npmjs</li></ul></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（1）：發佈前所需的設定檔（package.json） pjchender.dev": {
    "prefix": "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（1）：發佈前所需的設定檔（package.json） pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Guide] 發佈 npm 套件 - 從手動到自動（1）：發佈前所需的設定檔（package.json）</h1></header><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"keywords-deploy-publish-release-cli-npm-packagejson\">keywords: <code>deploy</code>, <code>publish</code>, <code>release</code>, <code>CLI</code>, <code>npm</code>, <code>package.json</code><a href=\"#keywords-deploy-publish-release-cli-npm-packagejson\" class=\"hash-link\" aria-label=\"keywords-deploy-publish-release-cli-npm-packagejson的直接連結\" title=\"keywords-deploy-publish-release-cli-npm-packagejson的直接連結\">​</a></h5><p><img loading=\"lazy\" src=\"../../../i.imgur.com/OfN4knZ.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>在<a href=\"https://pjchender.blogspot.com/2020/02/guide-npm-0.html\" target=\"_blank\" rel=\"noopener noreferrer\">前一篇</a>的文章中我們已經建立好了一個簡單的套件。現在要來說明 npm 套件中最重要的一支檔案 - <code>package.json</code>。</p><blockquote><p>⚠️ 撰寫文章時使用的 npm 版本為 6.13.7</p></blockquote><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"packagejson\">package.json<a href=\"#packagejson\" class=\"hash-link\" aria-label=\"package.json的直接連結\" title=\"package.json的直接連結\">​</a></h2><p><strong>每一個 npm 專案中，一定會包含一支 <code>package.json</code>，這支檔案就像是這個套件的「身分證」</strong>，裡面說明了和這個套件有關的各種訊息，其中像是套件名稱（<code>name</code>）、作者（<code>author</code>）、套件版本（<code>version</code>）等等。因此當你想要了解別人的套件時，可以先從 <code>package.json</code> 這隻檔案入手，同樣的，別人要認識你的專案時，一樣也會從這支檔案開始。</p><p>這裡我們就先來撰寫 <code>function-benchmarker</code> 這個套件的 <code>package.json</code> 吧！</p><p>下面列出一個 npm 套件中 <code>package.json</code> 會常用到的欄位，完整的說明可以參考 <a href=\"https://docs.npmjs.com/files/package.json.html\" target=\"_blank\" rel=\"noopener noreferrer\">npm 官方文件</a>：</p><ul><li><a href=\"https://docs.npmjs.com/files/package.json#name\" target=\"_blank\" rel=\"noopener noreferrer\">name</a>, <a href=\"https://docs.npmjs.com/files/package.json#version\" target=\"_blank\" rel=\"noopener noreferrer\">version</a>：套件名稱與版本，如果要發布到 npm 的話，名稱和版本會形成一個識別碼，這必須不能與他人重複。npm 使用<a href=\"https://semver.org/lang/zh-TW/\" target=\"_blank\" rel=\"noopener noreferrer\">語意化版本</a>的規範（semver），版本號中會包含 <code>主版號.次版號.修訂號</code>（<code>major.minor.patch</code>），不同版號的更新代表不同的意義，簡單的說明可以參考 <a href=\"../../npm/npm-server.html\" target=\"_blank\" rel=\"noopener noreferrer\">npm -套件版本的意義 semver</a>。</li><li><strong>description</strong>, <strong>keywords</strong>：套件描述與關鍵字，用來幫助他人找到這個套件。</li><li><strong>homepage</strong>：如果套件有獨立的介紹網站可以寫在這，否則可填寫 github 的網址，會顯示在 npm 官網說明上。</li><li><a href=\"https://docs.npmjs.com/files/package.json#bugs\" target=\"_blank\" rel=\"noopener noreferrer\">bugs</a>：當使用者發現問題是可以到哪裡回報，可以提供 <code>url</code> 或 <code>email</code>。</li><li><a href=\"https://docs.npmjs.com/files/package.json#license\" target=\"_blank\" rel=\"noopener noreferrer\">license</a>：版權，主要指該套件能否商業使用、私人使用、修改再用等等。預設是 ISC，這裡我使用較多人採用的 MIT，基本上這兩者都算是開源許可的授權，但我並沒有深入理解內部差異，其他授權種類可以參考 <a href=\"https://choosealicense.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Choose an open source license</a>、<a href=\"https://www.jianshu.com/p/86251523e898\" target=\"_blank\" rel=\"noopener noreferrer\">七種開源許可證</a>。</li><li><a href=\"https://docs.npmjs.com/files/package.json#people-fields-author-contributors\" target=\"_blank\" rel=\"noopener noreferrer\">author / contributors</a>：作者，可以提供作者的 <code>name</code>, <code>email</code>, <code>url</code>；若有多個開發者，則可以寫成 <code>contributors</code>。</li><li><a href=\"https://docs.npmjs.com/files/package.json#files\" target=\"_blank\" rel=\"noopener noreferrer\">files</a>：當使用者安裝此套件時，實際會下載的檔案。預設使用者安裝時會把整個發布到 npm 上的專案都下載下來，但專案中通常包含有未打包過的檔案（例如，<code>src</code> 資料夾）和打包後的部分（例如，<code>dist</code> 資料夾），透過此設定可以讓使用者安裝時只下載 <code>dist</code> 資料夾內的檔案，不必下載額外用不到的檔案。也可以透過 <code>.npmignore</code> 達到相同的作用（當 <code>.npmignore</code> 放在根目錄時，無法覆蓋 <code>files</code> 欄位的設定，但若放在子目錄時則可以）。</li><li><strong>main</strong>：其他使用者安裝套件後，使用該專案時的載入點，通常會取名為 <code>index.js</code> 或 <code>main.js</code>。</li><li><a href=\"https://docs.npmjs.com/files/package.json#repository\" target=\"_blank\" rel=\"noopener noreferrer\">repository</a>：套件程式碼放置的位置，若放置於 github 上的話，則可以填入 github 的網址，將會顯示在 npm 的套件說明頁。</li><li><a href=\"https://docs.npmjs.com/files/package.json#engines\" target=\"_blank\" rel=\"noopener noreferrer\">engines</a>：套件安裝時建議的 node 和 npm 版本</li></ul><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// package.json</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;name&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@pjchender/function-benchmarker&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;version&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;1.0.0&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;description&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;A simple benchmark for testing function performance&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;license&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;MIT&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;author&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;PJCHENder &lt;pjchender@gmail.com&gt; (https://pjchender.blogspot.com)&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 若有多個開發者</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// &quot;contributors&quot;: [</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">//   &quot;PJCHENder &lt;pjchender@gmail.com&gt; (https://pjchender.blogspot.com)&quot;,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">//   &quot;Andyyou &lt;andyyu0920@gmail.com&gt; (https://andyyou.github.io/)&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// ],</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;main&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;dist/index.min.js&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;scripts&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;dev&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;rollup -c -w&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;build&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;rm -rf dist/ &amp;&amp; rollup -c&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;test&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;jest&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;engines&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;node&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;&gt;=8&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;npm&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;&gt;=5&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;files&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;dist&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;repository&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;type&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;git&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;url&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;https://github.com/pjchender/function-benchmarker.git&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;homepage&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;https://github.com/pjchender/function-benchmarker&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;bugs&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;url&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;https://github.com/pjchender/function-benchmarker/issues&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;keywords&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;performance&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;benchmark&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;evaluation&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;speed&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;timer&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;devDependencies&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;jest&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;^25.1.0&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;rollup&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;^1.31.0&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;rollup-plugin-terser&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;^5.2.0&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"其他檔案\">其他檔案<a href=\"#其他檔案\" class=\"hash-link\" aria-label=\"其他檔案的直接連結\" title=\"其他檔案的直接連結\">​</a></h2><p>除了 <code>package.json</code> 外，套件當中經常還會包含其他設定檔，下面舉幾個常見的設定檔：</p><blockquote><p>其他設定檔可能會依據開發套件時所用的工具而有不同的設定檔，例如 <code>.eslintrc</code>, <code>.eslintignore</code>, <code>.babelrc</code>, <code>.prettierrc</code> 等等。</p></blockquote><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"gitignore\">.gitignore<a href=\"#gitignore\" class=\"hash-link\" aria-label=\".gitignore的直接連結\" title=\".gitignore的直接連結\">​</a></h3><p>一些不需要被 git 追蹤的檔案，例如 <code>node_modules</code> 或一些私人的密鑰（token）。在 GitHub 上有整理了<a href=\"https://github.com/github/gitignore\" target=\"_blank\" rel=\"noopener noreferrer\">各程式語言或專案</a>可以參考的 <a href=\"https://github.com/github/gitignore\" target=\"_blank\" rel=\"noopener noreferrer\"><code>.gitignore</code></a> 檔，可以複製一份當作基底在加入其他不想被 git 追蹤或公開到 github 的檔案。其中針對 Node.js 的 .gitignore 檔可以參考這裡 <a href=\"https://github.com/github/gitignore/blob/master/Node.gitignore\" target=\"_blank\" rel=\"noopener noreferrer\">Node.gitignore</a>。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"readmemd\">README.md<a href=\"#readmemd\" class=\"hash-link\" aria-label=\"README.md的直接連結\" title=\"README.md的直接連結\">​</a></h3><p>當專案發佈到 Github 上時預設會顯示的說明頁。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"license\">LICENSE<a href=\"#license\" class=\"hash-link\" aria-label=\"LICENSE的直接連結\" title=\"LICENSE的直接連結\">​</a></h3><p>放入與此專案對應的授權說明，一般有通用格式的文件。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"changelogmd\">CHANGELOG.md<a href=\"#changelogmd\" class=\"hash-link\" aria-label=\"CHANGELOG.md的直接連結\" title=\"CHANGELOG.md的直接連結\">​</a></h3><p>讓其他開發者可以很快地知道此套件每個版本有哪些變更。後需我們以自動化的方式產更新檔案。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"範例程式碼\">範例程式碼<a href=\"#範例程式碼\" class=\"hash-link\" aria-label=\"範例程式碼的直接連結\" title=\"範例程式碼的直接連結\">​</a></h2><p>本篇完整的範例程式碼放到 Github 可供參考：<a href=\"https://github.com/pjchender/function-benchmarker/commit/9ec80a884e7c25ada8f075b5a1067204765869bc\" target=\"_blank\" rel=\"noopener noreferrer\">fix:config package.json (9ec80a88)</a>。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"參考\">參考<a href=\"#參考\" class=\"hash-link\" aria-label=\"參考的直接連結\" title=\"參考的直接連結\">​</a></h2><ul><li><a href=\"https://docs.npmjs.com/files/package.json\" target=\"_blank\" rel=\"noopener noreferrer\">npm-package.json</a> @ npmjs doc</li><li><a href=\"https://docs.npmjs.com/creating-a-package-json-file\" target=\"_blank\" rel=\"noopener noreferrer\">Creating a package.json file</a> @ npmjs doc</li><li><a href=\"https://semver.org/lang/zh-TW/\" target=\"_blank\" rel=\"noopener noreferrer\">語意化版本 semver</a></li><li><a href=\"https://choosealicense.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Choose an open source license</a></li><li><a href=\"https://www.jianshu.com/p/86251523e898\" target=\"_blank\" rel=\"noopener noreferrer\">七種開源許可證</a> @ 簡書</li></ul></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（2）：手動 publish 篇 pjchender.dev": {
    "prefix": "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（2）：手動 publish 篇 pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Guide] 發佈 npm 套件 - 從手動到自動（2）：手動 publish 篇</h1></header><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"keywords-deploy-publish-release-cli-npm-packagejson\">keywords: <code>deploy</code>, <code>publish</code>, <code>release</code>, <code>CLI</code>, <code>npm</code>, <code>package.json</code><a href=\"#keywords-deploy-publish-release-cli-npm-packagejson\" class=\"hash-link\" aria-label=\"keywords-deploy-publish-release-cli-npm-packagejson的直接連結\" title=\"keywords-deploy-publish-release-cli-npm-packagejson的直接連結\">​</a></h5><p><img loading=\"lazy\" src=\"../../../i.imgur.com/OfN4knZ.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>在<a href=\"https://pjchender.blogspot.com/2020/02/guide-npm-1packagejson.html\" target=\"_blank\" rel=\"noopener noreferrer\">前一篇文章</a>中，我們已經完成了基本的 <code>package.json</code> 設定，現在就來試著發佈上 npm 吧！如果你還沒完成前一篇的專案內容，可以到 <a href=\"https://github.com/pjchender/function-benchmarker/tree/9ec80a884e7c25ada8f075b5a1067204765869bc\" target=\"_blank\" rel=\"noopener noreferrer\">Github</a> 這裡下載。</p><p>在邁入自動化發佈 npm 套件之前，我們仍然需要先了解如果要手動發布的話該如何執行，畢竟自動化的工具也就是幫我們把一連串的指令自動化執行。</p><blockquote><p>⚠️ 撰寫文章時使用的 npm 版本為 6.13.7。</p></blockquote><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"透過-npm-publish-手動發佈套件\">透過 npm publish 手動發佈套件<a href=\"#透過-npm-publish-手動發佈套件\" class=\"hash-link\" aria-label=\"透過 npm publish 手動發佈套件的直接連結\" title=\"透過 npm publish 手動發佈套件的直接連結\">​</a></h2><p>其實要把套件手動發佈到 npm 上並不難，只需要透過 <code>npm publish</code> 這個指令就可以了。但在那之前，如果你還沒申請帳號的話，需要先到 <a href=\"https://www.npmjs.com/\" target=\"_blank\" rel=\"noopener noreferrer\">npmjs</a> 上註冊一個帳號。</p><p>註冊完之後，讓我們來試試看，打開終端機進入到專案的根目錄：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 如果尚未登入 npm，需要輸入 npm 的帳號密碼</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> login</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><img loading=\"lazy\" src=\"../../../i.imgur.com/7lUFM9Q.png\" alt=\"img\" class=\"img_ev3q\"></p><p>接著在專案目錄內輸入 <code>npm publish</code>:</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> publish</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><img loading=\"lazy\" src=\"../../../i.imgur.com/IgwtbDG.png\" alt=\"img\" class=\"img_ev3q\"></p><p>這時候就發佈到 npm 上面啦！是不是非常簡單呢！？</p><p>你可以到 npmjs 點選右上角的頭像，點選 Packages 後，應該就可以看到剛剛發佈的套件已經列在裡面了：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/1K6i3Fk.png\" alt=\"img\" class=\"img_ev3q\"></p><p><a href=\"https://www.npmjs.com/package/@pjchender/function-benchmarker\" target=\"_blank\" rel=\"noopener noreferrer\">點進去</a>之後就可以看到當初在 <code>package.json</code> 中各欄位所設定的資料，以及 README 中對於該套件所寫的說明：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/dAFsBuD.png\" alt=\"img\" class=\"img_ev3q\"></p><p>這裡有兩個需要留意的地方：</p><ol><li>因為<a href=\"https://pjchender.blogspot.com/2020/02/guide-npm-0.html\" target=\"_blank\" rel=\"noopener noreferrer\">前面文章</a>一開始建立專案時就是建立 <a href=\"https://docs.npmjs.com/about-scopes\" target=\"_blank\" rel=\"noopener noreferrer\">scoped 的套件</a>，所以第一個是你會發現這個專案是以 <code>@</code> 的開頭</li><li>預設的情況下，<a href=\"https://docs.npmjs.com/creating-and-publishing-scoped-public-packages#publishing-scoped-public-packages\" target=\"_blank\" rel=\"noopener noreferrer\">scoped 的套件在 publish 時會是隱私的</a>，但因為我們使用的是免費帳號，並沒有提供隱私套件的額度，因此預設就會是公開的，可以留意一下套件名稱下方有顯示 <strong>Public</strong>：</li></ol><p><img loading=\"lazy\" src=\"../../../i.imgur.com/0qCAIJy.png\" alt=\"img\" class=\"img_ev3q\"></p><p>如果因為免費帳戶在發布 scoped package 時有些問題，只需要在 <code>npm publish</code> 後面加上 <code>--access public</code> 指定說這個套件是公開的即可：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> publish --access public</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"下載套件來使用\">下載套件來使用<a href=\"#下載套件來使用\" class=\"hash-link\" aria-label=\"下載套件來使用的直接連結\" title=\"下載套件來使用的直接連結\">​</a></h2><p>既然已經發佈到 npm 上，就表示其他使用者可以下載來使用了，來試試看吧！</p><p>先建立一個資料夾：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">mkdir</span><span class=\"token plain\"> function-benchmarker-sandbox  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 建立一個測試用資料夾</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">cd</span><span class=\"token plain\"> function-benchmarker-sandbox     </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 進入該資料夾</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>接著初始化 npm 後，把剛剛 publish 上去的套件 install 下來</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> init -y                                   </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 初始化 npm</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">install</span><span class=\"token plain\"> @pjchender/function-benchmarker   </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 下載剛剛 publish 上去的套件</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>這時候打開專案可以看到我們的套件已經被放到 <code>node_modules</code> 資料夾中了，點開來看會發現只有打包好的 <code>dist</code> 資料夾，而沒有未打包過原始碼（<code>src</code> 資料夾），還記得這是因為我們在<a href=\"https://pjchender.blogspot.com/2020/02/guide-npm-1packagejson.html\" target=\"_blank\" rel=\"noopener noreferrer\">前一篇文章</a>中透過在 <code>package.json</code> 中設定 <code>files</code> 欄位達到的嗎？</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/dIrGQHf.png\" alt=\"img\" class=\"img_ev3q\"></p><p>接著就在根目錄建立一支 <code>index.js</code> 來試著載入我們的套件，看看能不能正常運作：</p><div class=\"language-javascript codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-javascript codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// index.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 匯入套件</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> benchmarker </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">require</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;@pjchender/function-benchmarker&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 定義一個想要檢驗花費時間的函式</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"font-style:italic\">function</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">jsonStringify</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token known-class-name class-name\" style=\"color:rgb(255, 203, 107)\">JSON</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">stringify</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token literal-property property\">foo</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;bar&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 執行 benchMarker 這個方法，並把想檢驗的函式放進去</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> costTime </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">benchmarker</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token plain\">jsonStringify</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token console class-name\" style=\"color:rgb(255, 203, 107)\">console</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">log</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;costTime&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> costTime</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>接著用 <code>node index.js</code> 來執行這支 JavaScript 檔：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/JIPFSuM.png\" alt=\"img\" class=\"img_ev3q\"></p><p>可以看到的確可以成功使用 <code>@pjchender/function-benchmarker</code> 這個套件了。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"往自動化邁進\">往自動化邁進<a href=\"#往自動化邁進\" class=\"hash-link\" aria-label=\"往自動化邁進的直接連結\" title=\"往自動化邁進的直接連結\">​</a></h2><p>你會發現要把套件發佈到 npm 上並不困難，但是如果每次套件版本一有更新，我們就必須要執行這些事情：</p><ol><li>執行測試</li><li>修改套件版本號</li><li>修改 CHANGELOG 檔案</li><li>打包套件</li><li>發佈到 Github</li><li>發佈到 npm</li></ol><p>這些流程雖然都可以手動一一執行，但卻有些瑣碎，透過自動化的工具搭配持續整合（CI）就可以幫助我們省下這些瑣碎的流程。</p><p>在下一篇文章中，就讓我們開始從手動往自動化邁進吧！</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"參考文章\">參考文章<a href=\"#參考文章\" class=\"hash-link\" aria-label=\"參考文章的直接連結\" title=\"參考文章的直接連結\">​</a></h2><ul><li><a href=\"https://docs.npmjs.com/cli/publish\" target=\"_blank\" rel=\"noopener noreferrer\">npm-publish</a> @ npmjs doc</li><li><a href=\"https://docs.npmjs.com/creating-and-publishing-scoped-public-packages\" target=\"_blank\" rel=\"noopener noreferrer\">Creating and publishing scoped public packages</a> @ npmjs docs</li></ul></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（3）：整合 Travis CI 和 Github 進行自動化測試 pjchender.dev": {
    "prefix": "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（3）：整合 Travis CI 和 Github 進行自動化測試 pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Guide] 發佈 npm 套件 - 從手動到自動（3）：整合 Travis CI 和 Github 進行自動化測試</h1></header><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"keywords-deploy-publish-release-cli-npm-packagejson\">keywords: <code>deploy</code>, <code>publish</code>, <code>release</code>, <code>CLI</code>, <code>npm</code>, <code>package.json</code><a href=\"#keywords-deploy-publish-release-cli-npm-packagejson\" class=\"hash-link\" aria-label=\"keywords-deploy-publish-release-cli-npm-packagejson的直接連結\" title=\"keywords-deploy-publish-release-cli-npm-packagejson的直接連結\">​</a></h5><p><img loading=\"lazy\" src=\"../../../i.imgur.com/Er9V6qN.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>在<a href=\"https://pjchender.blogspot.com/2020/02/guide-npm-2.html\" target=\"_blank\" rel=\"noopener noreferrer\">前一篇文章</a>中我們已經說明了如何透過手動的方式將套件發佈上 npm，接著就可以進一步了解如何轉為自動化發佈，而自動化發佈的過程則有賴於「<strong>持續整合（Continuous Integration, CI）</strong>」的服務。</p><p>「<a href=\"https://help.github.com/en/actions/automating-your-workflow-with-github-actions/about-continuous-integration\" target=\"_blank\" rel=\"noopener noreferrer\">持續整合</a>」簡稱 <strong>CI</strong>，簡單來說，就是指當開發者把程式碼提交（commit）到 repository 後，可以自動地進行後續的一些動作，這些動作像是執行測試、打包原始碼、發佈和部署專案程式碼。例如，當開發者把程式碼發佈到 Github 上後，就可以透過 CI 立即對剛推上 Github 的程式碼進行測試，確保最新的程式碼是可以正確運作的，測試結束後則自動地繼續進行打包和部署。</p><p>由於持續整合的這些動作（例如，執行測試、打包、部署）都需要伺服器才能執行，因此勢必需要透過一些工具或服務才能達到。常見的 CI 服務包括 <a href=\"https://travis-ci.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Travis CI</a>、<a href=\"https://circleci.com/\" target=\"_blank\" rel=\"noopener noreferrer\">CircleCI</a>，或是由 Github 本身提供的 <a href=\"https://help.github.com/en/actions/automating-your-workflow-with-github-actions\" target=\"_blank\" rel=\"noopener noreferrer\">Github Actions</a> 等等，這些服務都能和 Github 上的 repository 進行持續整合。</p><p>這裡我們就以 Travis CI 作為說明。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"整合-travis-ci-和-github\">整合 Travis CI 和 Github<a href=\"#整合-travis-ci-和-github\" class=\"hash-link\" aria-label=\"整合 Travis CI 和 Github的直接連結\" title=\"整合 Travis CI 和 Github的直接連結\">​</a></h2><p>剛剛有提到，CI 的過程就是當我們把程式碼提交後，可以自動化的進行後續的動作。這裡我們是把程式碼提交到 Github，因此自然就需要整合 Travis CI 和 GIthub。當程式碼提交到 Github 上時，Travis CI 就會收到通知，然後才會在 Travis CI 上繼續進行持續整合的動作。</p><p>要整合 Travis CI 和 Github 非常容易，只需到 Github Marketplace 中的 <a href=\"https://github.com/marketplace/travis-ci\" target=\"_blank\" rel=\"noopener noreferrer\">Travis CI</a> 去執行安裝就可以了：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/Pi2Ediq.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p><strong>只要你的專案在 Github 上是公開的 Open Source 都可以免費使用 Travis CI</strong>，過程中可能會連結到 Travis CI 的網站去註冊帳號：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/d8dcoLh.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><blockquote><p>⚠️ 提醒：Travis CI 有兩個同樣功能但不同網址的網站，一個是 <code>travis-ci.org</code>（Travis CI），另一個則是 <code>travis-ci.com</code>（Travis CI Pro），據說前者是提供給 Open Source 使用，後者則是提供給付費的使用者，但不確定是不是之前我有做了什麼設定，因此這裡我安裝的時候是整合到 <code>travis-ci.com</code> 的網站。不論你是進到哪個網站都可以，只是需要稍微留意一下結尾是 <code>.org</code> 或 <code>.com</code>。</p></blockquote><p>安裝時會需要提供 Github 權限給 Travis CI 使用，並且可以選擇你希望提供所有的 Open Source 專案給 Travis CI 讀取，還是只提供需要的 repository 就好。目前我是習慣提供有用到的專案給 Travis CI 而已，因此這裡我就選擇 <code>function-benchmarker</code> 這個 repository：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/a94B98l.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>設定好按下存檔後，回到 Travis CI 網站的 Dashboard 內應該就可以看到剛剛授權的 Github Repository：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/SJEUZjt.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>點進去之後你會發現它還沒有任何「build」的紀錄：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/AGYbU6P.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"觸發-travis-ci\">觸發 Travis CI<a href=\"#觸發-travis-ci\" class=\"hash-link\" aria-label=\"觸發 Travis CI的直接連結\" title=\"觸發 Travis CI的直接連結\">​</a></h2><p>之所以沒有任何 build 的紀錄，是因為我們還沒觸發 Travis CI 去執行。</p><p>要讓 Travis CI 執行，我們需要在專案根目錄中新增一支名為 <code>.travis.yml</code> 的檔案，Travis CI 會根據這隻檔案內的設定去執行要做的事，之後我們還會進行更多的設定，但這裡先簡單填寫專案使用的語言和執行環境：</p><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># .travis.yml</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">language</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> node_js</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">node_js</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">12</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><blockquote><p>⚠️ 檔名需要是 <code>.travis.yml</code> 才會觸發 Travis CI，不能是 <code>.travis.yaml</code>。</p></blockquote><p>存檔並建立 commit 後，我們再把專案推上 Github。接著回到 Travis Dashboard，順利的話點選右方的 <strong>Request</strong>：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/9u5lDLK.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>應該會看到它已經接受到了一個新的 commit：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/ePPMydb.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>接著進到 <strong>Build History</strong> 的頁籤後，點進去可以看詳細的 Build 過程：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/CLr0lCx.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>在我們將專案推上 Github 後，Travis CI 會根據專案中所定義的 <code>.travis.yml</code> 來決定要執行哪些後續的動作，而這個執行後續動作的過程在 Travis CI 中稱為「<strong>Build</strong>」。整個 Build 的過程會像下面這樣（這裡因為我已經 Build 過一次，所以我是按 Restart Build），在最下方的地方會有 Job log，顯示現在 build 的過程正在做些什麼：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/20fmMvJ.gif\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>在這個過程中你會看到 Travis CI 預設就幫我們執行了 <code>npm test</code> 進行測試，因此一旦將專案推上 Github 後，就會透過 Travis CI 開始執行測試，完成後如果成功的話會顯示 <strong>PASS</strong>，整個 Build 過程結束後會顯示 <strong>Done</strong>：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/AKxMXSd.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>同樣的，在 Github 專案上你會看到一個圖示，這個圖示表示 Travis CI 的處理狀態，當專案一推上 Github 時，它會是咖啡色的圓點，Build 完之後則可能會顯示綠色勾勾（Test Pass）或紅色叉叉（Test Fail）：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/LE7UbRQ.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>由此你就可以知道該專案測試的結果。</p><p>現在，透過 Travis CI，我們已經可以在將專案推上 Github 後，對該專案自動進行後續的測試。接下來我們會透過 Travis CI 整合 <a href=\"https://semantic-release.gitbook.io/semantic-release/\" target=\"_blank\" rel=\"noopener noreferrer\">semantic-release</a> 這套工具來進行更多的操作。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"參考\">參考<a href=\"#參考\" class=\"hash-link\" aria-label=\"參考的直接連結\" title=\"參考的直接連結\">​</a></h2><ul><li><a href=\"https://help.github.com/en/actions/automating-your-workflow-with-github-actions/about-continuous-integration\" target=\"_blank\" rel=\"noopener noreferrer\">About continuous integration</a> @ Github Actions</li><li><a href=\"https://docs.travis-ci.com/user/tutorial/\" target=\"_blank\" rel=\"noopener noreferrer\">Travis CI Tutorial</a> @ Travis CI &gt; Getting Started</li></ul></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（4）：semantic-release 自動更新版號 pjchender.dev": {
    "prefix": "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（4）：semantic-release 自動更新版號 pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Guide] 發佈 npm 套件 - 從手動到自動（4）：semantic-release 自動更新版號</h1></header><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"keywords-deploy-publish-release-cli-npm-packagejson\">keywords: <code>deploy</code>, <code>publish</code>, <code>release</code>, <code>CLI</code>, <code>npm</code>, <code>package.json</code><a href=\"#keywords-deploy-publish-release-cli-npm-packagejson\" class=\"hash-link\" aria-label=\"keywords-deploy-publish-release-cli-npm-packagejson的直接連結\" title=\"keywords-deploy-publish-release-cli-npm-packagejson的直接連結\">​</a></h5><p><img loading=\"lazy\" src=\"../../../i.imgur.com/91PLgsK.png\" alt=\"semantic-release\" class=\"img_ev3q\"></p><p>在這篇文章中我們會先說明「<a href=\"https://semver.org/\" target=\"_blank\" rel=\"noopener noreferrer\">語意化版本（semver）</a>」，接著說明如何透過 <a href=\"https://semantic-release.gitbook.io/\" target=\"_blank\" rel=\"noopener noreferrer\">semantic-release</a> 這個工具結合 CI 來自動更新套件的版本。這篇文章算是這整個系列文章中相對最複雜的一篇，只要完成了這篇設定，只後的動作都會輕鬆很多。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"語意化版本semver\">語意化版本（semver）<a href=\"#語意化版本semver\" class=\"hash-link\" aria-label=\"語意化版本（semver）的直接連結\" title=\"語意化版本（semver）的直接連結\">​</a></h2><p>既然要發佈到 npm 上，很重要的一點自然就是套件的版本號，而 npm 上所有的套件都是遵循「<a href=\"https://semver.org/lang/zh-TW/\" target=\"_blank\" rel=\"noopener noreferrer\">語意化版本</a>」的「慣例」。</p><p>「語意化版本」的全名是 <strong>Semantic Versioning</strong>，常會簡稱為 <a href=\"https://semver.org/\" target=\"_blank\" rel=\"noopener noreferrer\"><strong>semver</strong></a>，它的核心概念在於<strong>讓使用該套件的開發者在看到版號時就能夠知道該版本有無重大更新或需要留意的地方</strong>。一個套件的版本共會由三個數字組成，像是 <code>1.0.0</code>，三個數字由左至右，分別指的是「<strong>主版號（major）</strong>」、「<strong>次版號（minor）</strong>」和「<strong>修訂號（patch）</strong>」。</p><p>每個版號的變更都有它所代表的意義：</p><ol><li><strong>主版號（major）</strong>：表示這個套件修改了原本的 API，使其<strong>無法向下相容</strong>，這是開發者最需要留意的情況，算是重大改變（<strong>BREAKING CHANGE</strong>）。</li><li><strong>次版號（minor）</strong>：在可以向下相容的情況下為套件添加了<strong>新功能（feature）</strong>。</li><li><strong>修訂號（patch）</strong>：在可以下向相容的情況下做了問題<strong>修正（fix）</strong>。</li></ol><blockquote><p>💡 備註：有時主版號改變不代表你真的需要去修改原本寫的程式，有些時候只是不再支援某一版本前的 JavaScript / NodeJS，這時候因為無法再繼續向下相容，所以也會提升主版號。</p></blockquote><p>但既然稱作是「慣例」就表示可以不遵守，而這樣不遵守的情況其實在 NodeJS 的世界還蠻常見的...。</p><p>因此若要看每次套件的更新實際上有哪些變化，可以到專案中的「<code>CHANGELOG.md</code>」或 Github 上的「releases」標籤中查看，在一個完整的專案中一定會有這個部分：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/URaX3lw.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>點進去就可以看到每次版本變更時做了哪些改變。</p><p>Releases：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/hmHuA0E.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>CHANGELOG：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/yE8owz1.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"透過-semantic-release-自動更新套件版本\">透過 semantic-release 自動更新套件版本<a href=\"#透過-semantic-release-自動更新套件版本\" class=\"hash-link\" aria-label=\"透過 semantic-release 自動更新套件版本的直接連結\" title=\"透過 semantic-release 自動更新套件版本的直接連結\">​</a></h2><p>在瞭解了 semver 後，現在我們就要來練習修改套件的版號。在 npm CLI 的工具中，有提供 <a href=\"https://docs.npmjs.com/cli/version\" target=\"_blank\" rel=\"noopener noreferrer\"><code>npm version</code></a> 這個指令可以讓開發者手動的去修改版號，但這麽做除了每次都需要手動記得去改版號之外，也有更多人為介入的空間，例如，明明已經有重大 API 的改變，卻只手動升了次版號。</p><p>為了解決人為介入與手動的問題，很多開發者會使用 <a href=\"https://semantic-release.gitbook.io/semantic-release/\" target=\"_blank\" rel=\"noopener noreferrer\">semantic-release</a> 這套工具來達到自動更新版號、產生 CHANGELOG 檔案、並且發佈到 npm 的這一系列動作。這裡我們先來看它如何自動更新套件版號。</p><p>由於 semantic-release 執行動作的階段會是在 CI 中，因此除了需要把 semantic-release 安裝到專案中外，也必須要先在 Github 建立 token，把 token 設定到 CI 的服務上（這裡是用 Travis CI），讓 CI 有讀取和寫入 Github 專案的權限；若需要讓 semantic-release 自動將套件發佈到 npm 上，同樣需要在 npm 建立 token，然後設定回 CI 的服務上...，感覺很麻煩吧，不怕，有 <code>semantic-release-cli</code>！</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"使用-semantic-release-cli-快速完成設定\">使用 semantic-release-cli 快速完成設定<a href=\"#使用-semantic-release-cli-快速完成設定\" class=\"hash-link\" aria-label=\"使用 semantic-release-cli 快速完成設定的直接連結\" title=\"使用 semantic-release-cli 快速完成設定的直接連結\">​</a></h3><p>這個步驟很繁瑣，好在 semantic-release 有推出了 cli 可以快速幫我們完成上面這個繁瑣的過程。先把 <code>semantic-release-cli</code> 安裝到電腦中，然後進到專案執行 <code>setup</code> 的動作：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">install</span><span class=\"token plain\"> -g semantic-release-cli</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">cd</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">your-module</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ semantic-release-cli setup</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">install</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>執行 setup 的時候，它為了要幫我們在 Github 和 npm 產生對應的 token 並放到 CI 上，因此會需要輸入 Github, npm 的帳號密碼，並選擇所用的 CI 服務。這個設定的流程會像這樣：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/J3lfP5K.gif\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>這裡需要注意的是，在選擇 CI 服務時，如果你的專案放在 <code>travis-ci.org</code> 的話，請選擇 Travis CI；如果你的專案放在 <code>travis-ci.com</code> 的話，則選擇 Travis CI Pro；如果你使用的是其他 CI 服務的話，就選擇其他的選項。</p><p>我們來看一下剛剛這個 <code>semantic-release-cli</code> 幫我們做了哪些設定。</p><ol><li>產生 Github 上的 Personal Access Token：它會到 Github &gt; Settings &gt; Developer Settings &gt; Personal access token 中產生一組 token，這組 token 是要給 Travis CI 使用，你可以到 <a href=\"https://github.com/settings/tokens/\" target=\"_blank\" rel=\"noopener noreferrer\">Personal access tokens</a> 上查看：</li></ol><p><img loading=\"lazy\" src=\"../../../i.imgur.com/ySmp4vf.gif\" alt=\"Imgur\" class=\"img_ev3q\"></p><ol start=\"2\"><li>產生 npm 上的 Authentication Token：它會到 npm &gt; Auth Tokens 中產生一組 Authentication Token，一樣可以登入 npm 後查看：</li></ol><p><img loading=\"lazy\" src=\"../../../i.imgur.com/GHQtzN4.gif\" alt=\"Imgur\" class=\"img_ev3q\"></p><ol start=\"3\"><li>把 Github Token 和 npm token 設定到 Travis CI 的專案中：它會到 Travis CI 中該專案的 settings 中設定 <code>GH_TOKEN</code> 和 <code>NPM_TOKEN</code> 這兩個環境變數，這是要給 semantic-release 使用的：</li></ol><p><img loading=\"lazy\" src=\"../../../i.imgur.com/5VRfbG0.gif\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>除了完成這些設定外，它也幫我們在專案中安裝了 semantic-release、把版號歸零，並且產生了一道 <code>semantic-release</code> 的 scripts，記得要執行 <code>npm install</code>：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/HpF426w.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p><strong>⚠️ 因為我們曾經把套件發佈到 npm 上過，因此這裡會把版號改回已經在 npm 上的 <code>1.0.0</code>，否則之後會發生版本衝突而無法發佈上 npm 的情況。</strong></p><blockquote><p>💡 備註：如果你不想透過 <code>semantic-release-cli</code> 完成這些設定的話，也可以選擇手動一步一步完成，這裡有列出<a href=\"https://semantic-release.gitbook.io/semantic-release/usage/getting-started\" target=\"_blank\" rel=\"noopener noreferrer\">步驟</a>可以參考；在 github 和 npm 上手動建立 token，並設定到 CI 的環境變數上則可以參考<a href=\"https://github.com/semantic-release/semantic-release/blob/master/docs/usage/ci-configuration.md#authentication\" target=\"_blank\" rel=\"noopener noreferrer\">這裡</a>。</p></blockquote><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"修改-travisyml\">修改 travis.yml<a href=\"#修改-travisyml\" class=\"hash-link\" aria-label=\"修改 travis.yml的直接連結\" title=\"修改 travis.yml的直接連結\">​</a></h2><p>完成 semantic-release 的安裝以及對應的設定後，接下來要來修改 <code>travis.yml</code> 這支檔案，讓專案推上 Github 並進入 CI 的階段後可以去執行 semantic-release：</p><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># travis.yml</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">language</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> node_js</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">node_js</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">12</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">include</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># Define the release stage that runs semantic-release</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">stage</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> release</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">node_js</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> lts/*</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># Advanced: optionally overwrite your default `script` step to skip the tests</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># script: skip</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">deploy</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">provider</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> script</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">script</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> npx semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>這份設定的說明如下：</p><ul><li>在 Travis CI 中新增一個 Job</li><li>這個 Job 會在 Travis CI 的 <a href=\"https://docs.travis-ci.com/user/job-lifecycle/\" target=\"_blank\" rel=\"noopener noreferrer\">release 階段</a>執行</li><li>執行 <code>deploy</code> 的動作，deploy 的方式是去執行 <code>script</code></li><li>要執行的 <code>script</code> 即是 <code>npx semantic-release</code></li></ul><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"自動變更版號的邏輯---conventional-commit\">自動變更版號的邏輯 - conventional commit<a href=\"#自動變更版號的邏輯---conventional-commit\" class=\"hash-link\" aria-label=\"自動變更版號的邏輯 - conventional commit的直接連結\" title=\"自動變更版號的邏輯 - conventional commit的直接連結\">​</a></h2><p>現在完成這些設定之後，我們就可以把最新的專案推到 Github 上觸發 Travis CI 執行。但在這之前，我們要來說明 semantic-release 到底是用什麼樣的依據來幫我們自動變更版號！</p><p>首先 semantic-release 變更版號的方式一樣遵循最上面所提的 semver，而它會依據每一次的 commit message 來決定要如何修改版號，並後續產生對應的 releases tag 和 CHANGELOG（這個會在後面的文章中提到）。</p><p>既然要根據 commit message 來決定如何變更版號，勢必得要有個規範，而這個 <a href=\"https://semantic-release.gitbook.io/semantic-release/#commit-message-format\" target=\"_blank\" rel=\"noopener noreferrer\">commit message 的規範</a>主要是依據 <a href=\"https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#-git-commit-guidelines\" target=\"_blank\" rel=\"noopener noreferrer\">Angular Commit Message Conventions</a>。聽起來很複雜，但簡單來說就是他會根據 commit message 中的「關鍵字」來判斷要改變版號中的哪個部分。</p><p>以 semantic-release 提供的下表來看：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/MQWETWB.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>這種慣例的 commit message 都會長得像這樣：</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">&lt;type&gt;(optional scope): &lt;description&gt;</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">[optional body]</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">[optional footer]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>其中 <code>scope</code> 的部分則是可以選擇性填寫的，而 <code>type</code> 是最主要用來判斷版號變更的依據，對應到 semver：</p><ul><li><code>fix</code>：表示在 API 可向下相容的情況下修改套件問題，屬於 <code>PATCH</code> 的版號變更</li><li><code>feat</code>：表示在 API 可向下相容的情況下添加套件功能（feature），屬於 <code>MINOR</code> 的版號變更</li></ul><p>其他常見的 type 還包括 <code>chore</code>, <code>build</code>, <code>ci</code>, <code>docs</code>, <code>perf</code> 等等，可以參考 Github 上的這個說明：</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">/* github 在 Commits 上的說明 */</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">type:</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"> • build: Changes that affect the build system or external dependencies (example scopes: gulp, broccoli, npm)</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"> • ci: Changes to our CI configuration files and scripts (example scopes: Circle, BrowserStack, SauceLabs)</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"> • docs: Documentation only changes</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"> • feat: A new feature</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"> • fix: A bug fix</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"> • perf: A code change that improves performance</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"> • refactor: A code change that neither fixes a bug nor adds a feature</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"> • style: Changes that do not affect the meaning of the code (white-space, formatting, missing semi-colons, etc)</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"> • test: Adding missing tests or correcting existing tests</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>那麼要怎麼更新主版號呢？只要在 commit message 中的「Footer」區塊以 <code>BREAKING CHANGE:</code> 開頭的話，就會被視為有無法向下相容的重大變更，這時候就屬於 <code>MAJOR</code> 的版號變更。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"試著透過-commit-message-修改版號\">試著透過 commit message 修改版號<a href=\"#試著透過-commit-message-修改版號\" class=\"hash-link\" aria-label=\"試著透過 commit message 修改版號的直接連結\" title=\"試著透過 commit message 修改版號的直接連結\">​</a></h2><p>讓我們直接來試試看吧！</p><p>因為剛剛在專案中的檔案已經有了變更，我們就直接寫下 commit，像這這樣：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/89qIet0.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>接著一樣將推到 Github 上。成功推上去並觸發完成 CI 後，會發現我們在 Github 的 release 頁籤中多了一個 tag：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/PdTFCqV.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>點進去看後會發現 <code>semantic-release</code> 已經幫我們建立了一個 release tag：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/Sw3PJrj.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>現在，你可以試著在專案中新增修改一些內容，內容透過 conventional commit 的格式建立新的 commit 在推上 Github 看看版號會有什麼樣不同的變化。例如這裡我用了：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">git</span><span class=\"token plain\"> commit -m </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;fix: remove redundant comments&quot;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>於是 releases 中又多了以下部分，修訂號也增加了：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/T8nNwc9.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>除了 Github 多了 releases 外，semantic-release 預設也會幫我們將套件發佈到 npm 上：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/ZyYr7YR.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>但這時候如果你透過 <code>npm install</code> 下載專案下來看的話，會發現原本在 <code>node_modules/@pjchender/function-benchmarker</code> 中的 <code>dist</code> 資料夾不見了，等於套件中最重要的程式碼都沒了：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/YJrOr5q.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>之所以會這樣，是因為現在是透過 semantic-release 於 CI 過程中把套件發佈到 npm 上。但在一開始把專案推上 Github 時，<code>dist</code> 資料夾預設是被我們 ignore 掉的（設定在 <code>.gitignore</code> 中），所以一開始推上 github 的檔案中就沒有打包好的 <code>dist</code>，自然在 CI 過程中也不會發佈到 npm 上。</p><p><strong>要解決這個問題，我們就必須在 CI 的過程中，執行 <code>build</code> 的指令來打包專案，如此才會有打包後的 <code>dist</code> 資料夾。這個部分將會在下一篇文章中做說明。</strong></p><p>現在，我們完成最複雜也最麻煩的一部分了，已經可以透過 semantic-release 自動更新版號，在 Github 上產生 releases 的標籤，並且自動發佈到 npm 上（雖然專案內容還不完整）。接下來，會輕鬆一些，我們將修正 npm 上的檔案沒有內容的情況，並透過 semantic-release 來產生 CHANGELOG 檔案。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"參考\">參考<a href=\"#參考\" class=\"hash-link\" aria-label=\"參考的直接連結\" title=\"參考的直接連結\">​</a></h2><ul><li><a href=\"https://semver.org/lang/zh-TW/\" target=\"_blank\" rel=\"noopener noreferrer\">語意化版本 2.0.0</a></li><li><a href=\"https://docs.npmjs.com/cli/version\" target=\"_blank\" rel=\"noopener noreferrer\">npm-version</a> @ npm CLI commands</li><li><a href=\"https://docs.travis-ci.com/user/job-lifecycle/\" target=\"_blank\" rel=\"noopener noreferrer\">Job Life Cycle</a> @ Travis CI</li><li>Commit Message Format<ul><li><a href=\"https://www.conventionalcommits.org/en/v1.0.0/\" target=\"_blank\" rel=\"noopener noreferrer\">Conventional Commits</a></li><li><a href=\"https://wadehuanglearning.blogspot.com/2019/05/commit-commit-commit-why-what-commit.html\" target=\"_blank\" rel=\"noopener noreferrer\">Git Commit Message 這樣寫會更好，替專案引入規範與範例</a> @ WadeHuang 的學習迷航記</li><li><a href=\"https://nitayneeman.com/posts/understanding-semantic-commit-messages-using-git-and-angular/\" target=\"_blank\" rel=\"noopener noreferrer\">Understanding Semantic Commit Messages Using Git and Angular</a></li><li><a href=\"https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#-git-commit-guidelines\" target=\"_blank\" rel=\"noopener noreferrer\">Angular Commit Message Conventions</a></li></ul></li><li><a href=\"https://semantic-release.gitbook.io/semantic-release/\" target=\"_blank\" rel=\"noopener noreferrer\">semantic-release</a><ul><li><a href=\"https://semantic-release.gitbook.io/semantic-release/usage/getting-started\" target=\"_blank\" rel=\"noopener noreferrer\">手動設定步驟</a></li><li><a href=\"https://github.com/semantic-release/semantic-release/blob/master/docs/usage/ci-configuration.md#authentication\" target=\"_blank\" rel=\"noopener noreferrer\">github, npm 等取得 authentication token 的方式</a></li></ul></li></ul></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（5）：semantic-release 自動發佈到 npm pjchender.dev": {
    "prefix": "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（5）：semantic-release 自動發佈到 npm pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Guide] 發佈 npm 套件 - 從手動到自動（5）：semantic-release 自動發佈到 npm</h1></header><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"keywords-deploy-publish-release-cli-npm-packagejson\">keywords: <code>deploy</code>, <code>publish</code>, <code>release</code>, <code>CLI</code>, <code>npm</code>, <code>package.json</code><a href=\"#keywords-deploy-publish-release-cli-npm-packagejson\" class=\"hash-link\" aria-label=\"keywords-deploy-publish-release-cli-npm-packagejson的直接連結\" title=\"keywords-deploy-publish-release-cli-npm-packagejson的直接連結\">​</a></h5><p><img loading=\"lazy\" src=\"../../../i.imgur.com/91PLgsK.png\" alt=\"semantic-release\" class=\"img_ev3q\"></p><p>在<a href=\"https://pjchender.blogspot.com/2020/02/guide-npm-4semantic-release.html\" target=\"_blank\" rel=\"noopener noreferrer\">前一篇</a>文章中，我們已經知道預設的情況下 semantic-release 它會自動在 CI 的過程中將套件發佈到 npm 上，如果你的套件是在本地打包好，而且最終打包好的 <code>dist</code> 資料夾也會上 <code>git</code> 的話，這麼做當然沒問題。然而，多數實際的情況是，<code>dist</code> 資料夾因為是打包壓縮過的專案，因此一般是會寫入 gitignore 中而不會上 git 的。</p><p>因此，在上篇文章的最後，你會發現透過 <code>npm install</code> 把我們的套件下載後，會發現套件裡面「空空的」而沒辦法使用。在這篇文章中我們會說明怎麼樣在 Travis CI 中，執行打包的動作，在 CI 中打包完之後 <code>dist</code> 資料夾中就會有東西，此時發佈到 npm 上時，套件就可以正常運作了。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"修改-travisyml-設定檔\">修改 .travis.yml 設定檔<a href=\"#修改-travisyml-設定檔\" class=\"hash-link\" aria-label=\"修改 .travis.yml 設定檔的直接連結\" title=\"修改 .travis.yml 設定檔的直接連結\">​</a></h2><p>要讓 Travis CI 可以幫我們執行 build 的指令，只需修改 <code>.travis.yml</code> 這支設定檔：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/wIzqEGX.png\" alt=\"semantic-release\" class=\"img_ev3q\"></p><p>這裡有兩個要留意的地方：</p><ol><li>在 <code>release</code> 階段中透過 <code>script</code> 的項目，告訴它要執行 <code>npm run build</code> 的指令，如此就可以在 CI 上進行打包的動作</li><li>另一個很重要的地方是 <code>skip_cleanup: true</code> 這個項目，如果沒有設定的話，雖然會在 CI 上執行打包的動作，但這些打包好的東西在發佈到 npm 前就會被 CI 給清除掉了，因此要加上 <code>skip_cleanup: true</code> 來告訴 Travis CI 不要把剛剛打包過的東西給清除掉。</li></ol><blockquote><p>💡 備註：使用 <code>skip_cleanup</code> 時可能會看到該 API 已經 deprecated 的提示，但這是在 deployment API v2 後，因此現在仍然要加上，參考 <a href=\"https://travis-ci.community/t/skip-cleanup-true-is-now-deprecated-how-to-go-for-gradle-publish/6641\" target=\"_blank\" rel=\"noopener noreferrer\">Skip_cleanup: true is now deprecated. How to go for gradle publish?</a>。</p></blockquote><p>如此簡單的兩行指令，就可以讓 semantic-release 幫我們把正確的套件發佈到 npm 上了！現在透過 <code>npm install</code> 把套件抓下來後，可以看到我們套件的 <code>dist</code> 資料夾中已經有打包好的檔案了：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/cFJE6NO.png\" alt=\"build with semantic-release\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"不要自動發佈到-npm\">不要自動發佈到 npm<a href=\"#不要自動發佈到-npm\" class=\"hash-link\" aria-label=\"不要自動發佈到 npm的直接連結\" title=\"不要自動發佈到 npm的直接連結\">​</a></h2><p>有些時候你不希望 semantic-release 自動把套件發佈到 npm 上時，可以怎麼做呢？</p><p>這時候我們可以在專案根目錄中新增一支名為 <code>.releaserc.json</code> 的檔案，裡面可以這樣寫：</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// .releaserc.json</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;plugins&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/commit-analyzer&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/release-notes-generator&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/npm&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token property\">&quot;npmPublish&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:rgb(255, 88, 116)\">false</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><code>.releaserc.json</code> 這隻檔案是給 semantic-release 的<a href=\"https://semantic-release.gitbook.io/semantic-release/usage/configuration\" target=\"_blank\" rel=\"noopener noreferrer\">設定檔</a>，這裡面可以設定要使用哪些 semantic-release 相關的套件（plugin），並且給予額外的參數設定，以這裡為例，透過 <code>npmPublish: false</code> 就可以避免套件自動發佈到 npm 上。</p><p>在安裝 semantic-release 時，預設就已經安裝了下面這些<a href=\"https://semantic-release.gitbook.io/semantic-release/usage/plugins\" target=\"_blank\" rel=\"noopener noreferrer\">外掛（plugin）</a>：</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">&quot;@semantic-release/commit-analyzer&quot;</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">&quot;@semantic-release/github&quot;</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">&quot;@semantic-release/npm&quot;</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">&quot;@semantic-release/release-notes-generator&quot;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"參考\">參考<a href=\"#參考\" class=\"hash-link\" aria-label=\"參考的直接連結\" title=\"參考的直接連結\">​</a></h2><ul><li><a href=\"https://semantic-release.gitbook.io/semantic-release/usage/configuration\" target=\"_blank\" rel=\"noopener noreferrer\">Configuration</a> @ semantic-release</li><li><a href=\"https://semantic-release.gitbook.io/semantic-release/usage/plugins\" target=\"_blank\" rel=\"noopener noreferrer\">Plugins</a> @ semantic-release</li></ul></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（6）：semantic-release 的外掛設定與自動產生 CHANGELOG pjchender.dev": {
    "prefix": "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（6）：semantic-release 的外掛設定與自動產生 CHANGELOG pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Guide] 發佈 npm 套件 - 從手動到自動（6）：semantic-release 的外掛設定與自動產生 CHANGELOG</h1></header><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"keywords-deploy-publish-release-cli-npm-packagejson\">keywords: <code>deploy</code>, <code>publish</code>, <code>release</code>, <code>CLI</code>, <code>npm</code>, <code>package.json</code><a href=\"#keywords-deploy-publish-release-cli-npm-packagejson\" class=\"hash-link\" aria-label=\"keywords-deploy-publish-release-cli-npm-packagejson的直接連結\" title=\"keywords-deploy-publish-release-cli-npm-packagejson的直接連結\">​</a></h5><p><img loading=\"lazy\" src=\"../../../i.imgur.com/91PLgsK.png\" alt=\"semantic-release\" class=\"img_ev3q\"></p><p>在<a href=\"https://pjchender.blogspot.com/2020/02/npm-5semantic-release-npm.html\" target=\"_blank\" rel=\"noopener noreferrer\">上一篇</a>文章中已經有透露如果要對 semantic-release 套用外掛（plugin）或進行更多的設定，可以在根目錄建立一支 <code>.releaserc.json</code> 的檔案，現在我們一樣可以透過這支檔案，來讓 semantic-release 自動產生 <code>CHANGELOG.md</code> 的檔案。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安裝-semantic-release-外掛\">安裝 semantic-release 外掛<a href=\"#安裝-semantic-release-外掛\" class=\"hash-link\" aria-label=\"安裝 semantic-release 外掛的直接連結\" title=\"安裝 semantic-release 外掛的直接連結\">​</a></h2><p>預設的情況下，semantic-release 就已經安裝了幾個<a href=\"https://semantic-release.gitbook.io/semantic-release/usage/plugins\" target=\"_blank\" rel=\"noopener noreferrer\">外掛（plugin）</a>，像是 ：</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;@semantic-release/commit-analyzer&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;@semantic-release/github&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;@semantic-release/npm&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;@semantic-release/release-notes-generator&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>為了要產生 CHANGELOG 檔案，並且保存推進 git 中，需要再安裝 <code>@semantic-release/changelog</code> 和 <code>@semantic-release/git</code> 這兩個外掛：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">install</span><span class=\"token plain\"> @semantic-release/changelog @semantic-release/git -D</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"設定-releasercjson\">設定 .releaserc.json<a href=\"#設定-releasercjson\" class=\"hash-link\" aria-label=\"設定 .releaserc.json的直接連結\" title=\"設定 .releaserc.json的直接連結\">​</a></h2><p>接著在根目錄底下新增一隻 <code>.releaserc.json</code> 的檔案（如果已經建過就不用重複新增），在這支檔案裡貼上：</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// .releaserc.json</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;plugins&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/commit-analyzer&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/release-notes-generator&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/changelog&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/npm&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/git&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>建立好設定檔後，commit 並推上 Github，這時候在 Travis CI 持續整合的過程中，就會新增一支 <code>CHANGELOG.md</code> 的檔案在根目錄了：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/4EccQY0.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>這裡你可以注意到：</p><ol><li>最後的 git commit 是由 <code>semantic-release-bot</code> 所建立的，這是透過 <code>@semantic-release/git</code> 這個套件達到的。</li><li>不知道你先前有沒有發現到，之前雖然每次推上 Github 或發佈到 npm 上時的版號都有不斷更新，但 git 中 <code>package.json</code> 檔案裡面的版號卻都沒有改變，這同樣是因為之前沒有安裝 <code>@semantic-release/git</code> 的關係，所以雖然 Github 和 npm 上的版號更新了，但因為 semantic-release 沒有把更新後的 <code>package.json</code> 檔 commit 回我們的 repository，所以本機 <code>package.json</code> 中的版號才會都沒有更動。</li><li><code>CHANGELOG.md</code> 檔案的內容有更新了，這是透過 <code>@semantic-release/changelog</code> 這個套件達到的。CHANGELOG 中的內容會依據 commit 的內容進行更新：</li></ol><p><img loading=\"lazy\" src=\"../../../i.imgur.com/7MUOuNn.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"semantic-release-的外掛設定\">semantic-release 的外掛設定<a href=\"#semantic-release-的外掛設定\" class=\"hash-link\" aria-label=\"semantic-release 的外掛設定的直接連結\" title=\"semantic-release 的外掛設定的直接連結\">​</a></h2><p>在了解如何產生 <code>CHANGELOG.md</code> 檔，並透過 <code>@semantic-release/git</code> 來把變更的內容推回 git 後，我們可以再來看一下 semantic-release 外掛的設定：</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"semantic-releasechangelog\">@semantic-release/changelog<a href=\"#semantic-releasechangelog\" class=\"hash-link\" aria-label=\"@semantic-release/changelog的直接連結\" title=\"@semantic-release/changelog的直接連結\">​</a></h3><p>在 <a href=\"https://github.com/semantic-release/changelog\" target=\"_blank\" rel=\"noopener noreferrer\"><code>@semantic-release/changelog</code></a> 這個套件中，預設會在根目錄新增一支 <code>CHANGELOG.md</code> 的檔案，如果你想要修改 CHANGELOG 檔放置的路徑或標題（title），一樣可以在 <code>.releaserc.json</code> 中進行設定：</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// .releaserc.json</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;plugins&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/commit-analyzer&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/release-notes-generator&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 修改 changelog 檔預設的路徑和標題</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/changelog&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token property\">&quot;changelogFile&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;docs/CHANGELOG.md&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token property\">&quot;changelogTitle&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;This is Title&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 預設會 commit 根目錄的 CHANGELOG.md 檔，因此要告訴它說去其他路徑取得 CHANGELOG 檔</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/git&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token property\">&quot;assets&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;docs/CHANGELOG.md&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"semantic-releasegit\">@semantic-release/git<a href=\"#semantic-releasegit\" class=\"hash-link\" aria-label=\"@semantic-release/git的直接連結\" title=\"@semantic-release/git的直接連結\">​</a></h3><p>透過 <a href=\"https://github.com/semantic-release/git\" target=\"_blank\" rel=\"noopener noreferrer\"><code>@semantic-release/git</code></a> 這個套件，可以告訴 semantic-release 哪些檔案是它可以 commit 進我們的專案，並且可以修改 commit 的訊息。預設的情況下它可以 commit 進專案的檔案包括：</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;CHANGELOG.md&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;package.json&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;package-lock.json&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;npm-shrinkwrap.json&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>如果檔案的路徑有變更，或者有些檔案是打包後才產生，希望可以大家可以透過 github 取得的，一樣可以在這裡進行設定，以下面的設定為例，除了 <code>CHANGELOG.md</code>, <code>package.json</code> 和 <code>package-lock.json</code> 會進 git 之外，我們把打包後會產生的 <code>extension.zip</code> 檔案也進 git，如此使用者便會在 Github 上看得到這隻檔案：</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// .releaserc.json</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;plugins&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/commit-analyzer&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/release-notes-generator&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/changelog&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/git&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token property\">&quot;assets&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;CHANGELOG.md&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;package.json&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;package-lock.json&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;extension.zip&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"semantic-releasenpm\">@semantic-release/npm<a href=\"#semantic-releasenpm\" class=\"hash-link\" aria-label=\"@semantic-release/npm的直接連結\" title=\"@semantic-release/npm的直接連結\">​</a></h3><p>如我你的套件並不需要發佈到 npm 上，除了可以透過<a href=\"https://pjchender.blogspot.com/2020/02/npm-5semantic-release-npm.html\" target=\"_blank\" rel=\"noopener noreferrer\">上一篇</a>的方式，設定 <code>npmPublish: false</code> 外，也可以在 <code>.releaserc.json</code> 中把 <a href=\"https://github.com/semantic-release/npm\" target=\"_blank\" rel=\"noopener noreferrer\"><code>@semantic-release/npm</code></a> 移掉也可以達到一樣的效果。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"錯誤處理在-travis-ci-上使用出現-cannot-find-module-的問題\">錯誤處理：在 Travis CI 上使用出現 Cannot find module 的問題<a href=\"#錯誤處理在-travis-ci-上使用出現-cannot-find-module-的問題\" class=\"hash-link\" aria-label=\"錯誤處理：在 Travis CI 上使用出現 Cannot find module 的問題的直接連結\" title=\"錯誤處理：在 Travis CI 上使用出現 Cannot find module 的問題的直接連結\">​</a></h2><p>如果你在 Travis CI 執行的過程中出現類似的錯誤訊息時：</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">Cannot find module &#x27;@semantic-release/changelog&#x27;</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">Cannot find module &#x27;@semantic-release/git&#x27;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>可以修改 <code>.travis.yaml</code> 的檔案，將 <code>script</code> 的地方改成：</p><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token key atrule\">script</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npx </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">p @semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release/changelog </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">p @semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release/git </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">p semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"下一步\">下一步<a href=\"#下一步\" class=\"hash-link\" aria-label=\"下一步的直接連結\" title=\"下一步的直接連結\">​</a></h2><p>現在我們已經完成了 semantic-release 的基本設定，透過 semantic-release 可以幫助我們省下不少的時間，<a href=\"https://pjchender.blogspot.com/2020/02/guide-npm-4semantic-release.html\" target=\"_blank\" rel=\"noopener noreferrer\">自動更新套件版號</a>、<a href=\"https://pjchender.blogspot.com/2020/02/npm-5semantic-release-npm.html\" target=\"_blank\" rel=\"noopener noreferrer\">自動發佈套件到 npm</a>，以及自動產生 CHANGELOG 檔等等...。在下一篇文章中，將會說明如何套用大家在 README 中常見各種標章（badge）：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/QcrIHoV.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>其中最重要的就是測試覆蓋率拉！就讓我們到下一篇中說明吧！</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"參考\">參考<a href=\"#參考\" class=\"hash-link\" aria-label=\"參考的直接連結\" title=\"參考的直接連結\">​</a></h2><ul><li><a href=\"https://semantic-release.gitbook.io/semantic-release/usage/plugins\" target=\"_blank\" rel=\"noopener noreferrer\">Plugins</a> @ semantic-release</li><li><a href=\"https://github.com/semantic-release/changelog\" target=\"_blank\" rel=\"noopener noreferrer\">@semantic-release/changelog</a> @ github</li><li><a href=\"https://github.com/semantic-release/git\" target=\"_blank\" rel=\"noopener noreferrer\">@semantic-release/git</a> @ github</li><li><a href=\"https://github.com/semantic-release/npm\" target=\"_blank\" rel=\"noopener noreferrer\">@semantic-release/npm</a> @ github</li><li><a href=\"https://github.com/semantic-release/semantic-release/issues/1092\" target=\"_blank\" rel=\"noopener noreferrer\">How to automatically pull changelog and git modules when issuing npx semantic-release?</a> @ Github Issues</li></ul></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（7）：Coveralls 的測試覆蓋率與 README 中的標章（code test coverage badge） pjchender.dev": {
    "prefix": "hdevops [Guide] 發佈 npm 套件 - 從手動到自動（7）：Coveralls 的測試覆蓋率與 README 中的標章（code test coverage badge） pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Guide] 發佈 npm 套件 - 從手動到自動（7）：Coveralls 的測試覆蓋率與 README 中的標章（code test coverage badge）</h1></header><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"keywords-deploy-publish-release-cli-npm-packagejson\">keywords: <code>deploy</code>, <code>publish</code>, <code>release</code>, <code>CLI</code>, <code>npm</code>, <code>package.json</code><a href=\"#keywords-deploy-publish-release-cli-npm-packagejson\" class=\"hash-link\" aria-label=\"keywords-deploy-publish-release-cli-npm-packagejson的直接連結\" title=\"keywords-deploy-publish-release-cli-npm-packagejson的直接連結\">​</a></h5><p><img loading=\"lazy\" src=\"../../../i.imgur.com/r3yUna8.png\" alt=\"Coverall\" class=\"img_ev3q\"></p><p>這篇將會是這個系列文章的最後一篇，到目前為止已經可以在「把專案推到 github 上」後，自動在 CI 上幫執行測試、打包專案、更新版號、建立 CHANGELOG、發佈到 npm、產生 commit 和在 Github 上產生 release tags。</p><p>最後一篇則要來說明 README 中常使用到的標章（badge）。先來看一些常見的標章，最後再說明如何產生相當重要的「程式碼測試覆蓋率（code test coverage）」標章吧！</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"在-readme-中加入常見的-badge\">在 README 中加入常見的 badge<a href=\"#在-readme-中加入常見的-badge\" class=\"hash-link\" aria-label=\"在 README 中加入常見的 badge的直接連結\" title=\"在 README 中加入常見的 badge的直接連結\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"travis-ci-的-badge\">Travis CI 的 badge<a href=\"#travis-ci-的-badge\" class=\"hash-link\" aria-label=\"Travis CI 的 badge的直接連結\" title=\"Travis CI 的 badge的直接連結\">​</a></h3><p><a href=\"https://travis-ci.com/pjchender/function-benchmarker\" target=\"_blank\" rel=\"noopener noreferrer\"><img loading=\"lazy\" src=\"https://badgen.net/travis/pjchender/function-benchmarker\" alt=\"Build status\" class=\"img_ev3q\"></a></p><p>一般 README 中的 badge 其實就是單純套用在 markdown 中的圖檔，而許多不同的服務會提供各自的 badge 讓大家使用，以 Travis CI 來說，在官網的文件 <a href=\"https://docs.travis-ci.com/user/status-images/\" target=\"_blank\" rel=\"noopener noreferrer\">Embedding Status Images</a> 即有說明套用的方式，只需點選 Travis CI 專案中的 badge 即會顯示嵌入 markdown 的寫法：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/NkD5OzQ.gif\" alt=\"Imgur\" class=\"img_ev3q\"></p><div class=\"language-md codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-md codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">[</span><span class=\"token url content\" style=\"color:rgb(221, 221, 221)\">![Build status</span><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">](</span><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">https://badgen.net/travis/pjchender/react-use-opentok</span><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">)</span><span class=\"token plain\">](https://travis-ci.com/pjchender/react-use-opentok)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"透過-shieldsio-取得各種不同-badge\">透過 shields.io 取得各種不同 badge<a href=\"#透過-shieldsio-取得各種不同-badge\" class=\"hash-link\" aria-label=\"透過 shields.io 取得各種不同 badge的直接連結\" title=\"透過 shields.io 取得各種不同 badge的直接連結\">​</a></h3><p><a href=\"https://www.npmjs.com/package/@pjchender/function-benchmarker\" target=\"_blank\" rel=\"noopener noreferrer\"><img loading=\"lazy\" src=\"https://img.shields.io/npm/v/@pjchender/function-benchmarker.svg\" alt=\"version\" class=\"img_ev3q\"></a></p><p>除了 Travis CI 的標章之外，在 <a href=\"https://shields.io/\" target=\"_blank\" rel=\"noopener noreferrer\">shields.io</a> 上也提供了很多不同的 badge 可以自己套用：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/8xF9Ned.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>其中像是 npm 上套件的版本：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/TOvNLwg.gif\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>只需在 <code>README.md</code> 中加入：</p><div class=\"language-md codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-md codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token title important punctuation\" style=\"color:rgb(199, 146, 234)\">#</span><span class=\"token title important\"> 記得要把連結改成自己的專案</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">[</span><span class=\"token url content\" style=\"color:rgb(221, 221, 221)\">![version</span><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">](</span><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">https://img.shields.io/npm/v/@pjchender/function-benchmarker.svg</span><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">)</span><span class=\"token plain\">](https://www.npmjs.com/package/@pjchender/function-benchmarker)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"透過-coveralls-產生測試覆蓋率標章code-test-coverage-badge\">透過 Coveralls 產生測試覆蓋率標章（code test coverage badge）<a href=\"#透過-coveralls-產生測試覆蓋率標章code-test-coverage-badge\" class=\"hash-link\" aria-label=\"透過 Coveralls 產生測試覆蓋率標章（code test coverage badge）的直接連結\" title=\"透過 Coveralls 產生測試覆蓋率標章（code test coverage badge）的直接連結\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"由-jest-檢視程式碼測試覆蓋率\">由 Jest 檢視程式碼測試覆蓋率<a href=\"#由-jest-檢視程式碼測試覆蓋率\" class=\"hash-link\" aria-label=\"由 Jest 檢視程式碼測試覆蓋率的直接連結\" title=\"由 Jest 檢視程式碼測試覆蓋率的直接連結\">​</a></h3><p>程式碼的測試覆蓋率標章（code test coverage badge）指的是在整個專案中有多少百分比的程式碼有撰寫對應的測試，以我們在 <a href=\"https://github.com/pjchender/function-benchmarker\" target=\"_blank\" rel=\"noopener noreferrer\">@pjchender/function-benchmarker</a> 中使用的 <a href=\"https://jestjs.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Jest</a> 來說，只要在 command line 執行：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> run </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">test</span><span class=\"token plain\"> -- --coverage</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>就會幫我們產生對應的測試覆蓋率結果：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/qFfLCxs.gif\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>但如果我們想要在 README 中產生測試覆蓋率的標章就沒這麼簡單了。一般來說同樣會需要一個第三方的服務幫我們執行測試，這個服務會再把測試執行的結果保存一份下來，接著就可以從這個第三方的服務取得 badge。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"透過-coveralls-保存測試結果並產生標章\">透過 Coveralls 保存測試結果並產生標章<a href=\"#透過-coveralls-保存測試結果並產生標章\" class=\"hash-link\" aria-label=\"透過 Coveralls 保存測試結果並產生標章的直接連結\" title=\"透過 Coveralls 保存測試結果並產生標章的直接連結\">​</a></h3><p><img loading=\"lazy\" src=\"../../../i.imgur.com/r3yUna8.png\" alt=\"Coverall\" class=\"img_ev3q\"></p><p>其中 <a href=\"https://coveralls.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Coveralls</a> 是相當常見用來執行測試的第三方服務，並且支援許多持續整合的服務。</p><p>因為整個流程有些繁瑣，先來簡單瞭解一下 Coverall 的流程和作用的時機點：</p><ol><li>先註冊 Coverall 的帳號，並與 Github 連動，選擇要加入 Coverall 中的 Github 專案</li><li>在專案中安裝 Coverall 的 npm 套件，並在專案的 <code>packages.json</code> 設定執行該套件的指令</li><li>在 Travis CI 的環境變數中需要先設定 Coverall 的 token，如此才能在 Travis CI 執行的過程中通知 Coverall 執行的結果</li><li>修改 <code>.travis.yml</code> 的檔案，讓它在持續整合的過程中可以去執行 <code>coveralls</code> 的指令</li><li>推上 Github 觸發 CI</li></ol><p>現在就讓我們一步一步開始吧！</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"註冊-coveralls-帳號\">註冊 Coveralls 帳號<a href=\"#註冊-coveralls-帳號\" class=\"hash-link\" aria-label=\"註冊 Coveralls 帳號的直接連結\" title=\"註冊 Coveralls 帳號的直接連結\">​</a></h4><p>要使用這個服務一樣需要先到 <a href=\"https://coveralls.io/\" target=\"_blank\" rel=\"noopener noreferrer\">Coveralls</a> 的官方網站註冊一個帳號，因為我們要和 Github 上的 repository 連動，所以可以選擇使用 Github 登入。</p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"與-github-連動並加入對應的-repository\">與 Github 連動並加入對應的 Repository<a href=\"#與-github-連動並加入對應的-repository\" class=\"hash-link\" aria-label=\"與 Github 連動並加入對應的 Repository的直接連結\" title=\"與 Github 連動並加入對應的 Repository的直接連結\">​</a></h4><p>接著在最左邊的地方可以看到「ADD REPOS」的加號：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/GLBbQHr.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>然後選擇想要加入 Coveralls 的 Github 專案，把它「打開（ON）」：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/cfKx3O0.gif\" alt=\"Imgur\" class=\"img_ev3q\"></p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"安裝-coveralls-的-npm-套件\">安裝 Coveralls 的 npm 套件<a href=\"#安裝-coveralls-的-npm-套件\" class=\"hash-link\" aria-label=\"安裝 Coveralls 的 npm 套件的直接連結\" title=\"安裝 Coveralls 的 npm 套件的直接連結\">​</a></h4><p>設定好之後要來把 Coveralls 的 <a href=\"https://www.npmjs.com/package/coveralls\" target=\"_blank\" rel=\"noopener noreferrer\">npm 套件</a> 安裝到專案中：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> i coveralls -D</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"在-packagejson-中建立對應的指令\">在 package.json 中建立對應的指令<a href=\"#在-packagejson-中建立對應的指令\" class=\"hash-link\" aria-label=\"在 package.json 中建立對應的指令的直接連結\" title=\"在 package.json 中建立對應的指令的直接連結\">​</a></h4><p>安裝好後，在 <code>package.json</code> 的 <code>script</code> 欄位中加入名為 <code>coveralls</code> 來讓它幫我們產生程式碼測試覆蓋率的資料：</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;scripts&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;coveralls&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;jest --coverage &amp;&amp; cat ./coverage/lcov.info | coveralls&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token property\">&quot;semantic-release&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;semantic-release&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"將-coveralls-的-token-設定到-travis-ci-上\">將 Coveralls 的 token 設定到 Travis CI 上<a href=\"#將-coveralls-的-token-設定到-travis-ci-上\" class=\"hash-link\" aria-label=\"將 Coveralls 的 token 設定到 Travis CI 上的直接連結\" title=\"將 Coveralls 的 token 設定到 Travis CI 上的直接連結\">​</a></h4><p>最後為了要讓 Travis CI 在執行 <code>coveralls</code> 指令的過程中，可以把執行的結果放到 Coveralls 的網站上，需要把 Coveralls 的 Token 設定到 Travis CI 上。</p><p>在 Coveralls 網站上，點入專案後即可看到 <code>repo token</code>：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/Gcr5fKQ.gif\" alt=\"Imgur\" class=\"img_ev3q\"></p><blockquote><p>⚠️ 備註：在這頁的說明中，會請你在專案中建立一支 <code>.coveralls.yml</code>，並放入對應的 <code>service_name</code> 和 <code>repo_token</code>，但這是當你的專案是 private（不公開）的情況下才能這麼做，否則你的 token 會被所有人看到，<strong>因此對於 open source 這類公開的專案，需要把 <code>repo_token</code> 直接設定在 CI 服務的環境變數中</strong>。</p></blockquote><p>把這個 Token 複製下來，回到 Travis CI 中專案的 「settings」 中，新增一個名為 <code>COVERALLS_REPO_TOKEN</code> 的環境變數，並把剛剛複製的 token 貼上：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/zImWZa3.gif\" alt=\"Imgur\" class=\"img_ev3q\"></p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"修改-travisyml\">修改 .travis.yml<a href=\"#修改-travisyml\" class=\"hash-link\" aria-label=\"修改 .travis.yml的直接連結\" title=\"修改 .travis.yml的直接連結\">​</a></h4><p>最後透過 <code>.travis.yml</code> 讓專案在持續整合的過程中，可以去執行剛剛在 <code>package.json</code> 中設定好的 <code>coveralls</code> 指令，在設定檔中多一個名為 <code>Produce Coverage</code> 的階段來執行 <code>npm run coveralls</code> 的指令：</p><div class=\"language-yml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># .travis.yml</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">include</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">stage</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Produce Coverage</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">node_js</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> node</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">script</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm run coveralls</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># Define the release stage that runs semantic-release</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># ...</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>變更的部分如下圖：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/kEWYs03.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"推上-github-觸發-ci-並檢視結果\">推上 Github 觸發 CI 並檢視結果<a href=\"#推上-github-觸發-ci-並檢視結果\" class=\"hash-link\" aria-label=\"推上 Github 觸發 CI 並檢視結果的直接連結\" title=\"推上 Github 觸發 CI 並檢視結果的直接連結\">​</a></h4><p>如此就大功告成了！讓我們推上 Github 觸發 coveralls 看看吧！</p><p>現在，在 Travis CI 上可以看到除了原本的 Release Stage 之外，多了一個 Produce coverage Stage，這是用來執行 coveralls 指令的：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/AamaXZs.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>執行完後，回到 Coveralls 的網站，點選專案進入後，將會看到程式碼的測試覆蓋率，並且有嵌入（EMBED）標章的地方：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/gHnLZrh.gif\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>以 @pjchender/function-benchmarker 這個專案來說，測試覆蓋率所使用的 badge 如下，只需把這段貼到 README.md 中就可以了：</p><div class=\"language-md codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-md codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">[</span><span class=\"token url content\" style=\"color:rgb(221, 221, 221)\">![Coverage Status</span><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">](</span><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">https://coveralls.io/repos/github/pjchender/function-benchmarker/badge.svg?branch=master</span><span class=\"token url\" style=\"color:rgb(221, 221, 221)\">)</span><span class=\"token plain\">](https://coveralls.io/github/pjchender/function-benchmarker?branch=master)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"範例專案\">範例專案<a href=\"#範例專案\" class=\"hash-link\" aria-label=\"範例專案的直接連結\" title=\"範例專案的直接連結\">​</a></h2><p>現在回到我們的專案中，就可以看到在這個 README 中已經有上面所加入的這些 badge 了：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/5Cc8NqK.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>這是這個系列文章的最後一篇，關於整個專案的程式碼和設定檔，都可以在 <a href=\"https://github.com/pjchender/function-benchmarker\" target=\"_blank\" rel=\"noopener noreferrer\">Github</a> 上的 <a href=\"https://github.com/pjchender/function-benchmarker\" target=\"_blank\" rel=\"noopener noreferrer\">pjchender/function-benchmarker</a> 上查看。</p><p>最後，感謝你的閱讀，若發現內容中有任何錯誤，都歡迎留言告知或到<a href=\"https://www.facebook.com/pjchender\" target=\"_blank\" rel=\"noopener noreferrer\">粉絲專頁</a>發送訊息告訴我。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"參考\">參考<a href=\"#參考\" class=\"hash-link\" aria-label=\"參考的直接連結\" title=\"參考的直接連結\">​</a></h2><ul><li><a href=\"https://docs.travis-ci.com/user/status-images/\" target=\"_blank\" rel=\"noopener noreferrer\">Embedding Status Images</a> @ Travis-CI</li></ul></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Deploy] Semantic Release 筆記 pjchender.dev": {
    "prefix": "hdevops [Deploy] Semantic Release 筆記 pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Deploy] Semantic Release 筆記</h1></header><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"keywords-deploy-publish-release-cli-ci\">keywords: <code>deploy</code>, <code>publish</code>, <code>release</code>, <code>CLI</code>, <code>CI</code><a href=\"#keywords-deploy-publish-release-cli-ci\" class=\"hash-link\" aria-label=\"keywords-deploy-publish-release-cli-ci的直接連結\" title=\"keywords-deploy-publish-release-cli-ci的直接連結\">​</a></h5><blockquote><p><a href=\"https://semantic-release.gitbook.io/semantic-release/\" target=\"_blank\" rel=\"noopener noreferrer\">Introduction</a> @ semantic-release gitbooks</p></blockquote><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 在 local 執行 dry-run</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token assign-left variable\" style=\"color:rgb(191, 199, 213)\">NPM_TOKEN</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">your_npm_token</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> </span><span class=\"token assign-left variable\" style=\"color:rgb(191, 199, 213)\">GH_TOKEN</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">your_github_token</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> npx semantic-release --no-ci --dry-run</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"注意事項\">注意事項<a href=\"#注意事項\" class=\"hash-link\" aria-label=\"注意事項的直接連結\" title=\"注意事項的直接連結\">​</a></h2><ul><li><strong>sematic-release</strong> 的設定檔 <code>.releaserc</code> 副檔名雖然可以是 <code>js</code>，但裡面還是得要使用 JSON 語法（<a href=\"https://semantic-release.gitbook.io/semantic-release/usage/configuration#configuration-file\" target=\"_blank\" rel=\"noopener noreferrer\">Configuration File</a>）。</li><li>在 Travis CI 上執行 semantic-release 時有可能會發生「Can not find modules」的錯誤，解決方式可參考下面「<!-- -->[在 Travis CI 上使用出現 Cannot find module 的問題]<!-- -->(#在 Travis CI 上使用出現 Cannot find module 的問題)」。</li></ul><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"概念\">概念<a href=\"#概念\" class=\"hash-link\" aria-label=\"概念的直接連結\" title=\"概念的直接連結\">​</a></h2><p><strong>目的</strong>：透過 <strong>semantic-release</strong> 可以自動化整個套件發佈的工作流程，包含決定 next version 的版號、產生 release notes 和發佈套件。<strong>semantic-release</strong> 使用 commit 的內容來決定專案版本變更的類型，並且自動產生<a href=\"https://semver.org/\" target=\"_blank\" rel=\"noopener noreferrer\">語易化版號</a>，產生 changelog 和發佈。</p><p><strong>撰寫 commit</strong>：預設著情況下 <strong>semantic-release</strong> 使用 <a href=\"https://github.com/angular/angular.js/blob/master/DEVELOPERS.md#-git-commit-guidelines\" target=\"_blank\" rel=\"noopener noreferrer\">Angular Commit Message Conventions</a> 來決定版號的變更，有需要的話，亦可透過 <a href=\"https://github.com/semantic-release/commit-analyzer#options\" target=\"_blank\" rel=\"noopener noreferrer\">@semantic-release/commit-analyzer</a> 和 <a href=\"https://github.com/semantic-release/release-notes-generator#options\" target=\"_blank\" rel=\"noopener noreferrer\">@semantic-release/release-notes-generator</a> 的 <a href=\"https://semantic-release.gitbook.io/semantic-release/usage/configuration#options\" target=\"_blank\" rel=\"noopener noreferrer\"><code>preset</code> 或 <code>config</code> 選項</a>來調整。</p><p><strong>格式化 commit 的工具</strong>：也可以使用像是 <a href=\"https://github.com/commitizen/cz-cli\" target=\"_blank\" rel=\"noopener noreferrer\">commitizen</a> 或 <a href=\"https://github.com/conventional-changelog/commitlint\" target=\"_blank\" rel=\"noopener noreferrer\">commitlint</a> 這類的工具來幫助開發者強制寫出合法有效的 commit messages。</p><p><strong>CI</strong>：semantic-release 是用來 CI 環境中，每次成功打包後執行。對於每一個透過 <code>git push</code> 或 merge PR 到 release branch（例如，<code>master</code>, <code>next</code>, <code>beta</code>）的 commit，CI 都會觸發打包和執行 <code>semantic-release</code> 指令以產生新的 <strong>release</strong>。</p><p><strong>步驟</strong>：在執行 <code>semantic-release</code> 的指令後，會執行<a href=\"https://semantic-release.gitbook.io/semantic-release/#release-steps\" target=\"_blank\" rel=\"noopener noreferrer\">這些步驟</a>。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"getting-started\">Getting Started<a href=\"#getting-started\" class=\"hash-link\" aria-label=\"Getting Started的直接連結\" title=\"Getting Started的直接連結\">​</a></h2><p>要使用 <strong>semantic-release</strong> 的話，需要依序完成下列步驟（這些流程多可以透過 <a href=\"https://github.com/semantic-release/cli\" target=\"_blank\" rel=\"noopener noreferrer\">semantic-release cli</a> 解決）：</p><ol><li><a href=\"https://semantic-release.gitbook.io/semantic-release/usage/installation\" target=\"_blank\" rel=\"noopener noreferrer\">安裝</a>：在專案中安裝 semantic-release</li><li><a href=\"https://semantic-release.gitbook.io/semantic-release/usage/ci-configuration\" target=\"_blank\" rel=\"noopener noreferrer\">設定 CI 服務</a>：設定 CI 服務（例如，Travis CI, Github Action）來執行 semantic-release</li><li><a href=\"https://semantic-release.gitbook.io/semantic-release/usage/ci-configuration#authentication\" target=\"_blank\" rel=\"noopener noreferrer\">設定 CI 權限</a>：在 CI 服務中設定 Github 和套件管理工具的<a href=\"https://semantic-release.gitbook.io/semantic-release/usage/ci-configuration#authentication\" target=\"_blank\" rel=\"noopener noreferrer\">權限</a></li><li><a href=\"https://semantic-release.gitbook.io/semantic-release/usage/configuration\" target=\"_blank\" rel=\"noopener noreferrer\">建立設定檔</a>：設定 semantic-release 的<a href=\"https://semantic-release.gitbook.io/semantic-release/usage/configuration#configuration\" target=\"_blank\" rel=\"noopener noreferrer\">外掛和選項</a>。</li></ol><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"plugin\">Plugin<a href=\"#plugin\" class=\"hash-link\" aria-label=\"Plugin的直接連結\" title=\"Plugin的直接連結\">​</a></h2><blockquote><p><a href=\"https://semantic-release.gitbook.io/semantic-release/usage/plugins\" target=\"_blank\" rel=\"noopener noreferrer\">Plugins</a> @ semantic-release</p></blockquote><p>預設就有的外掛包含：</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">&quot;@semantic-release/commit-analyzer&quot;</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">&quot;@semantic-release/github&quot;</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">&quot;@semantic-release/npm&quot;</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">&quot;@semantic-release/release-notes-generator&quot;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"自動產生-change_log-檔案\">自動產生 CHANGE_LOG 檔案<a href=\"#自動產生-change_log-檔案\" class=\"hash-link\" aria-label=\"自動產生 CHANGE_LOG 檔案的直接連結\" title=\"自動產生 CHANGE_LOG 檔案的直接連結\">​</a></h3><p>若有需要自動產生 CHANGE_LOG 檔案：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">install</span><span class=\"token plain\"> @semantic-release/git @semantic-release/changelog -D</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>設定檔如下：</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// .releaserc.json</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token literal-property property\">plugins</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;@semantic-release/commit-analyzer&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;@semantic-release/release-notes-generator&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;@semantic-release/changelog&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token literal-property property\">changelogFile</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;docs/CHANGELOG.md&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    &#x27;@semantic</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">-</span><span class=\"token plain\">release</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">/</span><span class=\"token plain\">npm</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;@semantic-release/git&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 寫在 assets 裡的內容可以在 CI 後被 commit 到 git repository 內</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 預設是 [&#x27;CHANGELOG.md&#x27;, &#x27;package.json&#x27;, &#x27;package-lock.json&#x27;, &#x27;npm-shrinkwrap.json&#x27;]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token literal-property property\">assets</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;docs/CHANGELOG.md&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"semantic-release-cli\">semantic-release CLI<a href=\"#semantic-release-cli\" class=\"hash-link\" aria-label=\"semantic-release CLI的直接連結\" title=\"semantic-release CLI的直接連結\">​</a></h2><blockquote><p><a href=\"https://github.com/semantic-release/cli\" target=\"_blank\" rel=\"noopener noreferrer\">semantic-release cli</a> @ github</p></blockquote><p>這個工具會自動產生 Github 和 NPM 上的 Token，如果使用的是 Travis CI 則會並自動設定到 Travis CI 上：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">cd</span><span class=\"token plain\"> your-module</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ npx semantic-release-cli setup</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"搭配-github-action-使用\">搭配 Github Action 使用<a href=\"#搭配-github-action-使用\" class=\"hash-link\" aria-label=\"搭配 Github Action 使用的直接連結\" title=\"搭配 Github Action 使用的直接連結\">​</a></h2><blockquote><p>可參考在 <a href=\"https://github.com/pjchender/eslint-config-pjchender\" target=\"_blank\" rel=\"noopener noreferrer\">eslint-config-pjchender</a> @ github 的設定</p></blockquote><div class=\"theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9\"><div class=\"admonitionHeading_tbUL\"><span class=\"admonitionIcon_kALy\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></span>備註</div><div class=\"admonitionContent_S0QG\"><p>最近（<code>2021-07</code>）在使用 semantic-release 是，執行 <code>npx semantic-release-cli setup</code> 的時候，Travis CI 一直驗證不過，於是改用 Github Action。</p></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"執行步驟\">執行步驟<a href=\"#執行步驟\" class=\"hash-link\" aria-label=\"執行步驟的直接連結\" title=\"執行步驟的直接連結\">​</a></h3><ol><li>安裝 semantic release</li></ol><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ npx semantic-release-cli setup</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># &gt; 輸入 npm 的帳號密碼</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># &gt; 選擇 CI 的方式為 Github Action</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ol start=\"2\"><li>到 <a href=\"https://www.npmjs.com/\" target=\"_blank\" rel=\"noopener noreferrer\">npm</a> Settings 中的 Access Tokens 產生一組 Token，並設定在 Github Repo 的 <a href=\"https://docs.github.com/en/actions/reference/environments\" target=\"_blank\" rel=\"noopener noreferrer\">Environment</a> 中，這裡把環境名稱（environment name）取做 <code>release</code>，npm 的 token 的環境變數（environment variable）則取做 <code>NPM_TOKEN</code>：</li></ol><p><img loading=\"lazy\" src=\"../../../i.imgur.com/2MFzzGA.gif\" alt=\"Create Environment for Github Action\" class=\"img_ev3q\"></p><ol start=\"3\"><li>建立 Github Action 的 Workflow 檔（可以參考官方提供的 <a href=\"https://github.com/semantic-release/semantic-release/blob/master/docs/recipes/github-actions.md\" target=\"_blank\" rel=\"noopener noreferrer\">設定檔範例</a>）<ul><li>記得要使用 <code>environment: release</code> 指定要套用的環境名稱</li></ul></li></ol><div class=\"language-yml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># .github/workflows/release.yml</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Release</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># push 到 main 分支時，會促發此 workflow</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">on</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">push</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">branches</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> main</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">release</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Release</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">environment</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> release </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 這裡要記得指定套用的環境，才能取得變數</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> ubuntu</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">latest</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">steps</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Checkout</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/checkout@v2</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">with</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token key atrule\">fetch-depth</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Setup Node.js</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">uses</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> actions/setup</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">node@v1</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">with</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token key atrule\">node-version</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">14</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Install dependencies</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">run</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm ci</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">name</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> Release</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">env</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token key atrule\">GITHUB_TOKEN</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> $</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"> secrets.GITHUB_TOKEN </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">          </span><span class=\"token key atrule\">NPM_TOKEN</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> $</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"> secrets.NPM_TOKEN </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">run</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npx semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ol start=\"4\"><li>建立 <code>.releaserc.json</code>，這是給 semantic-release 用的設定檔：<ul><li><code> &quot;branches&quot;: [&quot;main&quot;]</code>：指定 release branch 名稱，需與 Github Action 的 branches 對應</li><li><code>message</code>：修改 commit message 的內容，避免內容太長（如果有使用 commitlint 的話才需要加）</li></ul></li></ol><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token string-property property\">&quot;branches&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;main&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 指定 release branch 名稱</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token string-property property\">&quot;plugins&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/commit-analyzer&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/release-notes-generator&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/changelog&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/npm&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/git&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token string-property property\">&quot;message&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;chore(release): ${nextRelease.version} [skip ci]&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ol start=\"5\"><li>推上 Github 對應的 branch 即可。</li></ol><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"其他\">其他<a href=\"#其他\" class=\"hash-link\" aria-label=\"其他的直接連結\" title=\"其他的直接連結\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"authentication-建立給-semantic-release-用的-github-token\">authentication 建立給 semantic-release 用的 Github Token<a href=\"#authentication-建立給-semantic-release-用的-github-token\" class=\"hash-link\" aria-label=\"authentication 建立給 semantic-release 用的 Github Token的直接連結\" title=\"authentication 建立給 semantic-release 用的 Github Token的直接連結\">​</a></h3><p>使用 semantic-release 時需要建立帶有對應權限的 github personal token 和 npm token 給它</p><blockquote><ul><li><a href=\"https://github.com/semantic-release/semantic-release/blob/master/docs/usage/ci-configuration.md#authentication\" target=\"_blank\" rel=\"noopener noreferrer\">Authentication</a> @ semantic-release &gt; CI configuration</li><li><a href=\"https://help.github.com/en/github/authenticating-to-github/creating-a-personal-access-token-for-the-command-line\" target=\"_blank\" rel=\"noopener noreferrer\">在 Github 建立 personal token 的方式</a> @ Github Help</li><li><a href=\"https://docs.npmjs.com/creating-and-viewing-authentication-tokens\" target=\"_blank\" rel=\"noopener noreferrer\">Creating and viewing authentication tokens</a> @ npmjs docs</li></ul></blockquote><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"在-travis-ci-上使用出現-cannot-find-module-的問題\">在 Travis CI 上使用出現 Cannot find module 的問題<a href=\"#在-travis-ci-上使用出現-cannot-find-module-的問題\" class=\"hash-link\" aria-label=\"在 Travis CI 上使用出現 Cannot find module 的問題的直接連結\" title=\"在 Travis CI 上使用出現 Cannot find module 的問題的直接連結\">​</a></h3><blockquote><p><a href=\"https://github.com/semantic-release/semantic-release/issues/1092\" target=\"_blank\" rel=\"noopener noreferrer\">How to automatically pull changelog and git modules when issuing npx semantic-release?</a> @ Github Issues</p></blockquote><p>在 Travis CI 使用時若出現類似的錯誤訊息時：</p><div class=\"codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">Cannot find module &#x27;@semantic-release/changelog&#x27;</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">Cannot find module &#x27;@semantic-release/git&#x27;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>可以修改 <code>.travis.yaml</code> 的檔案，將 <code>script</code> 的地方改成：</p><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token key atrule\">script</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npx </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">p @semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release/changelog </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">p @semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release/git </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">p semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"參考設定檔\">參考設定檔<a href=\"#參考設定檔\" class=\"hash-link\" aria-label=\"參考設定檔的直接連結\" title=\"參考設定檔的直接連結\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"releaserc\">.releaserc<a href=\"#releaserc\" class=\"hash-link\" aria-label=\".releaserc的直接連結\" title=\".releaserc的直接連結\">​</a></h3><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// .releaserc.json</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;plugins&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/commit-analyzer&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/release-notes-generator&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/changelog&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/npm&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token property\">&quot;npmPublish&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:rgb(255, 88, 116)\">false</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 要不要發佈到 npm</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token property\">&quot;tarballDir&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;dist&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/git&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"travis\">Travis<a href=\"#travis\" class=\"hash-link\" aria-label=\"Travis的直接連結\" title=\"Travis的直接連結\">​</a></h3><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># .travis.yaml</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">language</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> node_js</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">node_js</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">12</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">include</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># Define the release stage that runs semantic-release</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">stage</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> release</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">node_js</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> lts/*</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">script</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm run build</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">deploy</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">provider</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> script</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">script</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npx </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">p @semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release/changelog </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">p @semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release/git </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">p semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">skip_cleanup</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token boolean important\" style=\"color:rgb(255, 88, 116)\">true</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 💡加上這句</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Deploy] Travis CI 筆記 pjchender.dev": {
    "prefix": "hdevops [Deploy] Travis CI 筆記 pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Deploy] Travis CI 筆記</h1></header><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"keywords-deploy-publish-release-ci-持續整合\">keywords: <code>deploy</code>, <code>publish</code>, <code>release</code>, <code>CI</code>, <code>持續整合</code><a href=\"#keywords-deploy-publish-release-ci-持續整合\" class=\"hash-link\" aria-label=\"keywords-deploy-publish-release-ci-持續整合的直接連結\" title=\"keywords-deploy-publish-release-ci-持續整合的直接連結\">​</a></h5><blockquote><p><a href=\"https://docs.travis-ci.com/user/for-beginners\" target=\"_blank\" rel=\"noopener noreferrer\">Core Concepts for Beginners</a> @ Travis CI Docs</p></blockquote><p>當你執行 build 時，Travis CI 會複製一份 Github 專案到全新的虛擬環境上，接著執行一系列的任務（task）來打包和測試你的程式碼，如果有任何的任務失敗的話，該 build 過程會被視為 <a href=\"https://docs.travis-ci.com/user/for-beginners#breaking-the-build\" target=\"_blank\" rel=\"noopener noreferrer\"><em>broken</em></a>；如果沒有任務失敗，則該 build 過程會被視為 <a href=\"https://docs.travis-ci.com/user/for-beginners#breaking-the-build\" target=\"_blank\" rel=\"noopener noreferrer\"><em>passed</em></a> ，Travis CI 會將你的程式碼進行部署（deploy）。</p><ul><li><strong>phase</strong>：在 job 中<a href=\"https://docs.travis-ci.com/user/job-lifecycle/\" target=\"_blank\" rel=\"noopener noreferrer\">一系列的執行步驟</a>，舉例來說包含 <code>install</code> phase、<code>script</code> phase，和 <code>deploy</code> phase。</li><li><strong>job</strong>：從複製專案到虛擬環境，並執行一系列 phases 的自動化歷程。如果 <code>script</code> phase 回傳的值不是 0 的話，job 則視為失敗。</li><li><strong>build</strong> ：一組一組的 jobs，舉例來說，一個 build 可能有兩個 jobs，分別測試不同版本的程式語言。當所有的 job 執行完成（finished）時，該 build 視為完成。</li><li><strong>stage</strong>：多組不同的 jobs 同時執行。</li></ul><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"job-的生命週期life-cycle\">Job 的生命週期（Life Cycle）<a href=\"#job-的生命週期life-cycle\" class=\"hash-link\" aria-label=\"Job 的生命週期（Life Cycle）的直接連結\" title=\"Job 的生命週期（Life Cycle）的直接連結\">​</a></h2><p>Travis CI 中的 job 主要由兩個部分組成：</p><ol><li><strong>install</strong>: install any dependencies required</li><li><strong>script</strong>: run the build script</li></ol><p>其中可介入的時間點分別為：</p><ol><li>OPTIONAL Install <a href=\"https://docs.travis-ci.com/user/installing-dependencies/#installing-packages-with-the-apt-addon\" target=\"_blank\" rel=\"noopener noreferrer\"><code>apt addons</code></a></li><li>OPTIONAL Install <a href=\"https://docs.travis-ci.com/user/caching\" target=\"_blank\" rel=\"noopener noreferrer\"><code>cache components</code></a></li><li><code>before_install</code></li><li><code>install</code></li><li><code>before_script</code></li><li><strong><code>script</code></strong></li><li>OPTIONAL <code>before_cache</code> (for cleaning up cache)</li><li><code>after_success</code> or <code>after_failure</code></li><li>OPTIONAL <code>before_deploy</code></li><li><strong>OPTIONAL <code>deploy</code></strong></li><li>OPTIONAL <code>after_deploy</code></li><li><code>after_script</code></li></ol><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"加密金鑰encryption-keys\">加密金鑰（encryption keys）<a href=\"#加密金鑰encryption-keys\" class=\"hash-link\" aria-label=\"加密金鑰（encryption keys）的直接連結\" title=\"加密金鑰（encryption keys）的直接連結\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"加密金鑰\">加密金鑰<a href=\"#加密金鑰\" class=\"hash-link\" aria-label=\"加密金鑰的直接連結\" title=\"加密金鑰的直接連結\">​</a></h3><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ gem </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">install</span><span class=\"token plain\"> travis</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ travis login --pro</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ travis encrypt </span><span class=\"token assign-left variable\" style=\"color:rgb(191, 199, 213)\">SOMEVAR</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;secretvalue&quot;</span><span class=\"token plain\"> --add -r OWNER/REPO</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"取得-public-key\">取得 public key<a href=\"#取得-public-key\" class=\"hash-link\" aria-label=\"取得 public key的直接連結\" title=\"取得 public key的直接連結\">​</a></h3><p>透過 <code>travis</code> 工具取得 public key</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ travis pubkey -r OWNER/PROJECT</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>在帳戶頁可以取得用來發送 API 的 Token：</p><ul><li><a href=\"https://travis-ci.org/account/preferences\" target=\"_blank\" rel=\"noopener noreferrer\">travis-ci.org</a></li><li><a href=\"https://travis-ci.com/account/preferences\" target=\"_blank\" rel=\"noopener noreferrer\">travis-ci.com</a></li></ul><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># travis-ci.com API v3</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">curl</span><span class=\"token plain\"> -H </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;Authorization: token &lt;TOKEN&gt;&quot;</span><span class=\"token plain\"> https://api.travis-ci.com/v3/repo/</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">OWNER</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\">%2f</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">REPO</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\">/key_pair/generated</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># travis-ci.org API v3</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">curl</span><span class=\"token plain\"> -H </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;Authorization: token &lt;TOKEN&gt;&quot;</span><span class=\"token plain\"> https://api.travis-ci.org/v3/repo/</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">OWNER</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\">%2f</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">REPO</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\">/key_pair/generated</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"其他\">其他<a href=\"#其他\" class=\"hash-link\" aria-label=\"其他的直接連結\" title=\"其他的直接連結\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"避免清除掉-build-好後-dist-資料夾內的檔案\">避免清除掉 build 好後 dist 資料夾內的檔案<a href=\"#避免清除掉-build-好後-dist-資料夾內的檔案\" class=\"hash-link\" aria-label=\"避免清除掉 build 好後 dist 資料夾內的檔案的直接連結\" title=\"避免清除掉 build 好後 dist 資料夾內的檔案的直接連結\">​</a></h3><blockquote><p><a href=\"https://docs.travis-ci.com/user/deployment#uploading-files-and-skip_cleanup\" target=\"_blank\" rel=\"noopener noreferrer\">Uploading Files and skip_cleanup</a> @ Travis-CI Docs</p></blockquote><p>在 Travis CI 中，預設會把 build 好的檔案給清除，可以在 <code>deploy</code> 的階段加上 <code>skip_cleanup: false</code> 的參數：</p><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># .travis.yml</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">include</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">stage</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> release</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">node_js</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> lts/*</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">script</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm run build</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">deploy</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">provider</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> script</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">script</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npx </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">p @semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release/changelog </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">p @semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release/git </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">p semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">skip_cleanup</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token boolean important\" style=\"color:rgb(255, 88, 116)\">true</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 💡加上這句</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><blockquote><p>⚠️ 現在雖然有提到 <code>skip_cleanup</code> 已經 deprecated 了，但這是在 deployment API v2 後，因此現在仍然要加上，參考 <a href=\"https://travis-ci.community/t/skip-cleanup-true-is-now-deprecated-how-to-go-for-gradle-publish/6641\" target=\"_blank\" rel=\"noopener noreferrer\">Skip_cleanup: true is now deprecated. How to go for gradle publish?</a>。</p></blockquote></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Deploy] 整合 semantic-release 和 travis-ci 自動化部屬 pjchender.dev": {
    "prefix": "hdevops [Deploy] 整合 semantic-release 和 travis-ci 自動化部屬 pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Deploy] 整合 semantic-release 和 travis-ci 自動化部屬</h1></header><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"keywords-deploy-publish-release-cli-ci-semantic-release-changelog\">keywords: <code>deploy</code>, <code>publish</code>, <code>release</code>, <code>CLI</code>, <code>CI</code>, <code>semantic-release</code>, <code>changelog</code><a href=\"#keywords-deploy-publish-release-cli-ci-semantic-release-changelog\" class=\"hash-link\" aria-label=\"keywords-deploy-publish-release-cli-ci-semantic-release-changelog的直接連結\" title=\"keywords-deploy-publish-release-cli-ci-semantic-release-changelog的直接連結\">​</a></h5><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"step\">STEP<a href=\"#step\" class=\"hash-link\" aria-label=\"STEP的直接連結\" title=\"STEP的直接連結\">​</a></h2><ol><li>讓 Travis CI 擁有 Github Repository 的存取權限 @ <a href=\"https://github.com/settings/installations\" target=\"_blank\" rel=\"noopener noreferrer\">Github App Installation</a></li><li>安裝 <a href=\"https://github.com/semantic-release/cli\" target=\"_blank\" rel=\"noopener noreferrer\">semantic-release CLI</a></li><li>透過 semantic-release CLI 執行設置</li></ol><div class=\"language-sh codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sh codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># 進到專案後</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ semantic-release-cli setup</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ul><li>3.1. 輸入 npm 和 github 帳號</li><li>3-2. 選擇 CI 來源，這裡如果是專案是在 <code>travis-ci.com</code> 的話則選擇 <code>Travis CI Pro</code>；如果是 <code>travis-ci.org</code> 則選擇 <code>Travis CI</code></li><li>3-3. 執行完成後，semantic-release 會幫我們分別在 Github 和 NPM 上產生對應的 Token，並設定在 Travis CI 的專案的設定（settings）的環境變數（Environment Variables）中。</li></ul><ol start=\"4\"><li>安裝 <code>@semantic-release/changelog</code> 和 <code>@semantic-release/git</code></li></ol><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># @semantic-release/changelog 用來產生 changelog 的檔案</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># @semantic-release/git 用來將產生的 changelog 檔案新增到 git 中</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">npm</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">install</span><span class=\"token plain\"> @semantic-release/changelog @semantic-release/git -D</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ol start=\"5\"><li>在根目錄建立 <code>.travis.yml</code></li></ol><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># .travis.yml</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">language</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> node_js</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">node_js</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">12</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">include</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token key atrule\">stage</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> release</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">node_js</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> lts/*</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">script</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npm run build</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token key atrule\">deploy</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">provider</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> script</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">script</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> npx </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">p @semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release/changelog </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">p @semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release/git </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">p semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release semantic</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\">release</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token key atrule\">skip_cleanup</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token boolean important\" style=\"color:rgb(255, 88, 116)\">true</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 若需要在 travis 上執行 build 後才發到 npm 上則要保留這行</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><blockquote><p>⚠️ 檔名一定要是 <code>.travis.yml</code> 才會觸發 Travis CI 執行。<code>.travis.yaml</code> 是不可以的！</p></blockquote><ol start=\"6\"><li>建立 <code>.releaserc.json</code></li></ol><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// .releaserc.json</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;plugins&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/commit-analyzer&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/release-notes-generator&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/changelog&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/npm&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">        </span><span class=\"token property\">&quot;npmPublish&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token boolean\" style=\"color:rgb(255, 88, 116)\">true</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 若想要發佈到 npm 則設為 true</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/git&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>若不需要發佈到 npm 只需要 changelog 的檔案則可參考：</p><div class=\"language-json codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-json codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// .releaserc.json</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token property\">&quot;plugins&quot;</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/commit-analyzer&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/release-notes-generator&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/changelog&quot;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&quot;@semantic-release/git&quot;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Note] Docker and Kubernetes: The Complete Guide @ Udemy 學習筆記 pjchender.dev": {
    "prefix": "hdevops [Note] Docker and Kubernetes: The Complete Guide @ Udemy 學習筆記 pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Note] Docker and Kubernetes: The Complete Guide @ Udemy 學習筆記</h1></header><blockquote><p>此篇為筆記之整理，非原創內容，資料來源主要來自：<a href=\"https://www.udemy.com/course/docker-and-kubernetes-the-complete-guide/learn/lecture/16242264#overview\" target=\"_blank\" rel=\"noopener noreferrer\">Docker and Kubernetes: The Complete Guide</a> @ Udemy</p></blockquote><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"重要概念\">重要概念<a href=\"#重要概念\" class=\"hash-link\" aria-label=\"重要概念的直接連結\" title=\"重要概念的直接連結\">​</a></h2><ul><li>Image（映像檔）：有所有執行程式時所需要相依的內容、設定、指令和執行檔。當在執行 container 時，它會使用一個獨立的檔案系統，而這個檔案系統即是透過 image 來提供。</li><li>Container（容器）：image 的 instance，真正執行的程式，它是獨立於本機所有 process 以外的一個 process。Container 包含了 image 中的 FS snapshot 和 Startup Command。</li><li>Docker Client（Docker CLI）：輸入 docker 指令的地方，可以透過安裝 Docker Desktop 取得</li><li>Docker Server（daemon）：建立映像檔、執行容器的地方</li></ul><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"kernel-和-container\">Kernel 和 Container<a href=\"#kernel-和-container\" class=\"hash-link\" aria-label=\"Kernel 和 Container的直接連結\" title=\"Kernel 和 Container的直接連結\">​</a></h3><p>Kernel 介於硬體和軟體的中間，當應用程式在執行時，會透過 system call 告知 kernel 要執行的項目（例如，寫檔），kernel 收到指令後會再對硬體進行操作：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/cLXMwN1.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><ul><li><strong>name spacing</strong>：可以將單一 process（或 group of processes）使用到的資源加以隔離</li><li><strong>control groups(cgroups)</strong>：可以限制每個 process 可以使用到的資源量多寡（例如，memory 的大小、CPU 的效能）</li></ul><p><img loading=\"lazy\" src=\"../../../i.imgur.com/h1TJLls.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><p>Container 的概念就如同下圖中紅色框線的位置：</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/66MPUiA.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"image-和-container\">Image 和 Container<a href=\"#image-和-container\" class=\"hash-link\" aria-label=\"Image 和 Container的直接連結\" title=\"Image 和 Container的直接連結\">​</a></h3><ul><li>image 會在 container 中執行</li><li><strong>當我們在講 image 的時候，實際上包含了一個「檔案系統的快照（FS Snapshot）」和「啟動他的指令（Startup Command）」</strong></li><li>當一個 image 要在 container 中執行時，會把 image 中對應的 FS Snapshot 和 Startup Command 放一份到 container 中加以執行</li></ul><p><img loading=\"lazy\" src=\"../../../i.imgur.com/JtsHaJ3.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-life-cyclestatus-of-container\">Docker Life Cycle（Status of Container）<a href=\"#docker-life-cyclestatus-of-container\" class=\"hash-link\" aria-label=\"Docker Life Cycle（Status of Container）的直接連結\" title=\"Docker Life Cycle（Status of Container）的直接連結\">​</a></h2><ul><li>created</li><li>up（表示在執行中）</li><li>exited</li></ul><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"建立-image\">建立 Image<a href=\"#建立-image\" class=\"hash-link\" aria-label=\"建立 Image的直接連結\" title=\"建立 Image的直接連結\">​</a></h2><p>Dockerfile 建立的流程如下：</p><ol><li>選定一個現有的 image 當作 base image</li><li>執行一些指令來安裝其他的程式</li><li>定義一些指令來啟動該 container</li></ol><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"建立-dockerfile\">建立 Dockerfile<a href=\"#建立-dockerfile\" class=\"hash-link\" aria-label=\"建立 Dockerfile的直接連結\" title=\"建立 Dockerfile的直接連結\">​</a></h3><blockquote><p><a href=\"https://www.udemy.com/course/docker-and-kubernetes-the-complete-guide/learn/lecture/11436706\" target=\"_blank\" rel=\"noopener noreferrer\">The Build Process in Detail</a> @ Docker and Kubernetes: The Complete Guide @ Udemy</p></blockquote><p>Dockerfile 的內容就像是告訴一台沒有內建 OS 的電腦，要如何重零開始把應用程式安裝進去。</p><div class=\"language-dockerfile codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-dockerfile codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># Dockerfile</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># Use an existing docker image as a base</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">FROM alpine</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># Download and install a dependency</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">RUN apk add --update redis</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># Tell the image what to do when it starts as a container</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">CMD [&quot;redis-server&quot;]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ul><li>我們之所以要安裝 OS，是因為它通常內建了我們所需要的程式，這裡使用 <code>alpine</code> 是因為它有內建 <code>apk</code> 的指令，方便我們安裝所需的套件</li></ul><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-build建立-image\">docker build：建立 image<a href=\"#docker-build建立-image\" class=\"hash-link\" aria-label=\"docker build：建立 image的直接連結\" title=\"docker build：建立 image的直接連結\">​</a></h3><p>在建立好 Dockerfile 後，可以執行 <code>docker build</code> 指令：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 建立好 Docker file 後</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> build </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">.</span><span class=\"token plain\">                     </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 執行建立好的 Dockerfile 後，會得到 image 的 id</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run b9124cbfdc30  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 透過 docker run 可以執行</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><code>docker build</code> 會做以下行為：</p><ul><li>每一個 Step 都會啟動一個 container 執行對應的行為，完成後會把它存成一個暫時的 image。</li><li>接著，在下一個 Step 開始時，會去使用上一個 Step 留下的 Image，並以此再次啟動一個 Container，執行該 Step 對應的指令，該指令執行完後，同樣的會再把最終完成的結果存在一個 Image，以這樣的流程重複完成每個 Step。</li><li>待所有 Step 都執行完後，最終會有一個 Image 可以讓使用者執行 <code>docker run &lt;image-id&gt;</code></li></ul><p>一般我們在使用別人的 image 時，是根據 image 來建立對應的 container，但<strong>當我們要透過 Dockerfile 來建立 image 時，則是根據 container 來產生出 image</strong>。也就是說，逐步執行這個 Dockerfile 的過程會像是下面這樣（通常不會這麼做，單純示範用）：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 從 container 建立一個 image</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run -it alpine </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">sh</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ / apk </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">add</span><span class=\"token plain\"> --update redis</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 開啟另一個 Terminal</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> commit -c </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;CMD [&quot;redis-server&quot;]&#x27;</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-id</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 會回傳 image-id</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">image-id</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"tagging-a-image幫-image-加上-tag\">tagging a image：幫 image 加上 tag<a href=\"#tagging-a-image幫-image-加上-tag\" class=\"hash-link\" aria-label=\"tagging a image：幫 image 加上 tag的直接連結\" title=\"tagging a image：幫 image 加上 tag的直接連結\">​</a></h3><p>每次都要輸入 image-id 非常麻煩，透過 image tag 可以為 image 建立標籤。慣例來說，標籤的命名會是 <code>dockerId/projectName:version</code>，例如 <code>pjchender/redis:latest</code>：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># tagging docker image</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># docker build -t &lt;tag-name&gt; .</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> build -t pjchender/redis-server:latest </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run pjchender/redis-server    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 預設會使用 latest version</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><blockquote><p>這整個為 image 建立標籤的流程稱作 tagging a image，但就技術上來說，只有標籤名稱最後的版本號是真正的 tag，前面單純只是 dockerId 和 projectName。</p></blockquote><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"rebuild-with-cache\">Rebuild with cache<a href=\"#rebuild-with-cache\" class=\"hash-link\" aria-label=\"Rebuild with cache的直接連結\" title=\"Rebuild with cache的直接連結\">​</a></h3><ul><li>每一次 Dockerfile 被執行後，Docker 都會將該次執行的內容快取下來，只要 Dockerfile 沒有改變（添加或變更順序），下次重複執行 <code>docker build</code> 指令時，會直接取用 cache 中的內容，在終端機中會看到 <em>Using Cache</em> 的說明文字。</li></ul><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"dockerize-an-nodejs-app\">Dockerize an Node.js App<a href=\"#dockerize-an-nodejs-app\" class=\"hash-link\" aria-label=\"Dockerize an Node.js App的直接連結\" title=\"Dockerize an Node.js App的直接連結\">​</a></h2><p>將 App Dockerize 的過程包含以下步驟：</p><ol><li>建立 Node JS Web App</li><li>建立 Dockerfile</li><li>根據 Dockerfile 來 build image</li><li>將 image 以 container 方式執行</li><li>從瀏覽器連到該 Web App</li></ol><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"1-建立-app\">1. 建立 App<a href=\"#1-建立-app\" class=\"hash-link\" aria-label=\"1. 建立 App的直接連結\" title=\"1. 建立 App的直接連結\">​</a></h3><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> express </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">require</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;express&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> app </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">express</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">app</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">get</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;/&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token parameter\">req</span><span class=\"token parameter punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token parameter\"> res</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:rgb(137, 221, 255)\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  res</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">send</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;Hi there&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">app</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">listen</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">8080</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token plain\"> </span><span class=\"token arrow operator\" style=\"color:rgb(137, 221, 255)\">=&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token console class-name\" style=\"color:rgb(255, 203, 107)\">console</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">log</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;Listening on port 8080&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"2-建立-dockerfile\">2. 建立 Dockerfile<a href=\"#2-建立-dockerfile\" class=\"hash-link\" aria-label=\"2. 建立 Dockerfile的直接連結\" title=\"2. 建立 Dockerfile的直接連結\">​</a></h3><ul><li><code>COPY &lt;local-machine&gt; &lt;container-drive&gt;</code><ul><li>local-machine 的路徑是相對於 build context，也就是 <code>docker build .</code>，後面的這個 <code>.</code> 就是 build context</li></ul></li><li>其中 <code>COPY ./ ./</code> 的目的是要把專案資料夾中的所有檔案都複製一份到 docker container 的根目錄（root directory）</li><li>由於只使用 <code>COPY ././</code> 會把本機專案的所有檔案都複製到 container FS 的根目錄中，這麼做並不是很好，因此可以使用 <code>WORKDIR &lt;path&gt;</code> 這個指令來指定工作目錄，如此，所有後續的指令都會在這個工作資料夾中被執行</li></ul><div class=\"language-dockerfile codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-dockerfile codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># Specify a base image</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">FROM node:alpine</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># 定義 container 中的工作資料夾</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">WORKDIR /usr/app</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># 將本機資料夾的檔案複製到工作資料夾中</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">COPY ./ ./  # COPY ./local ./container</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># Install some dependencies</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">RUN npm install</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># Default command</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">CMD [&quot;npm&quot;, &quot;start&quot;]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>這樣的寫法有一個問題，因為 Dockerfile 會由上往下執行，如果沒有改變就直接拿 cache，但若其中一行對應的內容有改變，則該行後的所有指令都會被迫重新執行，因此可以盡可能把容易改變的那行抽成獨立的指令，放到 Dockerfile 的越後面越好。</p><p>舉例來說，在原本的 Dockerfile 中，每次只要專案的中任何檔案（例如，<code>index.js</code>）有變更時，就算套件（即<code>package.json</code> 的內容沒有改變）沒有變更，都會重新執行一次 <code>npm install</code>。因為使用的是 <code>COPY ./ ./</code>，Docker 會發現 <code>index.js</code> 有改變而重新執行一次該行及其後續的指令。</p><p>因此，可以改成只有在 <code>package.json</code> 的檔案有變更時，再執行 <code>npm install</code> 這個指令，就可以減少很多不必要的重 build 而直接使用 cache。把 Dockerfile 改成：</p><div class=\"language-dockerfile codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-dockerfile codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># Specify a base image</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">FROM node:alpine</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># 定義 container 中的工作資料夾</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">WORKDIR /usr/app</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># 先將 package.json 複製到 container 的工作資料夾中</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># 只有當 package.json 有改變時，才會執行 npm install 的指令</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">COPY ./package.json ./</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">RUN npm install</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># 將本機資料夾的檔案複製到工作資料夾中</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">COPY ./ ./</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"># Default command</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">CMD [&quot;npm&quot;, &quot;start&quot;]</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"3-根據-dockerfile-來-build-image\">3. 根據 Dockerfile 來 build image<a href=\"#3-根據-dockerfile-來-build-image\" class=\"hash-link\" aria-label=\"3. 根據 Dockerfile 來 build image的直接連結\" title=\"3. 根據 Dockerfile 來 build image的直接連結\">​</a></h3><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># -t 表示為該 image 建立 tag</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> build -t pjchender/docker-node-sandbox </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">.</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"4-將-image-以-container-方式執行\">4. 將 image 以 container 方式執行<a href=\"#4-將-image-以-container-方式執行\" class=\"hash-link\" aria-label=\"4. 將 image 以 container 方式執行的直接連結\" title=\"4. 將 image 以 container 方式執行的直接連結\">​</a></h3><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run pjchender/docker-node-sandbox</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"5-從瀏覽器連進該-web-app\">5. 從瀏覽器連進該 Web App<a href=\"#5-從瀏覽器連進該-web-app\" class=\"hash-link\" aria-label=\"5. 從瀏覽器連進該 Web App的直接連結\" title=\"5. 從瀏覽器連進該 Web App的直接連結\">​</a></h3><ul><li>透過 port mapping 的方式將 localhost 的 port 和 container 的 port 相對應</li></ul><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># docker run with port mapping</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># -p [localhost-port]:[container-port]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run -p </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">8080</span><span class=\"token plain\">:8080 </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">image-id</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 在本機瀏覽器輸入 localhost:5000 將會連到 container 的 8080 port</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run -p </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">5000</span><span class=\"token plain\">:8080 pjchender/docker-node-sandbox</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>當 container 已經在執行時，希望能夠對同一個 container 執行某一些指令時，可以使用 <code>docker exec</code> 的指令：</p><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">exec</span><span class=\"token plain\"> -t </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-id</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">sh</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-compose-cli\">Docker Compose CLI<a href=\"#docker-compose-cli\" class=\"hash-link\" aria-label=\"Docker Compose CLI的直接連結\" title=\"Docker Compose CLI的直接連結\">​</a></h2><blockquote><p><a href=\"https://gist.github.com/pjchender/b08bd8e83c9ad4780e89580388072125\" target=\"_blank\" rel=\"noopener noreferrer\">sample code</a> @ pjchender gist</p></blockquote><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"為什麼需要使用-docker-compose\">為什麼需要使用 docker compose<a href=\"#為什麼需要使用-docker-compose\" class=\"hash-link\" aria-label=\"為什麼需要使用 docker compose的直接連結\" title=\"為什麼需要使用 docker compose的直接連結\">​</a></h3><ul><li>雖然可以把 Database Server 和 Web App Server 放在同一個 Docker Container 中，但這並不是個好的作法，因為在未來流量變大，需要啟動多個 Web Server Container 來處理時，因為 Database 是包在和 web server 同一個 container 內，因此每個 Container 間的 Database 都會是獨立的，等同於有多個獨立的 database。</li><li>這種情境比較適合把 database 獨立在另一個 container 中，不要和 web app 的 container 放在一起，並透過 docker compose 來管理多個 container 間的網路溝通。</li></ul><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-compose-cli-是什麼\">Docker Compose CLI 是什麼<a href=\"#docker-compose-cli-是什麼\" class=\"hash-link\" aria-label=\"Docker Compose CLI 是什麼的直接連結\" title=\"Docker Compose CLI 是什麼的直接連結\">​</a></h3><ul><li>Docker Compose CLI 和 Docker CLI 是獨立不同的工具，但在安裝 docker client 時會一併安裝。</li><li>它可以用來簡化每次都需要在 terminal 中透過 Docker CLI 輸入許多指令的困擾（類似 docker CLI 的 script）</li><li>它可以用來一次啟動多個 Docker Container</li><li>它可以設定各個 container 間的網路溝通</li></ul><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"建立-docker-compose-file\">建立 docker compose file<a href=\"#建立-docker-compose-file\" class=\"hash-link\" aria-label=\"建立 docker compose file的直接連結\" title=\"建立 docker compose file的直接連結\">​</a></h3><ul><li>docker compose file 內定義的 services 不需要額外設定，預設就會在同一個 network 內，彼此就能溝通</li></ul><div class=\"language-yaml codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-yaml codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 定義 docker-compose 使用的版本</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">version</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;3&#x27;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 定義兩個 services，一個是 redis-server，另一個是 node-app</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 這兩個 services 不需要額外設定，預設就會在同一個 network 內，彼此就能溝通</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token key atrule\">services</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">redis-server</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">image</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;redis&#x27;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token key atrule\">node-app</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">build</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"> . </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 根據當前根目錄的 Dockerfile 執行 build</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">    </span><span class=\"token key atrule\">ports</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">:</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">      </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">-</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;8081:8081&#x27;</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 將 local 的 8081 對應到 container 內的 8081</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>要讓 node-app 知道如何連線到 redis server，需要在 node-app 與 redis 建立連線的地方使用 docker-compose 中定義的 server 名稱：</p><div class=\"language-js codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-js codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// index.js</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// ...</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"font-style:italic\">const</span><span class=\"token plain\"> client </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\"> redis</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">.</span><span class=\"token method function property-access\" style=\"color:rgb(130, 170, 255)\">createClient</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">(</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">{</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token literal-property property\">host</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;redis-server&#x27;</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">// 原本可能會填的是 localhost:6379，現在要用 service 的名稱</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">  </span><span class=\"token literal-property property\">port</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">6379</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">}</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">)</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"使用-docker-compose-cli\">使用 docker compose CLI<a href=\"#使用-docker-compose-cli\" class=\"hash-link\" aria-label=\"使用 docker compose CLI的直接連結\" title=\"使用 docker compose CLI的直接連結\">​</a></h3><ul><li><code>docker-compose up</code> 後面可以不用加路徑，會直接去吃 <code>docker-compose.yml</code> 檔案</li><li>如果需要根據 Dockerfile rebuild 新的 image 時，可以在最後加上 <code>--build</code></li></ul><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># docker-compose 的指令需要在有 docker-compose.yml 的資料夾中執行</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker-compose</span><span class=\"token plain\"> up                         </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 對應到類似 docker run &lt;image-id&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker-compose</span><span class=\"token plain\"> up --build         </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 對應到 docker build . 和 docker run &lt;image-id&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker-compose</span><span class=\"token plain\"> up -d          </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 在背景執行</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker-compose</span><span class=\"token plain\"> down</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker-compose</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ps</span><span class=\"token plain\">              </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 列出該 docker-compose 中有哪些 services 在執行</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"自動重新啟動-container\">自動重新啟動 container<a href=\"#自動重新啟動-container\" class=\"hash-link\" aria-label=\"自動重新啟動 container的直接連結\" title=\"自動重新啟動 container的直接連結\">​</a></h3><p>重新啟動的策略包含：</p><ul><li><code>&quot;no&quot;</code>：不要嘗試重新啟動，使用 <code>no</code> 要加上引號，讓它知道是字串</li><li><code>always</code>：總是嘗試重新啟動，適合用在 Web Server</li><li><code>on-failure</code>：只有在 container 停止且有 error code 時才重新啟動（以 Node.js 來說，就是 exit 內的 code 是 0 以外的代碼），也就是程式正確終止時，不用重新啟動，適合用在 worker</li><li><code>unless-stopped</code>：除非是開發者強制停止它，否則總是重新啟動</li></ul><div class=\"language-diff codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-diff codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">...</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">services:</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token unchanged prefix unchanged\"> </span><span class=\"token unchanged line\"> redis-server:</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token unchanged line\"></span><span class=\"token unchanged prefix unchanged\"> </span><span class=\"token unchanged line\">   image: &#x27;redis&#x27;</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token unchanged line\"></span><span class=\"token unchanged prefix unchanged\"> </span><span class=\"token unchanged line\"> node-app:</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token unchanged line\"></span><span class=\"token inserted-sign inserted prefix inserted\" style=\"color:rgb(195, 232, 141)\">+</span><span class=\"token inserted-sign inserted line\" style=\"color:rgb(195, 232, 141)\">    restart: always</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token inserted-sign inserted line\" style=\"color:rgb(195, 232, 141)\"></span><span class=\"token unchanged prefix unchanged\"> </span><span class=\"token unchanged line\">   build: . # 根據當前根目錄的 Dockerfile 執行 build</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token unchanged line\"></span><span class=\"token unchanged prefix unchanged\"> </span><span class=\"token unchanged line\">   ports:</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token unchanged line\"></span><span class=\"token unchanged prefix unchanged\"> </span><span class=\"token unchanged line\">     - &#x27;8081:8081&#x27; # 將 local 的 8081 對應到 container 內的 8081</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"課程資源\">課程資源<a href=\"#課程資源\" class=\"hash-link\" aria-label=\"課程資源的直接連結\" title=\"課程資源的直接連結\">​</a></h2><ul><li><a href=\"https://github.com/StephenGrider/DockerCasts/tree/master/diagrams\" target=\"_blank\" rel=\"noopener noreferrer\">Diagrams</a></li><li><a href=\"https://github.com/StephenGrider/DockerCasts\" target=\"_blank\" rel=\"noopener noreferrer\">Repository</a></li></ul></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Docker] Command Line, CLI pjchender.dev": {
    "prefix": "hdevops [Docker] Command Line, CLI pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Docker] Command Line, CLI</h1></header><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"keywords-tutorial-cli\">keywords: <code>tutorial</code>, <code>cli</code><a href=\"#keywords-tutorial-cli\" class=\"hash-link\" aria-label=\"keywords-tutorial-cli的直接連結\" title=\"keywords-tutorial-cli的直接連結\">​</a></h5><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> version  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 確認 docker client 可以和 server engine 溝通</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> info     </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 檢視和 docker engine 有關的設定檔</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"tlsc\">TL;SC<a href=\"#tlsc\" class=\"hash-link\" aria-label=\"TL;SC的直接連結\" title=\"TL;SC的直接連結\">​</a></h2><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ps</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\">--all</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run -it </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\">image-id</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 根據 image 建立並執行 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run -p </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">8080</span><span class=\"token plain\">:8080 </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">image-id</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># port mapping localhost port:container port</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run -d redis         </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 讓該 container 在背景執行</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 希望能夠對某個執行中的 container 輸入一些指令</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">exec</span><span class=\"token plain\"> -it </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-id</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">sh</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> start </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\">container-id</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\">  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 執行已經建立過的某個 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> stop </span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">[</span><span class=\"token plain\">container-id</span><span class=\"token punctuation\" style=\"color:rgb(199, 146, 234)\">]</span><span class=\"token plain\">   </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 停止某個執行中的 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> system prune </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 把所有 docker 中當前沒用到的 container 清空</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 將 container 包成 image</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> build -t pjchender/project_name </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">##</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># docker compose</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">##</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker-compose</span><span class=\"token plain\"> up --build   </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 對應到 docker build . 和 docker run &lt;image-id&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker-compose</span><span class=\"token plain\"> up -d          </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 對應到類似 docker run &lt;image-id&gt;，-d 是在背景執行</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker-compose</span><span class=\"token plain\"> down</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker-compose</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ps</span><span class=\"token plain\">              </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 列出該 docker-compose 中有哪些 services 在執行</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-cli\">Docker CLI<a href=\"#docker-cli\" class=\"hash-link\" aria-label=\"Docker CLI的直接連結\" title=\"Docker CLI的直接連結\">​</a></h2><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 根據 image 來建立並執行一個 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># docker run &lt;image-name&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run hello-world</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># docker run &lt;image-name&gt; [override command] 會覆蓋掉原本在 image 內的 startup command</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run -it busybox </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">sh</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 根據 image 建立 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> create </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">image-name</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\">   </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 會取得 container id</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 執行某個 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># -a：監聽 container 中的 output，並顯示在 Terminal 上</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> start -a </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-id</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 取得某一 Container 的 logs</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> logs </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-id</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 停止某個 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> stop </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-id</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 刪除某個 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">kill</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-id</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 列出 containers</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ps</span><span class=\"token plain\">       </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 列出所有「正在執行」的 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ps</span><span class=\"token plain\"> --all  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 列出所有「被建立過」的 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 清除 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> system prune  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 把所有 docker 中當前沒用到的 container 清空</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 對 container 執行某一指令</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">exec</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-id</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">command</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">exec</span><span class=\"token plain\"> -it </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-id</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">bash</span><span class=\"token plain\">   </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 執行 container 的 bash shell</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-run根據-image-來建立並執行一個-container\">docker run：根據 image 來建立並執行一個 container<a href=\"#docker-run根據-image-來建立並執行一個-container\" class=\"hash-link\" aria-label=\"docker run：根據 image 來建立並執行一個 container的直接連結\" title=\"docker run：根據 image 來建立並執行一個 container的直接連結\">​</a></h3><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 根據 image 來建立並執行一個 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># docker run &lt;image-name&gt; &lt;override-command&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run hello-world</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run busybox </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">echo</span><span class=\"token plain\"> hello</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run busybox </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ls</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 執行 ubuntu 的 bash</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run -it ubuntu </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">bash</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># port mapping</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run -p </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">8080</span><span class=\"token plain\">:8080 </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">image-id</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># port localhost:container</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ul><li><code>docker run</code> = <code>docker create</code> + <code>docker start</code></li><li>執行 CLI 時會透過 docker client 告知 docker server (docker daemon) 要執行的任務，接著 docker server 會在本地的 <em>image cache</em> 中找尋有無 <code>hello-world</code> 這個 image，找不到的話就會到 docker hub 上去找，找到後便把這個 image 拉到本機的 image cache 中，接著 docker server 會根據這個 image 建立 container 以執行程序。</li><li>原本的 image 中都會包含 Startup Command，若想針對這個 container 執行不同的 command，可以在 <code>docker run &lt;image-id&gt; [override command]</code> 後，使用 <code>override command</code></li><li>docker run 預設就會將 container 內的 output 顯示在 terminal 中，因此不用想 <code>docker start</code> 需要加上 <code>-a</code> 的指令才看得到</li></ul><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-create--docker-start\">docker create &amp; docker start<a href=\"#docker-create--docker-start\" class=\"hash-link\" aria-label=\"docker create &amp; docker start的直接連結\" title=\"docker create &amp; docker start的直接連結\">​</a></h3><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># Create a Container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> create </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">image-name</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\">   </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 會取得 container id</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># Start a Container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># -a：attached to the contained 並將 output 顯示在終端機上</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> start -a </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-id</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ul><li><code>docker create</code> 的動作是根據 image 來建立 container，包含把 FS Snapshot 和 Startup Command 複製到 container 中</li><li><code>docker start</code> 會去執行 container 中啟動的指令（startup command）</li></ul><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-exec在-container-中執行額外的-command\">docker exec：在 container 中執行額外的 command<a href=\"#docker-exec在-container-中執行額外的-command\" class=\"hash-link\" aria-label=\"docker exec：在 container 中執行額外的 command的直接連結\" title=\"docker exec：在 container 中執行額外的 command的直接連結\">​</a></h3><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> run redis  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 啟動 redis-server，container-id (11937697771a)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># $ docker exec -it &lt;container-id&gt; &lt;command&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># -i 讓 STDIN 保持開啟</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># -t 讓 Terminal 介面比較好看（formatted）</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># -it 等於 -i -t，意思就是讓開發者可以輸入內容到 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">exec</span><span class=\"token plain\"> -it 11937697771a redis-cli</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 執行 container 的 bash shell，就可以進入該 container 的 shell 使用指令</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 如此就不用一直重複使用 exec 的 指令</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">exec</span><span class=\"token plain\"> -it </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-id</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">bash</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> redis-cli   </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 使用 Ctrl + D 可以離開</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-logs取得-container-輸出過的-output\">docker logs：取得 container 輸出過的 output<a href=\"#docker-logs取得-container-輸出過的-output\" class=\"hash-link\" aria-label=\"docker logs：取得 container 輸出過的 output的直接連結\" title=\"docker logs：取得 container 輸出過的 output的直接連結\">​</a></h3><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> create busybox </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">echo</span><span class=\"token plain\"> hi there</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> 35b632f6c7881</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> start 35b632f6c7881</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> logs 35b632f6c7881</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ul><li>docker logs 不會再執行一次該 container，而是把裡面曾經輸出過的 output 顯示在 terminal 中</li></ul><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-stop--docker-kill\">docker stop &amp; docker kill<a href=\"#docker-stop--docker-kill\" class=\"hash-link\" aria-label=\"docker stop &amp; docker kill的直接連結\" title=\"docker stop &amp; docker kill的直接連結\">​</a></h3><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> create busybox </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ping</span><span class=\"token plain\"> google.com</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> 81d72e56e9e</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> start 81d72e56e9e</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> stop 81d72e56e9e  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># send SIGTERM</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">kill</span><span class=\"token plain\"> 81d72e56e9e  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># send SIGKILL</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ul><li>使用 <code>docker stop</code> 會向 container 發送 <em>SIGTERM</em> 的指令（Signal Terminate），如此程式有機會執行 graceful shutdown 的過程（例如執行 cleanup）</li><li>使用 <code>docker kill</code> 會向 container 發送 <em>SIGKILL</em> 的指令，意思是要程式立即終止，不要再做任何事</li><li>如果使用 <code>docker stop</code> 後十秒鐘 container 仍沒有被停止，則 docker 會自動執行 kill 指令</li></ul><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-ps列出所有執行中的-container\">docker ps：列出所有執行中的 container<a href=\"#docker-ps列出所有執行中的-container\" class=\"hash-link\" aria-label=\"docker ps：列出所有執行中的 container的直接連結\" title=\"docker ps：列出所有執行中的 container的直接連結\">​</a></h3><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ps</span><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 列出所有正在執行的 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ps</span><span class=\"token plain\"> --all  </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 列出所有被建立過的 container</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-container\">Docker Container<a href=\"#docker-container\" class=\"hash-link\" aria-label=\"Docker Container的直接連結\" title=\"Docker Container的直接連結\">​</a></h2><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container run --publish </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">80</span><span class=\"token plain\">:80 --detach --name </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">name</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> nginx</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ls</span><span class=\"token plain\">                      </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># list running containers</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ls</span><span class=\"token plain\"> -a                    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># list all containers</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container stop </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-ID </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">|</span><span class=\"token plain\"> container-name</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># stop certain container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container start</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container logs </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-ID </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">|</span><span class=\"token plain\"> container-name</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 顯示 container log 訊息</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">top</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-ID </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">|</span><span class=\"token plain\"> container-name</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\">     </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 列出 container 內執行的程序</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container inspect </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-ID </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">|</span><span class=\"token plain\"> container-name</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 顯示 container 啟動時的設定資訊</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container stats                    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 顯示 container 即時的效能狀態</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">rm</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-ID </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">|</span><span class=\"token plain\"> container-name</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\">      </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 移除特定 container（須先 stop）</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">rm</span><span class=\"token plain\"> -f </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-ID </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">|</span><span class=\"token plain\"> container-name</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 移除特定 container（不用 stop）</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container --help</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># old way</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container inspect </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># docker inspect</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container stats   </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># docker stats</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"run-和-start-的差別\">run 和 start 的差別<a href=\"#run-和-start-的差別\" class=\"hash-link\" aria-label=\"run 和 start 的差別的直接連結\" title=\"run 和 start 的差別的直接連結\">​</a></h3><p>透過 <code>docker container run</code> 總是會產生一個<strong>新的</strong> container；透過 <code>docker container start</code> 則可以啟動一個停止的 container。</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"指令說明\">指令說明<a href=\"#指令說明\" class=\"hash-link\" aria-label=\"指令說明的直接連結\" title=\"指令說明的直接連結\">​</a></h3><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-container-run\">docker container run<a href=\"#docker-container-run\" class=\"hash-link\" aria-label=\"docker container run的直接連結\" title=\"docker container run的直接連結\">​</a></h4><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"alias-docker-run\">alias: <code>docker run</code><a href=\"#alias-docker-run\" class=\"hash-link\" aria-label=\"alias-docker-run的直接連結\" title=\"alias-docker-run的直接連結\">​</a></h5><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"啟動-container\">啟動 container<a href=\"#啟動-container\" class=\"hash-link\" aria-label=\"啟動 container的直接連結\" title=\"啟動 container的直接連結\">​</a></h5><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">##</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 啟動 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># -d 在 detached mode（背景）執行 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># -p 80:80 將本機的 80 port 對到 container 的 80 port</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\">##</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># old way: docker run</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container run --publish </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">80</span><span class=\"token plain\">:80 nginx</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># --detach: 在背景執行，回傳 container ID</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container run --publish </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">80</span><span class=\"token plain\">:80 --detach nginx</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># --name: 為此 container 命名</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container run --publish </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">80</span><span class=\"token plain\">:80 --detach --name webhost nginx</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container run --publish </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">80</span><span class=\"token plain\">:80 --name webhost -d nginx:1.11 nginx -T</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 啟動 mongo database</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container run --name mongo -d mongo</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container run -d -p </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">3306</span><span class=\"token plain\">:3306 --name db -e </span><span class=\"token assign-left variable\" style=\"color:rgb(191, 199, 213)\">MYSQL_RANDOM_ROOT_PASSWORD</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">=</span><span class=\"token plain\">yes mysql</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ol><li>Docker engine 會先在本地尋找叫做 nginx 的 image。</li><li>如果在本地的 image caches 中找不到，則從預設的 docker hub 中尋找該 image。</li><li>如果沒有指定版本，預設就是拉最新版本的 images 到 image caches 中。</li><li>一旦取得了 image 並準備就緒，將根據 image 啟動一個新的 container。</li><li>Docker 將會自訂網路，並在 Docker engine 中給他一個虛擬網路內的特定虛擬 IP 位址。</li><li>指令中的 <code>publish</code> 是用來開放本機的 80 port 讓本機可以連結到 container 的 80 port，傳輸資料到正在執行的 container 裡面。</li></ol><blockquote><ul><li>每當啟動一個新的 container 時，便會取得一個新的獨特 ID。</li><li>Docker 不會製作 image 的副本，它實際上只是在 image 停止的地方上，開始了一層新的變更。</li></ul></blockquote><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"在-container-內執行指令-it\">在 container 內執行指令（-it）<a href=\"#在-container-內執行指令-it\" class=\"hash-link\" aria-label=\"在 container 內執行指令（-it）的直接連結\" title=\"在 container 內執行指令（-it）的直接連結\">​</a></h5><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 以互動形式來產生 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># -t: pseudo-tty，模擬一個終端機，就類似 SSH 所做的一樣</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># -i: interactive, keep session open to receive terminal input</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># -it: 會在 container 中提供一個終端機讓你使用（Bash Shell）</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container run -it --name </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-name</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">image-name</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">program</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container run -it --name proxy nginx </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">bash</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container run -it --name ubuntu ubuntu</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 重新啟動該 container</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container start -ai</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 在現有已啟動的 container 中執行額外的程序或指令</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">exec</span><span class=\"token plain\"> -it </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-name</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">program</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container </span><span class=\"token builtin class-name\" style=\"color:rgb(255, 203, 107)\">exec</span><span class=\"token plain\"> -it mysql </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">bash</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h5 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"指定連接埠-p\">指定連接埠（-p）<a href=\"#指定連接埠-p\" class=\"hash-link\" aria-label=\"指定連接埠（-p）的直接連結\" title=\"指定連接埠（-p）的直接連結\">​</a></h5><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 打開連接埠</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># -p (--publish) HOST:CONTAINER</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container run -p </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">host-port</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\">:</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container:port</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container run -p </span><span class=\"token number\" style=\"color:rgb(247, 140, 108)\">80</span><span class=\"token plain\">:80 --name webhost -d nginx</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-container-ls\">docker container ls<a href=\"#docker-container-ls\" class=\"hash-link\" aria-label=\"docker container ls的直接連結\" title=\"docker container ls的直接連結\">​</a></h4><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># list running containers</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># old way: docker ps</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ls</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ls</span><span class=\"token plain\"> -a</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-container-inspect\">docker container inspect<a href=\"#docker-container-inspect\" class=\"hash-link\" aria-label=\"docker container inspect的直接連結\" title=\"docker container inspect的直接連結\">​</a></h4><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 用來檢視 container 啟動時的設定檔</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container inspect </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container-name</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># --format，使用 &quot;GO 模板&quot; 來格式化輸出的結果</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\"></span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container inspect webhost --format </span><span class=\"token string\" style=\"color:rgb(195, 232, 141)\">&#x27;{{ .NetworkSettings.IPAddress}}&#x27;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-image\">docker image<a href=\"#docker-image\" class=\"hash-link\" aria-label=\"docker image的直接連結\" title=\"docker image的直接連結\">​</a></h2><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> image </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ls</span><span class=\"token plain\">     </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 列出所有下載過的 image</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"資料來源\">資料來源<a href=\"#資料來源\" class=\"hash-link\" aria-label=\"資料來源的直接連結\" title=\"資料來源的直接連結\">​</a></h2><ul><li><a href=\"https://www.udemy.com/course/docker-and-kubernetes-the-complete-guide/learn/lecture/16242264#overview\" target=\"_blank\" rel=\"noopener noreferrer\">Docker and Kubernetes: The Complete Guide</a> @ Udemy</li><li></li></ul></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Docker] Getting Start pjchender.dev": {
    "prefix": "hdevops [Docker] Getting Start pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Docker] Getting Start</h1></header><blockquote><p>本篇文章非原創文章，多數內容翻譯自 <a href=\"https://dev.to/akanksha_9560/docker-for-frontend-developers-1dk5\" target=\"_blank\" rel=\"noopener noreferrer\">Docker For Frontend Developers</a> 其他請見下方參考連結。</p></blockquote><ul><li>不要使用 <code>homebrew</code> 安裝 docker，因為它只會安裝 docker 的 CLI 而沒有全部的功能。</li><li>從官網下載 Docker 並安裝。</li><li>下載 <a href=\"https://docs.docker.com/docker-for-mac/#zsh\" target=\"_blank\" rel=\"noopener noreferrer\">Docker Command Line Completion - zsh</a> 。</li></ul><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"為什麼要使用-docker\">為什麼要使用 Docker<a href=\"#為什麼要使用-docker\" class=\"hash-link\" aria-label=\"為什麼要使用 Docker的直接連結\" title=\"為什麼要使用 Docker的直接連結\">​</a></h2><p>過去當要架設應用程式時，在還不清楚應用程式的效能需求時，就需要先去買一台主機，但這常常需要用推估的，而且可能會浪費了在一台主機的資源和經費。</p><p>到了虛擬機器（Virtual machines, VM），它讓我們可以在單一的伺服器上運作多個不同的 App，但它還是有缺點，每一個 VM 都需要完整的 Ｏ S 才能執行，而每一個 OS 都需要 CPU, RAM 等才能運作，這些都需要補丁和授權，最終亦導致成本的增加。</p><p>為了解決 VM 到不足 Google 開始使用 container model。它可以在相同的主機上運行多的 container，如此釋放更多的 CPU 和 RAM 讓其他需要的地方使用。</p><p>對於開發者來說，透過 Docker 可以確保每一個開發者和每一個伺服器（包含，上線、開發和測試）時的開發環境相同。任何人都可以在短時間內設置好專案，不需要再去花許多時間搞設定，安裝套件等等。</p><p><img loading=\"lazy\" src=\"../../../i.imgur.com/BOevKXY.png\" alt=\"VM 和 Docker 的差別\" class=\"img_ev3q\"></p><p>簡單來說，docker 是一個<strong>平台（platform）</strong>，透過它的 container 可以讓你開發、部署和啟動應用程式。它可以讓你：</p><ul><li><p>更快的上線，減少浪費許多時間在環境設定上，並且可以在本機直接啟動線上版的程式。</p></li><li><p>減少不同環境問題所導致的差異，將所有和應用程式有關的套件、設定和相依的套件都放在獨立的 container 內。</p></li></ul><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"container-和-image-的差別\">Container 和 Image 的差別<a href=\"#container-和-image-的差別\" class=\"hash-link\" aria-label=\"Container 和 Image 的差別的直接連結\" title=\"Container 和 Image 的差別的直接連結\">​</a></h2><ul><li><strong>Docker Image</strong>：它是一個<u>可執行</u>的檔案，包含了精簡版的作業系統（cutdown OS）、函式庫、設定檔等要運行一個應用程式所需的所有東西。透過 docker file 可以建立 docker image。</li><li><strong>Docker Container</strong>：是一個透過 docker image 運行起來的實例（instance），同一個 docker image 可以運行多個 container。</li><li><strong>image registries</strong>：github 之於原始碼，就類似 registry 之於 container images。</li></ul><p><img loading=\"lazy\" src=\"../../../i.imgur.com/WfKZPm1.png\" alt=\"Imgur\" class=\"img_ev3q\"></p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"常見問題\">常見問題<a href=\"#常見問題\" class=\"hash-link\" aria-label=\"常見問題的直接連結\" title=\"常見問題的直接連結\">​</a></h2><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"error-couldnt-connect-to-docker-daemon-at-httpdockerlocalunixsocket---is-it-running\">ERROR: Couldn&#x27;t connect to Docker daemon at http+docker://localunixsocket - is it running<a href=\"#error-couldnt-connect-to-docker-daemon-at-httpdockerlocalunixsocket---is-it-running\" class=\"hash-link\" aria-label=\"ERROR: Couldn&#x27;t connect to Docker daemon at http+docker://localunixsocket - is it running的直接連結\" title=\"ERROR: Couldn&#x27;t connect to Docker daemon at http+docker://localunixsocket - is it running的直接連結\">​</a></h3><blockquote><p><a href=\"https://github.com/docker/compose/issues/6677\" target=\"_blank\" rel=\"noopener noreferrer\">ERROR: Couldn&#x27;t connect to Docker daemon at http+docker://localunixsocket - is it running?</a> @ Github Issue</p></blockquote><p>只需在執行 docker 指令前加上 <code>sudo</code> 即可解決。</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"參考\">參考<a href=\"#參考\" class=\"hash-link\" aria-label=\"參考的直接連結\" title=\"參考的直接連結\">​</a></h2><ul><li>⭐ <a href=\"https://dev.to/akanksha_9560/docker-for-frontend-developers-1dk5\" target=\"_blank\" rel=\"noopener noreferrer\">Docker For Frontend Developers</a> By Akanksha Sharma @ dev.io</li><li><a href=\"https://www.bretfisher.com/shell/\" target=\"_blank\" rel=\"noopener noreferrer\">Sweet Shell: With True Color, Oh-My-Zsh, SpaceVim, Gruvbox, and Demo Mode</a> @ BretFisher Shell</li><li><a href=\"https://docs.docker.com/compose/reference/overview/\" target=\"_blank\" rel=\"noopener noreferrer\">Docker Compose Documentation</a> @ Docker</li><li><a href=\"https://docs.docker.com/compose/completion/\" target=\"_blank\" rel=\"noopener noreferrer\">Docker Command Line Completion</a> @ Docker</li><li><a href=\"https://www.udemy.com/docker-mastery/learn/v4/overview\" target=\"_blank\" rel=\"noopener noreferrer\">Docker Mastery: The Complete Toolset From a Docker Captain</a> @ Udemy</li></ul></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  },
  "hdevops [Docker] 網路 Network pjchender.dev": {
    "prefix": "hdevops [Docker] 網路 Network pjchender.dev",
    "type": "html",
    "isCode": false,
    "body": [
      "<div><h1>[Docker] 網路 Network</h1></header><p>不懂的單字：</p><ul><li><code>ethernet interface</code>,</li><li><code>NAT</code>,</li><li><code>private network</code>,</li><li><code>sub interface</code></li><li><code>overlay network</code></li></ul><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"命令行command-line\">命令行（Command Line）<a href=\"#命令行command-line\" class=\"hash-link\" aria-label=\"命令行（Command Line）的直接連結\" title=\"命令行（Command Line）的直接連結\">​</a></h2><div class=\"language-bash codeBlockContainer_Ckt0 theme-code-block\" style=\"--prism-color:#bfc7d5;--prism-background-color:#292d3e\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> container port </span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&lt;</span><span class=\"token plain\">container</span><span class=\"token operator\" style=\"color:rgb(137, 221, 255)\">&gt;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> network </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">ls</span><span class=\"token plain\">         </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 列出所有 Docker 內的網路</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> network inspect      </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 檢視某個網路的詳細資料</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> network create --driver   </span><span class=\"token comment\" style=\"color:rgb(105, 112, 152);font-style:italic\"># 建立虛擬網路讓你的 container 可以與之連結</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> network connect</span><br></span><span class=\"token-line\" style=\"color:#bfc7d5\"><span class=\"token plain\">$ </span><span class=\"token function\" style=\"color:rgb(130, 170, 255)\">docker</span><span class=\"token plain\"> network disconnect</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"複製代碼至剪貼簿\" title=\"複製\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg viewBox=\"0 0 24 24\" class=\"copyButtonIcon_y97N\"><path fill=\"currentColor\" d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg viewBox=\"0 0 24 24\" class=\"copyButtonSuccessIcon_LjdS\"><path fill=\"currentColor\" d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"觀念\">觀念<a href=\"#觀念\" class=\"hash-link\" aria-label=\"觀念的直接連結\" title=\"觀念的直接連結\">​</a></h2><ul><li>當我們啟動 container 時，實際上會於背景連接到 Docker 網路。</li><li>所有的 container 都會連上私有虛擬網路 &quot;bridge&quot;。</li><li>每個虛擬網路會透過主機 IP 的 NAT （網路位址轉換）分派路由。</li><li>所有在同一個虛擬網路內的 container 不需要透過 <code>-p</code> 就可以彼此溝通。</li><li>一個 container 可以連接到多個虛擬網路。</li><li>某些情況下我們可以透過 <code>--net=host</code> 來略過虛擬網路使用主機的 IP。</li><li>我們可以使用不同的 Docker 網路驅動程式來擁有更多功能。</li><li>預設情況下，你會看到一個稱作 <code>bridge</code> 的網路，又或者叫做 <code>docker0</code></li></ul><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"指令\">指令<a href=\"#指令\" class=\"hash-link\" aria-label=\"指令的直接連結\" title=\"指令的直接連結\">​</a></h2><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-network-ls\">docker network ls<a href=\"#docker-network-ls\" class=\"hash-link\" aria-label=\"docker network ls的直接連結\" title=\"docker network ls的直接連結\">​</a></h4><p>取決於你的作業系統和 Docker 版本，你可能會看到橋接網路被取名為 <code>docker0</code> 或 <code>bridge</code>，它們指的是同樣的東西；而 <code>host</code> 則是一個特殊的網路，可以跳過 Docker 虛擬網路，直接將 container 與主機介面連接。</p><blockquote><p><code>--network host</code>: it gains performance by skipping virtual networks but sacrifices security of container model</p><p><code>--network none</code>: removes eth0 and leave you with localhost interface in container</p></blockquote><h4 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"docker-network-inspect\">docker network inspect<a href=\"#docker-network-inspect\" class=\"hash-link\" aria-label=\"docker network inspect的直接連結\" title=\"docker network inspect的直接連結\">​</a></h4><p>透過 <code>docker network inspect bridge</code> 可以看到，預設情況下 IPAM（IP 位址管理）所設定子網路是 <code>172.17</code>。</p></div>",
      "<style>.buttonGroup__atx{display:none;}",
      "pre {background-color: rgb(41,45,62);}</style>"
    ],
    "description": "https://pjchender.dev"
  }
}